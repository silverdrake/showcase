{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.html","./src/app/scene-ui/scene-ui.component.html","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.html","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.html","./src/app/story-tester/scenes/test-screen-generic/test-screen-generic.component.html","./src/app/story-tester/story-tester.component.html","./src/app/storyteller/scenes/journey-step/journey-step.component.html","./src/app/storyteller/scenes/roaming-step/roaming-step.component.html","./src/app/storyteller/scenes/town-ui/town-ui.component.html","./src/app/storyteller/scenes/world-map-view/world-map-view.component.html","./src/app/storyteller/storyteller.component.html","./node_modules/tslib/tslib.es6.js","./src/app/app-routing.module.ts","./src/app/app.component.scss","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/rpg-engine/scenes/journey-departure.ts","./src/app/rpg-engine/scenes/journey.ts","./src/app/rpg-engine/scenes/roaming.ts","./src/app/rpg-engine/scenes/town-nav.ts","./src/app/rpg-engine/wander-game.ts","./src/app/rpg-engine/wander-hero.ts","./src/app/rpg-engine/wander-scene.ts","./src/app/rpg-engine/world/locs/Place.ts","./src/app/rpg-engine/world/locs/PlaceFactory.ts","./src/app/rpg-engine/world/locs/TerrainPass.ts","./src/app/rpg-engine/world/locs/Town.ts","./src/app/rpg-engine/world/world-map.ts","./src/app/rpg-engine/world/world-position.ts","./src/app/scene-ui/insertion.directive.ts","./src/app/scene-ui/scene-injector.ts","./src/app/scene-ui/scene-ref.ts","./src/app/scene-ui/scene-ui.component.scss","./src/app/scene-ui/scene-ui.component.ts","./src/app/scene-ui/scene-ui.module.ts","./src/app/scene-ui/scene-ui.service.ts","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.scss","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.ts","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.scss","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.ts","./src/app/story-tester/scenes/test-screen-generic/test-screen-generic.component.scss","./src/app/story-tester/scenes/test-screen-generic/test-screen-generic.component.ts","./src/app/story-tester/story-tester.component.scss","./src/app/story-tester/story-tester.component.ts","./src/app/story-tester/tester-scene.ts","./src/app/storyteller/scenes/journey-step/journey-step.component.scss","./src/app/storyteller/scenes/journey-step/journey-step.component.ts","./src/app/storyteller/scenes/lib/walk-renderer.ts","./src/app/storyteller/scenes/roaming-step/roaming-step.component.scss","./src/app/storyteller/scenes/roaming-step/roaming-step.component.ts","./src/app/storyteller/scenes/scene-renderer.ts","./src/app/storyteller/scenes/town-ui/town-ui.component.scss","./src/app/storyteller/scenes/town-ui/town-ui.component.ts","./src/app/storyteller/scenes/world-map-view/world-map-view.component.scss","./src/app/storyteller/scenes/world-map-view/world-map-view.component.ts","./src/app/storyteller/storyteller.component.scss","./src/app/storyteller/storyteller.component.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","export default \"\\n\\n\\t<router-outlet></router-outlet>\\n\"","export default \"<div class=\\\"uiwrapper\\\" (click)=\\\"onOverlayClicked($event)\\\">\\n\\t<ng-template appInsertion> </ng-template>\\n</div>\\n\"","export default \"<div class=\\\"overlay\\\">\\n\\t<div class=\\\"dialog\\\">\\n\\t\\t<div class=\\\"scenescreen\\\">test-blue-screen works!</div>\\n\\t\\t<button (click)=\\\"onClose()\\\">BYE!</button>\\n\\t</div>\\n</div>\\n\"","export default \"<div class=\\\"overlay\\\">\\n\\t<div class=\\\"dialog\\\">\\n\\t\\t<div class=\\\"scenescreen\\\">test-green-screen works!</div>\\n\\t\\t<button (click)=\\\"onClose()\\\">BYE!</button>\\n\\t</div>\\n</div>\\n\"","export default \"<p>test-screen-generic works!</p>\\n\"","export default \"<div id=\\\"storyteller-outside\\\">\\n\\n\\t<div id=\\\"storyteller-tester\\\">\\n\\t\\t<p>story-tester works!</p>\\n\\n\\n\\t\\t<div id=\\\"scenerender-test\\\"></div>\\n\\n\\n\\t\\t<button (click)=\\\"loadGreenScreen()\\\">GREEN</button>\\n\\t\\t<button (click)=\\\"loadBlueScreen()\\\">BLUE</button>\\n\\t</div>\\n\\n</div>\\n\"","export default \"<div id=\\\"journeyrender\\\" #renderholder>\\n\\t<div id=\\\"viewrender\\\" #renderview></div>\\n</div>\\n\\n<div id=\\\"journeyinfo\\\" #sceneinfo>\\n\\tTravelling {{getDirectionDescription()}} to {{journeyscene.dest.name}}, day {{journeyscene.stepid}}/{{journeyscene.course.length}};\\n\\n\\t\\t<br>\\n\\n\\t<div class=\\\"journeycontrols\\\">\\n\\t<button class=\\\"journeychoice\\\" (click)=\\\"setCamp()\\\">SET CAMP</button> <button class=\\\"journeychoice\\\" (click)=\\\"continueJourney()\\\">JOURNEY ONWARDS</button> <button class=\\\"journeychoice\\\" (click)=\\\"showMap()\\\">SHOW MAP</button>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"journeyrender\\\" #renderholder>\\n\\t<div id=\\\"viewrender\\\" #renderview></div>\\n</div>\\n\\n<div id=\\\"journeyinfo\\\" #sceneinfo>\\n\\tTravelling {{getDirectionDescription()}}, day {{getDayOfTravel()}}<span *ngIf=\\\"roamingscene.startloc !== null\\\"> from {{roamingscene.startloc.name}}</span>.\\n\\n\\t\\t<br>\\n\\n\\t<div class=\\\"journeycontrols\\\">\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveTurnLeft()\\\">LEFT 45</button>\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveForward()\\\">JOURNEY ONWARDS</button>\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveTurnRight()\\\">RIGHT 45</button>\\n\\t\\t<br>\\n\\n\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"actionSetCamp()\\\">SET CAMP</button>  <button class=\\\"journeychoice\\\" (click)=\\\"showMap()\\\">SHOW MAP</button>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"towninfo\\\" #sceneinfo>\\nStanding before {{townscene.town.name}}.\\n\\n\\t\\t<br>\\n\\n\\t<div class=\\\"movecontrols\\\">\\n\\t\\t<button class=\\\"movecontrols\\\" (click)=\\\"leaveTown()\\\">LEAVE</button>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"mapholder\\\" #mapholder>\\n\\t<div id=\\\"maprender\\\" #mapview></div>\\n</div>\\n\"","export default \"<div id=\\\"st-page\\\">\\n\\n\\n</div>\\n\"","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {StoryTesterComponent} from \"./story-tester/story-tester.component\";\nimport {StorytellerComponent} from \"./storyteller/storyteller.component\";\n\n\nconst routes: Routes = [\n\t{path: '', redirectTo: '/game', pathMatch: 'full'},\n\t{path: 'tester', component: StoryTesterComponent},\n\t{path: 'game', component: StorytellerComponent},\n\n\t// {path: 'evocazione/:theme', component: EvocazioneGameComponent},\n\t// {path: 'kaiten/:theme', component: SupplyChainGameComponent},\n\t// {path: 'rockstory/venues', component: VenueTilesComponent},\n\n];\n\n@NgModule({\n\timports: [RouterModule.forRoot(routes)],\n\texports: [RouterModule]\n})\nexport class AppRoutingModule {\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuc2NzcyJ9 */\"","import {Component} from '@angular/core';\n\n@Component({\n\tselector: 'app-root',\n\ttemplateUrl: './app.component.html',\n\tstyleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n\ttitle = 'WanderANG';\n}\n","import {BrowserModule} from '@angular/platform-browser';\nimport {NgModule} from '@angular/core';\n\nimport {AppRoutingModule} from './app-routing.module';\nimport {AppComponent} from './app.component';\nimport {StorytellerComponent} from './storyteller/storyteller.component';\nimport {SceneUIComponent} from \"./scene-ui/scene-ui.component\";\nimport {TestGreenScreenComponent} from \"./story-tester/scenes/test-green-screen/test-green-screen.component\";\nimport {TestBlueScreenComponent} from \"./story-tester/scenes/test-blue-screen/test-blue-screen.component\";\nimport {SceneUIModule} from \"./scene-ui/scene-ui.module\";\nimport { StoryTesterComponent } from './story-tester/story-tester.component';\nimport {HttpClientModule} from \"@angular/common/http\";\nimport { WorldMapViewComponent } from './storyteller/scenes/world-map-view/world-map-view.component';\nimport { JourneyStepComponent } from './storyteller/scenes/journey-step/journey-step.component';\nimport { TownUIComponent } from './storyteller/scenes/town-ui/town-ui.component';\nimport { RoamingStepComponent } from './storyteller/scenes/roaming-step/roaming-step.component';\n\n@NgModule({\n\tdeclarations: [\n\t\tAppComponent,\n\t\tStorytellerComponent,\n\t\tTestGreenScreenComponent,\n\t\tTestBlueScreenComponent,\n\t\tStoryTesterComponent,\n\t\tWorldMapViewComponent,\n\t\tJourneyStepComponent,\n\t\tTownUIComponent,\n\t\tRoamingStepComponent,\n\t],\n\timports: [\n\t\tHttpClientModule,\n\t\tBrowserModule,\n\t\tAppRoutingModule,\n\t\tSceneUIModule\n\t],\n\tproviders: [],\n\tbootstrap: [AppComponent],\n\tentryComponents: [\n\t\tSceneUIComponent,\n\t\tTestGreenScreenComponent,\n\t\tTestBlueScreenComponent,\n\t\tWorldMapViewComponent,\n\t\tJourneyStepComponent,\n\t\tRoamingStepComponent,\n\t\tTownUIComponent\n\t]\n})\nexport class AppModule {\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {WorldMap} from \"../world/world-map\";\nimport {Journey} from \"./journey\";\nimport {Place} from \"../world/locs/Place\";\nimport {Roaming} from \"./roaming\";\nimport {WorldPosition} from \"../world/world-position\";\n\nexport class JourneyDeparture  extends  WanderScene {\n\n\tworldmap: WorldMap;\n\n\tdestination: Place;\n\n\tconstructor (game: WanderGame)\n\t{\n\t\tsuper(game);\n\t\tthis.worldmap = game.worldmap;\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn !!this.destination;\n\t}\n\n\tsetDestination (dest: Place)\n\t{\n\t\t// let startingpos = this.game.hero.coordinates;\n\t\t// let destcoords = dest[\"coords\"];\n\t\tthis.destination = dest;\n\t}\n\n\tgetFollowingScene(): WanderScene\n\t{\n\t\t// let next = new Journey(this.game, this.destination);\n\t\tlet direction = WorldPosition.getRelativeGeneralDirection(this.game.hero.coordinates, this.destination.pos);\n\t\tlet next = new Roaming(this.game, this.game.hero.coordinates, direction);\n\t\t// next.setStops(this.game.hero.coordinates, this.destination[\"coords\"]);\n\t\treturn next;\n\t}\n\n\n\n}\n","import {WanderGame} from \"../wander-game\";\nimport {WanderScene} from \"../wander-scene\";\nimport {WorldPosition} from \"../world/world-position\";\nimport {Place} from \"../world/locs/Place\";\n\nexport class Journey extends WanderScene {\n\n\tstart: WorldPosition;\n\tdest: Place;\n\n\tcourse: WorldPosition[];\n\tstepid: number;\n\n\t// NOTE that start is optional and will default to player's position\n\tconstructor (game: WanderGame, dest: Place, start?: WorldPosition)\n\t{\n\t\tsuper(game);\n\n\t\tthis.start = !start ? game.hero.coordinates : start;\n\t\tthis.dest = dest;\n\t\tthis.course = game.worldmap.getCourse(this.start, this.dest.pos);\n\t\tthis.stepid = 0;\n\t}\n\n\t// TODO: add support for custom stops in case the player can  (interpolating)\n\n\tstep ()\n\t{\n\t\tthis.stepid++;\n\t}\n\n\tgetCurrentCoordinates (): WorldPosition\n\t{\n\t\tif (this.stepid < this.course.length)\n\t\t{\n\t\t\treturn this.course[this.stepid];\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.dest.pos;\n\t\t}\n\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.stepid >= this.course.length;\n\t}\n\n\tgetStepDirection (stepid: number): number[]\n\t{\n\t\tlet cpos = this.course[stepid];\n\t\tlet nextpos = stepid + 1 < this.course.length ? this.course[stepid + 1] : this.dest.pos;\n\t\treturn [nextpos.x - cpos.x, nextpos.y - cpos.y];\n\t}\n\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WorldPosition} from \"../world/world-position\";\nimport {WanderGame} from \"../wander-game\";\nimport {Place} from \"../world/locs/Place\";\n\nexport class Roaming extends WanderScene {\n\n\tstatic DIRECTIONS = [\n\t\t[0, -1], // NORTH\n\t\t[1, -1],\n\t\t[1, 0], // EAST\n\t\t[1, 1],\n\t\t[0, 1], // SOUTH\n\t\t[-1, 1],\n\t\t[-1, 0], // WEST\n\t\t[-1, -1]\n\t];\n\n\tcurrent: WorldPosition;\n\tdirection: number[];\n\n\t// starting point, just for narration (duplicated to first current)\n\tstart: WorldPosition;\n\tstartloc: Place;\n\n\t// steps so far, just for narration\n\tsteps: number;\n\n\t// NOTE that start is optional and will default to player's position, direction to N?\n\tconstructor (game: WanderGame, start?: WorldPosition, direction?: number[]) {\n\t\tsuper(game);\n\n\t\tthis.direction = !direction ? [0, -1] : direction;\n\t\tthis.start = !start ? this.game.hero.coordinates : start;\n\t\tthis.current = this.start;\n\t\tthis.steps = 0;\n\n\t\tthis.startloc = this.game.worldmap.getLocationAt(this.start.getCoords());\n\t}\n\n\tsceneFinished(): boolean {\n\t\t// scene ends when you reach a Place\n\t\treturn this.game.worldmap.getLocationAt(this.current.getCoords()) != null;\n\t}\n\n\tstepInto (pos: WorldPosition)\n\t{\n\t\tthis.direction = [pos.x - this.current.x, pos.y - this.current.y];\n\t\tthis.current = pos;\n\t}\n\n\tstepForward ()\n\t{\n\t\tthis.steps++;\n\t\tthis.stepInto(this.current.getShifted(this.direction[0], this.direction[1]));\n\t}\n\n\tprivate getCurrentDirectionIndex ()\n\t{\n\t\tfor (let i = 0; i < Roaming.DIRECTIONS.length; i++)\n\t\t{\n\t\t\tif (Roaming.DIRECTIONS[i][0] === this.direction[0] && Roaming.DIRECTIONS[i][1] === this.direction[1])\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t// steps are in CLOCKWISE order\n\tchangeDirection (steps: number)\n\t{\n\t\tlet cidx = this.getCurrentDirectionIndex();\n\t\tlet nidx = (cidx + Roaming.DIRECTIONS.length + steps) % Roaming.DIRECTIONS.length;\n\t\tthis.direction = Roaming.DIRECTIONS[nidx];\n\t}\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {Town} from \"../world/locs/Town\";\nimport {Place} from \"../world/locs/Place\";\nimport {JourneyDeparture} from \"./journey-departure\";\n\nexport class TownNav extends WanderScene  {\n\n\ttown: Town;\n\tlocpoint: number;\n\n\tstatic LOC_LEAVE = -1;\n\n\tstatic LOC_OUTSKIRTS = 0;\n\tstatic LOC_GATES = 1;\n\tstatic LOC_MAINSTREET = 2;\n\tstatic LOC_MARKET = 3;\n\n\tconstructor (game: WanderGame, place?: Place)\n\t{\n\t\tsuper(game);\n\t\tthis.town = place as Town;\n\t}\n\n\tgetFollowingScene(): WanderScene {\n\t\treturn new JourneyDeparture(this.game);\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.locpoint === -1;\n\t}\n\n}\n","import {HttpClient} from \"@angular/common/http\";\nimport {WorldMap} from \"./world/world-map\";\nimport {WanderHero} from \"./wander-hero\";\nimport {WanderScene} from \"./wander-scene\";\n\nexport class WanderGame {\n\n\tactivescene: WanderScene;\n\thero: WanderHero;\n\tworldmap: WorldMap;\n\n\tstatic loadGame (http: HttpClient, callback: (game: WanderGame) => void): void\n\t{\n\t\tconst loader = new GameFactory(http);\n\t\tloader.loadDemoGame(function (game: WanderGame, factory: GameFactory)\n\t\t{\n\t\t\tconsole.log(\"loaded game \", game);\n\t\t\tconsole.log(\"built from factory \", factory);\n\t\t\tcallback(game);\n\t\t});\n\n\t}\n\n\t// DEBUG FUNCTIONS FOR QUICK TESTING\n\n\tsetHero (hero: WanderHero)\n\t{\n\t\tthis.hero = hero;\n\t}\n\n\tsetWorldMap (worldmap: WorldMap)\n\t{\n\t\tthis.worldmap = worldmap;\n\t}\n\n\tsetActiveScene (scene: WanderScene)\n\t{\n\t\tconsole.log(\"setting activescene to \", scene);\n\t\tthis.activescene = scene;\n\t}\n\n\tgetActiveScene (): WanderScene\n\t{\n\t\treturn this.activescene;\n\t}\n\n\n}\n\n\n\nclass GameFactory {\n\n\tdataset: object;\n\n\tconstructor(protected http: HttpClient) {\n\t\tthis.dataset = {\n\t\t\t\"locs\": null,\n\t\t\t\"terrain\": null,\n\t\t\t\"player\": null\n\t\t};\n\t}\n\n\tloadDataFile (filepath: string, callback: Function)\n\t{\n\t\tconst locdata = this.http.get(filepath);\n\t\tlocdata.subscribe(function (response) {\n\t\t\tconsole.log(\"LOAD RESULT\", response);\n\t\t\tcallback(response);\n\t\t});\n\t}\n\n\tloadDemoGame (callback: Function) {\n\n\t\tconst sources = {\n\t\t\t\"locs\": \"./assets/gamedata/testlocations.json\",\n\t\t\t\"terrain\": \"./assets/gamedata/testmapgame.json\",\n\t\t\t\"player\": \"./assets/gamedata/playerdata.json\"\n\t\t};\n\n\t\tlet loader: GameFactory = this;\n\n\t\tfunction getCheckerFunction(key: string): Function {\n\t\t\treturn function (data: any) {\n\t\t\t\tloader.setData(key, data, callback);\n\t\t\t};\n\t\t}\n\n\t\tfor (let key of Object.keys(sources)) {\n\t\t\tlet path = sources[key];\n\t\t\tlet checker = getCheckerFunction(key);\n\t\t\tthis.loadDataFile(path, checker);\n\t\t}\n\n\n\t}\n\n\tsetData(key: string, data: any, completer: Function): void {\n\t\tthis.dataset[key] = data;\n\n\t\tlet has_all = true;\n\t\tfor (let datakey of Object.keys(this.dataset)) {\n\t\t\tif (this.dataset[datakey] == null) {\n\t\t\t\thas_all = false;\n\t\t\t}\n\t\t}\n\n\t\tif (has_all) {\n\t\t\t// completer(this);\n\t\t\tthis.createGameInstance(completer);\n\t\t}\n\t}\n\n\tcreateGameInstance(completer: Function): void {\n\t\tlet game = new WanderGame();\n\n\t\tconsole.log(\"loaded terrain\", this.dataset[\"terrain\"]);\n\t\tconsole.log(\"loaded locs\", this.dataset[\"locs\"]);\n\t\tconsole.log(\"loaded player\", this.dataset[\"player\"]);\n\n\n\t\tlet worldmap = WorldMap.fromJSON(this.dataset[\"terrain\"], this.dataset[\"locs\"]);\n\t\tlet hero = WanderHero.fromJSON(this.dataset[\"player\"]);\n\t\tgame.setWorldMap(worldmap);\n\t\tgame.setHero(hero);\n\t\tcompleter(game, this);\n\n\t}\n\n}\n","import {WorldPosition} from \"./world/world-position\";\n\nexport class WanderHero\n{\n\n\tcoordinates: WorldPosition;\n\n\tconstructor ()\n\t{\n\t\tthis.coordinates = null;\n\t}\n\n\tstatic fromJSON (src: object): WanderHero\n\t{\n\t\tlet hero = new WanderHero();\n\n\t\t// TODO: add potentials etc\n\n\t\t// hero.setCoordinates(rawdata[\"coords\"][0], rawdata[\"coords\"][1]);\n\n\t\thero.setCoordinates(WorldPosition.fromCoordsArray(src[\"position\"][\"coords\"]));\n\n\t\treturn hero;\n\n\t}\n\n\tsetCoordinates (pos: WorldPosition)\n\t{\n\t\tconsole.log(\"replacing coords\", this.coordinates, \"w pos \", pos);\n\t\tthis.coordinates = pos;\n\t}\n\n\n}\n","import {WanderGame} from \"./wander-game\";\nimport {QuestTask} from \"./quests/quest-task\";\n\nexport abstract class WanderScene {\n\n\tstatic LEAVESTATE_UNFINISHED = -1;\n\tstatic LEAVESTATE_FINISHED = 0;\n\n\tgame: WanderGame;\n\t// a scene that CONTAINS the current scene, if applicable, so the Storyteller will know what scene to pass to when this ends.\n\tnarrative: WanderScene;\n\n\t// TODO: add interface for specific scene UI (not the SceneUI master wrapper) so the Scene can interact with its own display\n\tleaf: any;\n\n\t// TODO: add QuestTask class as driver for the scene\n\tdriver: QuestTask;\n\n\tprotected constructor (game: WanderGame)\n\t{\n\t\tthis.game = game;\n\n\t\t// narrative should be set outside the constructor\n\t\tthis.narrative = null;\n\n\t\t// TODO: TBA (note: should get value AFTER constructor anyway?)\n\t\tthis.leaf = null;\n\t\tthis.driver = null;\n\t}\n\n\tsetNarrative (narrative: WanderScene)\n\t{\n\t\tthis.narrative = narrative;\n\t}\n\n\tabstract sceneFinished(): boolean;\n\n\t/**\n\t * Acts as default, subclasses can override if they have specific return codes > 0 (for success and < -1 for failure?)\n\t * If the scene is unfinished, subclasses should still respect the UNFINISHED constant\n\t */\n\treturnState(): number\n\t{\n\t\t// Scenes that do not have a set of return values always return 0 on end OR -1 if not finished\n\t\treturn this.sceneFinished() ? WanderScene.LEAVESTATE_FINISHED : WanderScene.LEAVESTATE_UNFINISHED;\n\t}\n\n\t/**\n\t * Acts as default, subclasses can override if they chain to a scene they create\n\t */\n\tgetFollowingScene (): WanderScene\n\t{\n\t\treturn this.narrative;\n\t}\n\n\n\n\n}\n","import {WorldPosition} from \"../world-position\";\n\nexport class Place\n{\n\n\tpos: WorldPosition;\n\n\tlocid: string;\n\tloctype: string;\n\tname: string;\n\n\tconstructor (pos: WorldPosition)\n\t{\n\t\tthis.pos = pos;\n\t}\n\n\t// public abstract getName (): string;\n\n\tpublic getCoords (): number[]\n\t{\n\t\treturn this.pos.getCoords();\n\t}\n\n\n\n}\n\n","import {Town} from \"./Town\";\nimport {TerrainPass} from \"./TerrainPass\";\nimport {Place} from \"./Place\";\n\nexport class PlaceFactory\n{\n\tstatic CLASSES = {\n\t\t\"towns\": Town,\n\t\t\"passes\": TerrainPass\n\t};\n\n\tstatic fromJSON (placetype: string, placeid: string, src: object): Place\n\t{\n\t\tlet builderclass = PlaceFactory.CLASSES[placetype];\n\t\treturn builderclass.fromJSON(placeid, src);\n\t}\n}\n","import {Place} from \"./Place\";\nimport {WorldPosition} from \"../world-position\";\n\nexport class TerrainPass extends Place\n{\n\texitpoint: WorldPosition;\n\tcourse: string[];\n\n\tconstructor(locid: string, entrypos: WorldPosition, exitpos: WorldPosition, course: string[]) {\n\t\tsuper(entrypos);\n\t\tthis.loctype = \"passes\";\n\t\tthis.locid = locid;\n\t\tthis.exitpoint = exitpos;\n\t\tthis.course = course;\n\t}\n\n\n\tstatic fromJSON (placeid: string, desc: object): TerrainPass\n\t{\n\t\tlet entrypoint = desc[\"entry\"];\n\t\tlet exitpoint = desc[\"exit\"];\n\t\tlet course = desc[\"sequence\"];\n\n\t\tlet loaded = new TerrainPass (placeid, new WorldPosition(entrypoint[0], entrypoint[1]), new WorldPosition(exitpoint[0], exitpoint[1]), course);\n\t\tloaded.name = desc[\"name\"];\n\n\t\treturn loaded;\n\t}\n}\n","import {Place} from \"./Place\";\nimport {WorldPosition} from \"../world-position\";\n\nexport class Town extends Place\n{\n\n\tconstructor (locid: string, coords: WorldPosition)\n\t{\n\t\tsuper(coords);\n\t\tthis.loctype = \"towns\";\n\t\tthis.locid = locid;\n\t}\n\n\n\tstatic fromJSON (placeid: string, desc: object): Town\n\t{\n\t\tlet coords = desc[\"coords\"];\n\t\tlet loaded = new Town (placeid, new WorldPosition(coords[0], coords[1]));\n\t\tloaded.name = desc[\"name\"];\n\n\t\treturn loaded;\n\t}\n}\n","import {Place} from \"./locs/Place\";\nimport {TerrainPass} from \"./locs/TerrainPass\";\nimport {PlaceFactory} from \"./locs/PlaceFactory\";\nimport {WorldPosition} from \"./world-position\";\n\nexport class WorldMap {\n\n\tsizeX: number;\n\tsizeY: number;\n\n\tlocs: Place[][];\n\tterrain: string[][];\n\t// places_bycoords: any;\n\tplaces_bytypebyid: Map<string, Map<string, Place>>;\n\n\n\tconstructor(sizeX, sizeY) {\n\t\tthis.sizeX = sizeX;\n\t\tthis.sizeY = sizeY;\n\n\t\tthis.locs = [];\n\t\tthis.terrain = [];\n\t\tfor (let x = 0; x < sizeX; x++) {\n\t\t\tlet tercol = [];\n\t\t\tlet loccol = [];\n\t\t\tfor (let y = 0; y < sizeY; y++) {\n\t\t\t\ttercol.push(null);\n\t\t\t\tloccol.push(null);\n\t\t\t}\n\t\t\tthis.terrain.push(tercol);\n\t\t\tthis.locs.push(loccol);\n\t\t}\n\n\t\tthis.places_bytypebyid = new Map<string, Map<string, Place>>();\n\n\t}\n\n\n\tstatic getCoordsHash(coordX, coordY): String {\n\t\treturn coordX + \":\" + coordY;\n\t}\n\n\n\tstatic fromJSON(griddata, locationdata): WorldMap {\n\t\t// console.log(griddata);\n\t\tlet gridsizeX = griddata[\"mapgrid\"].length;\n\t\tlet gridsizeY = griddata[\"mapgrid\"][0].length;\n\t\tlet worldmap = new WorldMap(gridsizeX, gridsizeY);\n\t\t// console.log(worldmap.terrain);\n\t\tfor (let x = 0; x < gridsizeX; x++) {\n\t\t\tfor (let y = 0; y < gridsizeY; y++) {\n\t\t\t\tworldmap.terrain[x][y] = griddata[\"mapgrid\"][x][y];\n\t\t\t}\n\t\t}\n\n\n\t\t// loop not technically needed but we might want to run generations etc on data in the future\n\t\t// TODO : replace\n\t\tfor (let placetype of Object.keys(locationdata)) {\n\t\t\tlet places = locationdata[placetype];\n\t\t\tlet listed = new Map<string, Place>();\n\t\t\tfor (let placeid of Object.keys(places)) {\n\n\t\t\t\tlet placedesc = places[placeid];\n\t\t\t\tlet place = PlaceFactory.fromJSON(placetype, placeid, placedesc);\n\t\t\t\t// let place = new Place(Position.fromCoords(placedesc[\"coords\"]));\n\t\t\t\t// place.loctype = placetype;\n\t\t\t\t// place.locid = placeid;\n\t\t\t\tlisted.set(placeid, place);\n\t\t\t\t// console.log(\"adding place\", placetype, placedesc);\n\t\t\t\tlet coords;\n\t\t\t\tworldmap.locs[place.pos.x][place.pos.y] = place;\n\t\t\t\tif (place instanceof TerrainPass)\n\t\t\t\t{\n\t\t\t\t\tlet exitpos = (place as TerrainPass).exitpoint;\n\t\t\t\t\tworldmap.locs[exitpos.x][exitpos.y] = place;\n\t\t\t\t}\n\t\t\t}\n\t\t\tworldmap.places_bytypebyid.set(placetype, listed);\n\n\t\t}\n\n\t\treturn worldmap;\n\t}\n\n\n\n\tgetAllLocations(): Place[]\n\t{\n\t\tlet listing = [];\n\t\tfor (let placetype of this.places_bytypebyid.keys())\n\t\t{\n\t\t\t// console.log(\"getting loctype \", loctype, this.places[loctype]);\n\t\t\tfor (let loc of this.places_bytypebyid.get(placetype).values())\n\t\t\t{\n\t\t\t\tlisting.push(loc);\n\t\t\t}\n\t\t}\n\t\t// console.log(\"all locations: \", listing);\n\t\treturn listing;\n\t}\n\n\n\tgetLocationAt (coords: number[]): Place\n\t{\n\t\tlet loc = null;\n\t\ttry\n\t\t{\n\t\t\tloc = this.locs[coords[0]][coords[1]];\n\t\t} catch (err) {\n\t\t\t// return null;\n\t\t}\n\n\t\t// console.log(\"found loc \", loc);\n\t\t// TODO: DEBUG ONLY!\n\t\t// loc = null;\n\t\treturn loc;\n\n\n\t\t/*\n\t\tvar coordhash = WorldMap.getCoordsHash(coordX, coordY);\n\t\t// TODO: optimize so we don't go through the whole places data\n\t\tfor (var placetype in this.places)\n\t\t{\n\t\t\tfor (var placeid in this.places[placetype])\n\t\t\t{\n\t\t\t\tvar placecoords = this.places[placetype][placeid][\"coords\"];\n\t\t\t\tif (WorldMap.getCoordsHash(placecoords[0], placecoords[1])==coordhash)\n\t\t\t\t{\n\t\t\t\t\treturn this.places[placetype][placeid];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t\t*/\n\n\t}\n\n\tgetCourse (cfrom: WorldPosition, cto: WorldPosition): WorldPosition[]\n\t{\n\t\t// TODO: straight course for now\n\n\t\tlet distX = cto.x - cfrom.x;\n\t\tlet distY = cto.y - cfrom.y;\n\t\tlet maxdist = Math.max(Math.abs(distX), Math.abs(distY));\n\n\t\tlet course = [];\n\t\tfor (let i = 0; i < maxdist; i++)\n\t\t{\n\t\t\tlet section = i / maxdist;\n\t\t\tlet sectionX = Math.round(distX * section);\n\t\t\tlet sectionY = Math.round(distY * section);\n\t\t\tcourse.push(new WorldPosition(cfrom.x + sectionX, cfrom.y + sectionY));\n\t\t}\n\n\t\tconsole.log(\"course from \", cfrom, \" to \", cto, \": \" + course.length + \" steps (\", course, \")\");\n\n\t\treturn course;\n\t}\n\n\tgetTerrainAt (x, y)\n\t{\n\t\ttry\n\t\t{\n\t\t\treturn this.terrain[x][y];\n\t\t} catch (err)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t}\n\n}\n\n","export class WorldPosition\n{\n\n\tx: number;\n\ty: number;\n\n\tconstructor (x: number, y: number)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tstatic fromCoordsArray (coords: number[]): WorldPosition\n\t{\n\t\treturn new WorldPosition(coords[0], coords[1]);\n\t}\n\n\tpublic getCoords (): number[]\n\t{\n\t\treturn [this.x, this.y];\n\t}\n\n\tpublic getShifted (x: number, y: number)\n\t{\n\t\treturn new WorldPosition(this.x + x, this.y + y);\n\t}\n\n\tstatic getRelativeGeneralDirection (pfrom: WorldPosition, pto: WorldPosition): number[]\n\t{\n\t\tconst distX = pto.x - pfrom.x;\n\t\tconst distY = pto.y - pfrom.y;\n\n\t\tlet dirX = 0;\n\t\tlet dirY = 0;\n\t\tif (distX === 0)\n\t\t{\n\t\t\tdirX = 0;\n\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t}\n\t\telse if (distY === 0)\n\t\t{\n\t\t\tdirY = 0;\n\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet absX = Math.abs(distX);\n\t\t\tlet absY = Math.abs(distY);\n\t\t\tif (absY > 3 * absY)\n\t\t\t{\n\t\t\t\tdirX = 0;\n\t\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t\t}\n\t\t\telse if (absY * 3 < absX) {\n\t\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t\t\tdirY = 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t\t}\n\t\t}\n\n\t\treturn [dirX, dirY];\n\t}\n}\n","import {Directive, ViewContainerRef} from '@angular/core';\n\n@Directive({\n\tselector: '[appInsertion]',\n})\nexport class InsertionDirective {\n\tconstructor(public viewContainerRef: ViewContainerRef) {\n\t}\n}\n","import { Injector, Type, InjectionToken, InjectFlags } from '@angular/core';\n\nexport class SceneInjector implements Injector {\n\tconstructor(\n\t\tprivate _parentInjector: Injector,\n\t\tprivate _additionalTokens: WeakMap<any, any>)\n\t{\n\t}\n\n\tget<T>(\n\t\ttoken: Type<T> | InjectionToken<T>,\n\t\tnotFoundValue?: T,\n\t\tflags?: InjectFlags\n\t): T;\n\n\tget(token: any, notFoundValue?: any);\n\tget(token: any, notFoundValue?: any, flags?: any) {\n\n\t\tconst value = this._additionalTokens.get(token);\n\t\tif (value)\n\t\t{\n\t\t\treturn value;\n\t\t}\n\t\treturn this._parentInjector.get<any>(token, notFoundValue);\n\t}\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {WanderGame} from \"../rpg-engine/wander-game\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\n\nexport class SceneRef {\n\n\tprivate readonly _afterClosed = new Subject<any>();\n\tafterClosed: Observable<any> = this._afterClosed.asObservable();\n\n\tprivate readonly _sceneCheck = new Subject<any>();\n\tsceneCheck: Observable<any> = this._sceneCheck.asObservable();\n\n\n\tscene: WanderScene;\n\tgame: WanderGame;\n\n\tconstructor() {\n\t}\n\n\tsetContext (scene: WanderScene)\n\t{\n\t\tthis.scene = scene;\n\t\tthis.game = scene.game;\n\t}\n\n\tclose(result?: any) {\n\t\tthis._afterClosed.next(result);\n\t}\n\n\ttriggerSceneCheck ()\n\t{\n\t\tconsole.log(\"sending check event for scene \", this.scene, this.scene.sceneFinished());\n\t\tthis._sceneCheck.next();\n\t}\n\n\n\n\n}\n","export default \".uiwrapper {\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  background: transparent;\\n  align-items: center;\\n  justify-content: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3NjZW5lLXVpL3NjZW5lLXVpLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zY2VuZS11aS9zY2VuZS11aS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsU0FBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9zY2VuZS11aS9zY2VuZS11aS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi51aXdyYXBwZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHRvcDogMDtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuIiwiLnVpd3JhcHBlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgdG9wOiAwO1xuICBib3R0b206IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59Il19 */\"","import {\n\tAfterViewInit, ChangeDetectorRef,\n\tComponent,\n\tComponentFactoryResolver,\n\tComponentRef, EventEmitter,\n\tOnDestroy, Output,\n\tType,\n\tViewChild\n} from '@angular/core';\nimport {Subject} from \"rxjs\";\nimport {InsertionDirective} from \"./insertion.directive\";\n\n@Component({\n\tselector: 'app-scene-ui',\n\ttemplateUrl: './scene-ui.component.html',\n\tstyleUrls: ['./scene-ui.component.scss']\n})\nexport class SceneUIComponent implements AfterViewInit, OnDestroy {\n\n\tprivate readonly _onClose = new Subject<any>();\n\n\tpublic componentRef: ComponentRef<any>;\n\tpublic childComponentType: Type<any>;\n\tpublic onClose = this._onClose.asObservable();\n\n\t@ViewChild(InsertionDirective, {static: false}) insertionPoint: InsertionDirective;\n\n\tconstructor(private componentFactoryResolver: ComponentFactoryResolver, private cd: ChangeDetectorRef)\n\t{\n\n\n\t}\n\n\t// LIFECYCLE\n\n\t// note: ngOnInit not strictly necessary for this use\n\t// ngOnInit() {\n\t// }\n\n\tngAfterViewInit(): void {\n\t\tthis.loadChildComponent(this.childComponentType);\n\t\tthis.cd.detectChanges();\n\t}\n\n\tngOnDestroy(): void {\n\t\tif (this.componentRef) {\n\t\t\tthis.componentRef.destroy();\n\t\t}\n\t}\n\n\t// child loading\n\n\tloadChildComponent(componentType: Type<any>) {\n\t\tlet componentFactory = this.componentFactoryResolver.resolveComponentFactory(componentType);\n\n\t\tlet viewContainerRef = this.insertionPoint.viewContainerRef;\n\t\tviewContainerRef.clear();\n\n\t\tthis.componentRef = viewContainerRef.createComponent(componentFactory);\n\t}\n\n\t// for dialog-like behaviour, revise\n\n\tonOverlayClicked(evt: MouseEvent) {\n\t\t// close the scene\n\t\tconsole.warn(\"on overlay click\");\n\t\t// console.log(\"closing sceneref\");\n\t\t// console.log(\"removing \", this.componentRef);\n\t\t// this.componentRef.destroy();\n\t}\n\n\tonDialogClicked(evt: MouseEvent) {\n\t\tevt.stopPropagation();\n\t}\n\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { InsertionDirective } from './insertion.directive';\nimport {SceneUIComponent} from \"./scene-ui.component\";\n\n\n\n@NgModule({\n\timports: [CommonModule],\n\tdeclarations: [SceneUIComponent, InsertionDirective],\n\tentryComponents: [SceneUIComponent],\n})\nexport class SceneUIModule { }\n","import {\n\tApplicationRef,\n\tComponentFactoryResolver,\n\tComponentRef,\n\tEmbeddedViewRef,\n\tInjectable,\n\tInjector, Type\n} from '@angular/core';\nimport {SceneUIComponent} from \"./scene-ui.component\";\nimport {SceneRef} from \"./scene-ref\";\nimport {SceneInjector} from \"./scene-injector\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\nimport {SceneRenderer} from \"../storyteller/scenes/scene-renderer\";\nimport {StorytellerComponent} from \"../storyteller/storyteller.component\";\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SceneUIService {\n\n\tsceneRef: ComponentRef<SceneUIComponent>;\n\tprivate storyteller: StorytellerComponent;\n\n\tconstructor(\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver,\n\t\tprivate appRef: ApplicationRef,\n\t\tprivate injector: Injector) {\n\t}\n\n\tpublic bindStoryTellerUI (storyteller: StorytellerComponent)\n\t{\n\t\tthis.storyteller = storyteller;\n\t}\n\n\tpublic open(componentType: Type<SceneRenderer>, scene: WanderScene): SceneRef\n\t{\n\t\tlet sceneref = this.appendSceneUI(scene);\n\t\tthis.sceneRef.instance.childComponentType = componentType;\n\t\treturn sceneref;\n\t}\n\n\tprivate appendSceneUI (scene: WanderScene): SceneRef\n\t{\n\n\t\tconst map = new WeakMap();\n\t\t// map.set(DialogConfig, config);\n\n\t\t// add the DialogRef to dependency injection\n\t\tconst sceneRef = new SceneRef();\n\t\tsceneRef.setContext(scene);\n\t\tmap.set(SceneRef, sceneRef);\n\n\t\t// we want to know when somebody called the close mehtod\n\t\tconst sub = sceneRef.afterClosed.subscribe(() => {\n\t\t\t// close the dialog\n\t\t\tconsole.log(\"running AFTERCLOSE\");\n\t\t\tthis.removeSceneUI();\n\t\t\tsub.unsubscribe();\n\n\t\t\tconsole.log(\"getting follower scene \", scene.getFollowingScene());\n\t\t\tthis.storyteller.checkUpdateSceneRender();\n\t\t});\n\n\t\tconst checksub = sceneRef.sceneCheck.subscribe(() => {\n\t\t\tconsole.log(\"running SCENECHECK on scene \", scene);\n\t\t\tif (scene.sceneFinished())\n\t\t\t{\n\t\t\t\tconsole.log(\"scene IS finished!\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.log(\"scene NOT finished\");\n\t\t\t}\n\t\t\tif (scene.sceneFinished())\n\t\t\t{\n\t\t\t\tsceneRef.close();\n\t\t\t}\n\t\t});\n\n\t\tconst componentFactory = this.componentFactoryResolver.resolveComponentFactory(SceneUIComponent);\n\t\tconst componentRef = componentFactory.create(new SceneInjector(this.injector, map));\n\n\t\tthis.appRef.attachView(componentRef.hostView);\n\n\t\tconst domElem = (componentRef.hostView as EmbeddedViewRef<any>).rootNodes[0] as HTMLElement;\n\t\tdocument.body.appendChild(domElem);\n\n\t\tthis.sceneRef = componentRef;\n\t\t// console.log(\"SceneUI.sceneRef: \", this.sceneRef);\n\t\t// console.log(\"SceneUI.sceneRef.instance: \", this.sceneRef.instance);\n\t\t// console.log(\"SceneUI.sceneRef.childCompo: \", this.sceneRef.instance.componentRef);\n\t\tthis.sceneRef.instance.onClose.subscribe(() => {\n\t\t\tconsole.log(\"running ONCLOSE\");\n\t\t\tthis.removeSceneUI();\n\t\t\t// console.log(\"getting follower scene \", scene.getFollowingScene());\n\t\t\t// this.storyteller.checkUpdateSceneRender();\n\t\t});\n\n\t\t// return the dialogRef\n\t\treturn sceneRef;\n\n\t}\n\n\tprivate removeSceneUI () {\n\t\tconsole.log(\"removing scene ref \", this.sceneRef);\n\t\tthis.appRef.detachView(this.sceneRef.hostView);\n\t\tthis.sceneRef.destroy();\n\t}\n}\n","export default \".scenescreen {\\n  background-color: darkseagreen;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ibHVlLXNjcmVlbi90ZXN0LWJsdWUtc2NyZWVuLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3QtYmx1ZS1zY3JlZW4vdGVzdC1ibHVlLXNjcmVlbi5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLDhCQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3QtYmx1ZS1zY3JlZW4vdGVzdC1ibHVlLXNjcmVlbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zY2VuZXNjcmVlblxue1xuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRcdGRhcmtzZWFncmVlbjtcbn1cbiIsIi5zY2VuZXNjcmVlbiB7XG4gIGJhY2tncm91bmQtY29sb3I6IGRhcmtzZWFncmVlbjtcbn0iXX0= */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneUIComponent} from \"../../../scene-ui/scene-ui.component\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {TestScreenGenericComponent} from \"../test-screen-generic/test-screen-generic.component\";\n\n@Component({\n\tselector: 'app-test-blue-screen',\n\ttemplateUrl: './test-blue-screen.component.html',\n\tstyleUrls: ['../test-screen-generic/test-screen-generic.component.scss', './test-blue-screen.component.scss']\n})\nexport class TestBlueScreenComponent extends TestScreenGenericComponent implements OnInit {\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE BLUE');\n\t}\n\n}\n","export default \".scenescreen {\\n  background-color: lightsteelblue;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ncmVlbi1zY3JlZW4vdGVzdC1ncmVlbi1zY3JlZW4uY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ncmVlbi1zY3JlZW4vdGVzdC1ncmVlbi1zY3JlZW4uY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyxnQ0FBQTtBQ0FEIiwiZmlsZSI6InNyYy9hcHAvc3RvcnktdGVzdGVyL3NjZW5lcy90ZXN0LWdyZWVuLXNjcmVlbi90ZXN0LWdyZWVuLXNjcmVlbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zY2VuZXNjcmVlblxue1xuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRcdGxpZ2h0c3RlZWxibHVlO1xufVxuIiwiLnNjZW5lc2NyZWVuIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRzdGVlbGJsdWU7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {TestScreenGenericComponent} from \"../test-screen-generic/test-screen-generic.component\";\n\n@Component({\n\tselector: 'app-test-green-screen',\n\ttemplateUrl: './test-green-screen.component.html',\n\tstyleUrls: ['../test-screen-generic/test-screen-generic.component.scss', './test-green-screen.component.scss']\n})\nexport class TestGreenScreenComponent extends TestScreenGenericComponent implements OnInit {\n\n\tconstructor(public sceneref: SceneRef)\n\t{\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE GREEN');\n\t}\n\n\n}\n","export default \".overlay {\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  background: rgba(0, 0, 0, 0.7);\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.dialog {\\n  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);\\n  background-color: white;\\n  width: 50%;\\n  height: 50%;\\n  display: flex;\\n  flex-direction: column;\\n  padding: 8px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1zY3JlZW4tZ2VuZXJpYy90ZXN0LXNjcmVlbi1nZW5lcmljLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3Qtc2NyZWVuLWdlbmVyaWMvdGVzdC1zY3JlZW4tZ2VuZXJpYy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsU0FBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FDQ0Y7O0FERUE7RUFDRSw0RUFBQTtFQUNBLHVCQUFBO0VBQ0EsVUFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxZQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3Qtc2NyZWVuLWdlbmVyaWMvdGVzdC1zY3JlZW4tZ2VuZXJpYy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5vdmVybGF5IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC43KTtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5kaWFsb2cge1xuICBib3gtc2hhZG93OiAwIDE0cHggMjhweCByZ2JhKDAsIDAsIDAsIDAuMjUpLCAwIDEwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMjIpO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgd2lkdGg6IDUwJTtcbiAgaGVpZ2h0OiA1MCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBhZGRpbmc6IDhweDtcbn1cbiIsIi5vdmVybGF5IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC43KTtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5kaWFsb2cge1xuICBib3gtc2hhZG93OiAwIDE0cHggMjhweCByZ2JhKDAsIDAsIDAsIDAuMjUpLCAwIDEwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMjIpO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgd2lkdGg6IDUwJTtcbiAgaGVpZ2h0OiA1MCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBhZGRpbmc6IDhweDtcbn0iXX0= */\"","import {Component, OnInit} from '@angular/core';\n\n@Component({\n\tselector: 'app-test-screen-generic',\n\ttemplateUrl: './test-screen-generic.component.html',\n\tstyleUrls: ['./test-screen-generic.component.scss']\n})\nexport abstract class TestScreenGenericComponent implements OnInit {\n\n\tconstructor() {\n\t}\n\n\tngOnInit() {\n\t}\n\n}\n","export default \"#storyteller-outside {\\n  background-color: #9a93ff;\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#storyteller-tester {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 8px;\\n  /*background-color:\\t\\tlightgreen;*/\\n  background-image: url(\\\"/assets/ui/temporaryparchment.jpg\\\");\\n}\\n\\n#scenerender-test {\\n  background-color: grey;\\n  width: 200px;\\n  height: 300px;\\n  border: 2px solid white;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zdG9yeS10ZXN0ZXIuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5LXRlc3Rlci9zdG9yeS10ZXN0ZXIuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyx5QkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0FDQUQ7O0FESUE7RUFFQyxlQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLGlDQUFBO0VBQ0EsMERBQUE7QUNGRDs7QURPQTtFQUdDLHNCQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3RvcnktdGVzdGVyL3N0b3J5LXRlc3Rlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiNzdG9yeXRlbGxlci1vdXRzaWRlXG57XG5cdGJhY2tncm91bmQtY29sb3I6ICM5YTkzZmY7XG5cdHBvc2l0aW9uOlx0XHRcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHRcdFx0MDtcblx0bGVmdDpcdFx0XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0XHRcdDA7XG5cdGJvdHRvbTpcdFx0XHRcdFx0MDtcbn1cblxuXG4jc3Rvcnl0ZWxsZXItdGVzdGVyXG57XG5cdHBvc2l0aW9uOlx0XHRcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHRcdFx0OHB4O1xuXHRsZWZ0Olx0XHRcdFx0XHQ4cHg7XG5cdHJpZ2h0Olx0XHRcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHRcdFx0OHB4O1xuXHQvKmJhY2tncm91bmQtY29sb3I6XHRcdGxpZ2h0Z3JlZW47Ki9cblx0YmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xuXG59XG5cblxuI3NjZW5lcmVuZGVyLXRlc3RcbntcblxuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRncmV5O1xuXHR3aWR0aDpcdFx0XHRcdFx0MjAwcHg7XG5cdGhlaWdodDpcdFx0XHRcdFx0MzAwcHg7XG5cdGJvcmRlcjpcdFx0XHRcdFx0MnB4IHNvbGlkIHdoaXRlO1xufVxuXG5cbiIsIiNzdG9yeXRlbGxlci1vdXRzaWRlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzlhOTNmZjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNzdG9yeXRlbGxlci10ZXN0ZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHRvcDogOHB4O1xuICBsZWZ0OiA4cHg7XG4gIHJpZ2h0OiA4cHg7XG4gIGJvdHRvbTogOHB4O1xuICAvKmJhY2tncm91bmQtY29sb3I6XHRcdGxpZ2h0Z3JlZW47Ki9cbiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xufVxuXG4jc2NlbmVyZW5kZXItdGVzdCB7XG4gIGJhY2tncm91bmQtY29sb3I6IGdyZXk7XG4gIHdpZHRoOiAyMDBweDtcbiAgaGVpZ2h0OiAzMDBweDtcbiAgYm9yZGVyOiAycHggc29saWQgd2hpdGU7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneUIService} from \"../scene-ui/scene-ui.service\";\nimport {TestBlueScreenComponent} from \"./scenes/test-blue-screen/test-blue-screen.component\";\nimport {TestGreenScreenComponent} from \"./scenes/test-green-screen/test-green-screen.component\";\nimport {TesterScene} from \"./tester-scene\";\n\n@Component({\n\tselector: 'app-story-tester',\n\ttemplateUrl: './story-tester.component.html',\n\tstyleUrls: ['./story-tester.component.scss']\n})\nexport class StoryTesterComponent implements OnInit {\n\n\n\tconstructor(private sceneui: SceneUIService) {\n\t}\n\n\tngOnInit() {\n\t}\n\n\tloadBlueScreen() {\n\t\tlet scene = new TesterScene();\n\t\tlet ref = this.sceneui.open(TestBlueScreenComponent, scene);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\tconsole.log('Scene (BLUE) closed', result);\n\t\t});\n\t}\n\n\tloadGreenScreen() {\n\t\tlet scene = new TesterScene();\n\t\tlet ref = this.sceneui.open(TestGreenScreenComponent, scene);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\tconsole.log('Scene (GREEN) closed', result);\n\t\t});\n\t}\n}\n","import {WanderScene} from \"../rpg-engine/wander-scene\";\n\n/**\n * Empty scene object so test layouts can work without loading an actual game\n */\nexport class TesterScene extends WanderScene {\n\n\tconstructor ()\n\t{\n\t\tsuper(null);\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn false;\n\t}\n}\n","export default \"#journeyrender {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 30vh;\\n  border: 1px dashed black;\\n  overflow: auto;\\n}\\n\\n#viewrender {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#journeyinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 28vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\nbutton.journeychoice {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9qb3VybmV5LXN0ZXAvam91cm5leS1zdGVwLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvam91cm5leS1zdGVwL2pvdXJuZXktc3RlcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7RUFDQSxjQUFBO0FDQUQ7O0FER0E7RUFFQyxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7QUNERDs7QURJQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDSEQ7O0FET0E7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL2pvdXJuZXktc3RlcC9qb3VybmV5LXN0ZXAuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjam91cm5leXJlbmRlclxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cdGxlZnQ6XHRcdFx0OHB4O1xuXHRyaWdodDpcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHQzMHZoO1xuXHRib3JkZXI6XHRcdFx0MXB4IGRhc2hlZCBibGFjaztcblx0b3ZlcmZsb3c6XHRcdGF1dG87XG59XG5cbiN2aWV3cmVuZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblx0dG9wOlx0XHRcdDA7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG59XG5cbiNqb3VybmV5aW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQyOHZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuYnV0dG9uLmpvdXJuZXljaG9pY2Vcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cbiIsIiNqb3VybmV5cmVuZGVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDhweDtcbiAgbGVmdDogOHB4O1xuICByaWdodDogOHB4O1xuICBib3R0b206IDMwdmg7XG4gIGJvcmRlcjogMXB4IGRhc2hlZCBibGFjaztcbiAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbiN2aWV3cmVuZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNqb3VybmV5aW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiAyOHZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG5idXR0b24uam91cm5leWNob2ljZSB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICBwYWRkaW5nOiAycHQgOHB0O1xuICBmb250LXNpemU6IDR2aDtcbn0iXX0= */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {Journey} from \"../../../rpg-engine/scenes/journey\";\nimport {createElementCssSelector} from \"@angular/compiler\";\nimport Konva from \"konva\";\nimport {WalkRenderer} from \"../lib/walk-renderer\";\n\n@Component({\n\tselector: 'app-journey-step',\n\ttemplateUrl: './journey-step.component.html',\n\tstyleUrls: ['./journey-step.component.scss']\n})\nexport class JourneyStepComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"renderholder\", {static: false}) renderholder: ElementRef;\n\t@ViewChild(\"renderview\", {static: false}) renderview: ElementRef;\n\n\tjourneyscene: Journey;\n\tviewrenderer: WalkRenderer;\n\n\t// TILESBYTERRRAIN = {\n\t// \t\"M\": \"basetilemountain400.png\",\n\t// \t\"H\": \"basetilehills400.png\",\n\t// \t\"F\": \"basetileforest400.png\",\n\t// \t\"P\": \"basetileplains400.png\",\n\t// };\n\n\tTILESBYTERRRAIN = {\n\t\t\"M\": \"basetilemountain.png\",\n\t\t\"H\": \"basetilehills.png\",\n\t\t\"F\": \"basetileforest.png\",\n\t\t\"P\": \"basetileplains.png\",\n\t};\n\tPATH_TILES = \"assets/graph/fptiles/\";\n\tterraintiles: Map<string, string>;\n\ttileimages: Map<string, HTMLImageElement>;\n\n\tMARKERSBYID = {\n\t\t\"towns\": \"basetilecitadel.png\",\n\t};\n\tPATH_MARKERS = \"assets/graph/fptiles/\";\n\tmarkerfiles: Map<string, string>;\n\tmarkerimages: Map<string, HTMLImageElement>;\n\n\n\tEXTRAIMGS = {\n\t\t// \"skybgr\": \"/assets/graph/bgr/sunspearsky.jpg\",\n\t\t\"skybgr\": \"assets/graph/bgr/sunspearsky_gscale.png\"\n\t};\n\n\textrafiles: Map<string, string>;\n\textraimages: Map<string, HTMLImageElement>;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.journeyscene = this.sceneref.scene as Journey;\n\t\tconsole.log(\"journey path: \", JSON.stringify(this.journeyscene.course));\n\n\n\t}\n\n\tngOnInit() {\n\t\t// this.loadAssets();\n\t\t// this.prepareAssetsHolders();\n\n\t}\n\n\tngAfterViewInit(): void {\n\t\tthis.viewrenderer = new WalkRenderer(this.journeyscene.game.worldmap, this.renderview);\n\t\tlet ui = this;\n\t\tthis.viewrenderer.loadAssets(function ()\n\t\t{\n\t\t\tui.renderStep();\n\t\t});\n\t}\n\n\n\tsetCamp()\n\t{\n\t\tconsole.log(\"clicked SET CAMP\");\n\t}\n\n\tcontinueJourney()\n\t{\n\t\tconsole.log(\"clicked JOURNEY ONWARDs\");\n\n\t\tthis.journeyscene.step();\n\t\tthis.journeyscene.game.hero.setCoordinates(this.journeyscene.getCurrentCoordinates());\n\t\tif (!this.journeyscene.sceneFinished())\n\t\t{\n\t\t\tthis.renderStep();\n\t\t}\n\t\telse {\n\t\t\tthis.sceneref.triggerSceneCheck();\n\t\t}\n\n\n\t}\n\n\trenderStep ()\n\t{\n\t\tconst vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tthis.viewrenderer.renderView(this.journeyscene.getCurrentCoordinates(), vector);\n\t}\n\n\tshowMap()\n\t{\n\t\tconsole.log(\"clicked SHOW MAP\");\n\t}\n\n\tgetDirectionDescription (): string {\n\t\tlet vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tlet dirstring = \"\";\n\n\t\tif (vector[1] > 0) {\n\t\t\tdirstring += \"South\";\n\t\t} else if (vector[1] < 0) {\n\t\t\tdirstring += \"North\";\n\t\t}\n\t\tif (vector[0] > 0) {\n\t\t\tdirstring += \"East\";\n\t\t} else if (vector[0] < 0) {\n\t\t\tdirstring += \"West\";\n\t\t}\n\n\t\treturn dirstring;\n\t}\n\n\n\n\n\n\n\n\n}\n","import {WorldMap} from \"../../../rpg-engine/world/world-map\";\nimport Konva from \"konva\";\nimport {WorldPosition} from \"../../../rpg-engine/world/world-position\";\nimport {ElementRef} from \"@angular/core\";\n\nexport class WalkRenderer\n{\n\tworldmap: WorldMap;\n\n\t// NOTE: these could be configured via a tileset theme\n\n\t// TILESBYTERRRAIN = {\n\t// \t\"M\": \"basetilemountain400.png\",\n\t// \t\"H\": \"basetilehills400.png\",\n\t// \t\"F\": \"basetileforest400.png\",\n\t// \t\"P\": \"basetileplains400.png\",\n\t// };\n\n\tTILESBYTERRRAIN = {\n\t\t\"M\": \"basetilemountain.png\",\n\t\t\"H\": \"basetilehills.png\",\n\t\t\"F\": \"basetileforest.png\",\n\t\t\"P\": \"basetileplains.png\",\n\t};\n\tPATH_TILES = \"assets/graph/fptiles/\";\n\tterraintiles: Map<string, string>;\n\ttileimages: Map<string, HTMLImageElement>;\n\n\tMARKERSBYID = {\n\t\t\"towns\": \"basetilecitadel.png\",\n\t};\n\tPATH_MARKERS = \"assets/graph/fptiles/\";\n\tmarkerfiles: Map<string, string>;\n\tmarkerimages: Map<string, HTMLImageElement>;\n\n\n\tEXTRAIMGS = {\n\t\t// \"skybgr\": \"/assets/graph/bgr/sunspearsky.jpg\",\n\t\t\"skybgr\": \"assets/graph/bgr/sunspearsky_gscale.png\"\n\t};\n\n\textrafiles: Map<string, string>;\n\textraimages: Map<string, HTMLImageElement>;\n\n\trenderview: ElementRef;\n\n\tconstructor (worldmap: WorldMap, target: ElementRef)\n\t{\n\t\tthis.worldmap = worldmap;\n\t\tthis.renderview = target;\n\t\tconsole.log(this.renderview);\n\t\tconsole.log(\"render view id\", this.renderview.nativeElement.id);\n\t}\n\n\tloadAssets (callback: Function)\n\t{\n\t\tthis.terraintiles = new Map<string, string>();\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tthis.markerfiles = new Map<string, string>();\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tthis.extrafiles = new Map<string, string>();\n\t\tthis.extraimages = new Map<string, HTMLImageElement>();\n\n\t\tfor (let key in this.TILESBYTERRRAIN) {\n\t\t\tthis.terraintiles.set(key, this.PATH_TILES + this.TILESBYTERRRAIN[key]);\n\t\t}\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tthis.tileimages.set(terrain, null);\n\t\t}\n\n\t\tfor (let key in this.MARKERSBYID) {\n\t\t\tthis.markerfiles.set(key, this.PATH_MARKERS + this.MARKERSBYID[key]);\n\t\t}\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tthis.markerimages.set(markerid, null);\n\t\t}\n\n\t\tfor (let key in this.EXTRAIMGS) {\n\t\t\tthis.extrafiles.set(key, this.EXTRAIMGS[key]);\n\t\t}\n\t\tthis.extraimages = new Map<string, HTMLImageElement>();\n\t\tfor (let fileid of this.extrafiles.keys()) {\n\t\t\tthis.extraimages.set(fileid, null);\n\t\t}\n\n\t\t// LOADING ASSETS\n\t\tlet ui = this;\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.tileimages.set(terrain, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.terraintiles.get(terrain);\n\t\t}\n\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.markerimages.set(markerid, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.markerfiles.get(markerid);\n\t\t}\n\n\t\tfor (let fileid of this.extrafiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.extraimages.set(fileid, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.extrafiles.get(fileid);\n\t\t}\n\n\n\t}\n\n\tcheckReadyRender (callback: Function)\n\t{\n\t\tfor (let terrain of this.tileimages.keys()) {\n\t\t\tif (this.tileimages.get(terrain) == null) {\n\t\t\t\t// console.log(\"missing maptile\", terrain, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let markerid of this.markerimages.keys()) {\n\t\t\tif (this.markerimages.get(markerid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let fileid of this.extraimages.keys()) {\n\t\t\tif (this.extraimages.get(fileid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\n\t\tcallback();\n\t}\n\n\n\trenderView (pos: WorldPosition, vector: number[])\n\t{\n\t\t// console.log(\"rendering step \", this.journeyscene.stepid);\n\t\t// const vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\n\t\t// console.log(\"checking step view in dir \", vector, \"from\", this.journeyscene.getCurrentCoordinates().getCoords());\n\t\tconst FOV = 90;\n\t\tlet rect = this.renderview.nativeElement.getBoundingClientRect();\n\t\tconsole.log(\"RECT:\", rect);\n\t\tconst VPW = this.renderview.nativeElement.clientWidth;\n\t\tconst VPH = this.renderview.nativeElement.clientHeight;\n\n\t\tconst PANWIDTH = VPW / (FOV / 360);\n\n\t\tconsole.log(\"using fov\", FOV, \"on \" + VPW + \"*\" + VPH + \": pan to \" + PANWIDTH + \"px\");\n\n\t\tconst MAXDIST = 9;\n\n\t\tlet rendergrid = this.getRenderGrid(pos, vector, MAXDIST);\n\n\n\t\tlet stage = new Konva.Stage({\n\t\t\tcontainer: this.renderview.nativeElement.id,\n\t\t\twidth: VPW,\n\t\t\theight: VPH,\n\n\t\t});\n\n\t\t// console.log(rendergrid);\n\t\t// NOTE: following works ONLY with 90 FOV\n\t\t// also we are actually half step inside each tile but since dist and angle stay the same we ignore\n\n\t\tconst HCENTER = VPW * 0.5;\n\t\tconst VCENTER = VPH * 0.4;\n\t\tconst PHEIGHT = VPH - VCENTER;\n\n\n\t\tlet tilelayer = new Konva.Layer({\n\t\t});\n\t\tstage.add(tilelayer);\n\n\t\t// BGR + CUT\n\n\t\tlet bgrimg = this.extraimages.get(\"skybgr\");\n\t\t// let filename = terraintiles.get(terrain);\n\t\tlet bgr = new Konva.Image({\n\t\t\timage: bgrimg,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: VPW,\n\t\t\theight: VPH * 0.8\n\t\t});\n\t\ttilelayer.add(bgr);\n\n\t\tlet bgrcut = VCENTER + PHEIGHT / MAXDIST;\n\t\tlet rect1 = new Konva.Rect({\n\t\t\tx: 0,\n\t\t\ty:  bgrcut,\n\t\t\twidth: VPW,\n\t\t\theight: VPH - (bgrcut),\n\t\t\tfill: 'white',\n\t\t\t// stroke: 'black',\n\t\t\t// strokeWidth: 4\n\t\t});\n\t\t// add the shape to the layer\n\t\ttilelayer.add(rect1);\n\n\n\n\t\tfor (let gp of rendergrid)\n\t\t{\n\t\t\t// field size at dist:\n\t\t\t// 1: 1, 2: 3, 3: 5, 4: 7\n\t\t\t// y = x + (x-1)\n\t\t\tlet fsize = gp.dist + (gp.dist - 1);\n\t\t\tlet gsize = VPH / fsize;\n\t\t\tgsize = VPW / fsize;\n\n\t\t\t// let relpos = gp.angrel - 0.5;\n\t\t\t// let hpixpos = HCENTER + ();\n\n\t\t\tlet hpixpos = gp.angrel * VPW - (gsize * 0.5);\n\t\t\thpixpos = VPW - hpixpos - gsize; // fix mirroring\n\t\t\tlet vpixpos = (VCENTER + PHEIGHT / gp.dist) - gsize;\n\n\t\t\tlet terrain = this.worldmap.getTerrainAt(gp.coords[0], gp.coords[1]);\n\t\t\tlet loc = this.worldmap.getLocationAt(gp.coords);\n\n\t\t\tif (terrain == null && loc == null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet tileimg;\n\t\t\tif (terrain != null) {\n\t\t\t\ttileimg = this.tileimages.get(terrain);\n\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\timage: tileimg,\n\t\t\t\t\tx: hpixpos,\n\t\t\t\t\ty: vpixpos,\n\t\t\t\t\twidth: gsize,\n\t\t\t\t\theight: gsize\n\t\t\t\t});\n\t\t\t\ttilelayer.add(tile);\n\t\t\t}\n\n\t\t\tif (loc != null)\n\t\t\t{\n\t\t\t\ttileimg = this.markerimages.get(loc.loctype);\n\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\timage: tileimg,\n\t\t\t\t\tx: hpixpos,\n\t\t\t\t\ty: vpixpos,\n\t\t\t\t\twidth: gsize,\n\t\t\t\t\theight: gsize\n\t\t\t\t});\n\t\t\t\ttilelayer.add(tile);\n\t\t\t}\n\n\t\t}\n\t\ttilelayer.batchDraw();\n\n\n\t\tfunction parchifyWhite (imageData) {\n\t\t\t// let ctx = canvas.getContext('2d');\n\t\t\t// let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tlet nPixels = imageData.data.length;\n\t\t\tfor (let i = 0; i < nPixels; i += 4)\n\t\t\t{\n\t\t\t\tlet r = imageData.data[i];\n\t\t\t\tlet g = imageData.data[i + 1];\n\t\t\t\tlet b = imageData.data[i + 2];\n\t\t\t\tlet a = imageData.data[i + 3];\n\t\t\t\tif (a > 200)\n\t\t\t\t{\n\t\t\t\t\t// using brightness (0.21 × R) + (0.72 × G) + (0.07 × B)\n\t\t\t\t\t// instead of average ((r + g + b) / 3)\n\t\t\t\t\timageData.data[i + 3] = 255 - ((0.21 * r) + (0.72 * g) + (0.07 * b));\n\t\t\t\t}\n\t\t\t}\n\t\t\t//\n\t\t\t// for (let i = 3; i < nPixels; i += 4) {\n\t\t\t// \tif (imageData.data[i] > 0) {\n\t\t\t// \t\timageData.data[i] = 255;\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t// ctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\t\t// ctx.putImageData(imageData, 0, 0);\n\t\t\t// return canvas;\n\t\t}\n\n\t\ttilelayer.cache();\n\t\ttilelayer.filters([parchifyWhite]);\n\t\t// tilelayer.filters([Konva.Filters.Brighten]);\n\t\t// tilelayer.brightness(0.8);\n\t\ttilelayer.batchDraw();\n\n\n\t}\n\n\n\n\tgetRenderGrid (pov: WorldPosition, vector: number[], maxdist: number)\n\t{\n\t\t// const pov = this.journeyscene.getCurrentCoordinates();\n\t\tconst povX = pov.x;\n\t\tconst povY = pov.y;\n\t\t// const vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tconst angle = WalkRenderer.calcAngleDegreesEast(vector[0], vector[1]);\n\n\n\n\t\t// base angle is EAST\n\n\t\tconst FOV = 90;\n\n\t\tlet angmin = ((angle - FOV / 2) + 360) % 360;\n\t\tlet angmax = ((angle + FOV / 2) + 360) % 360;\n\t\tlet angflip = angmin > angmax;\n\t\tif (angflip)\n\t\t{\n\t\t\tangmax += 360;\n\t\t}\n\t\tlet angv = (angle + 360) % 360;\n\t\tlet angdiff = angmax - angmin;\n\n\t\tconsole.log(\"dir angle is \", angv, \"checking between \", angmin, angmax);\n\n\t\tlet totvis = 0;\n\t\tlet tfrom = new Date().getTime();\n\t\tlet rendergrid: GridPoint[] = [];\n\t\tfor (let x = povX - maxdist; x <= povX + maxdist; x++)\n\t\t{\n\t\t\tfor (let y = povY - maxdist; y <= povY + maxdist; y++)\n\t\t\t{\n\t\t\t\tif (x === povX && y === povY)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet deltaX = x - povX;\n\t\t\t\tlet deltaY = y - povY;\n\t\t\t\tlet angr = WalkRenderer.calcAngleDegreesEast(deltaX, deltaY);\n\t\t\t\tangr = (angr + 360) % 360;\n\t\t\t\tif (angflip && angr <= 45)\n\t\t\t\t{\n\t\t\t\t\tangr += 360;\n\t\t\t\t}\n\n\t\t\t\tif (angmin <= angr && angr <= angmax)\n\t\t\t\t{\n\t\t\t\t\ttotvis++;\n\t\t\t\t\tlet angrel = (angmax - angr) / FOV;\n\t\t\t\t\tlet dist = Math.sqrt((deltaX ** 2) + (deltaY ** 2));\n\t\t\t\t\tif (dist <= maxdist)\n\t\t\t\t\t{\n\t\t\t\t\t\t// we are using a SQUARE box to get the points\n\t\t\t\t\t\t// console.log(x, y, angr);\n\t\t\t\t\t\trendergrid.push({coords: [x, y], angrel: angrel, dist: dist});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\t\tlet tto = new Date().getTime();\n\t\tconsole.log(\"tot vis tiles\", totvis,  tto - tfrom);\n\n\t\t// sorting far to close THEN left to right, second sort is not strictily necessary\n\t\trendergrid.sort(function (a: GridPoint, b: GridPoint) {\n\t\t\t// if (a.dist !== b.dist)\n\t\t\t// {\n\t\t\t// \treturn b.dist - a.dist;\n\t\t\t// }\n\t\t\t// else {\n\t\t\t// \treturn a.angrel - b.angrel;\n\t\t\t// }\n\t\t\treturn b.dist - a.dist;\n\t\t});\n\n\t\treturn rendergrid;\n\t}\n\n\n\tstatic calcAngleDegreesEast (x, y) {\n\t\treturn Math.atan2(y, x) * 180 / Math.PI;\n\t}\n\n}\n\n\ninterface GridPoint {\n\n\tcoords: number[];\n\tangrel: number;\n\tdist:\tnumber;\n\n}\n","export default \"#journeyrender {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 30vh;\\n  border: 1px dashed black;\\n  overflow: auto;\\n}\\n\\n#viewrender {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#journeyinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 28vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\nbutton.journeychoice {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9yb2FtaW5nLXN0ZXAvcm9hbWluZy1zdGVwLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvcm9hbWluZy1zdGVwL3JvYW1pbmctc3RlcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7RUFDQSxjQUFBO0FDQUQ7O0FER0E7RUFFQyxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7QUNERDs7QURJQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDSEQ7O0FET0E7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3JvYW1pbmctc3RlcC9yb2FtaW5nLXN0ZXAuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjam91cm5leXJlbmRlclxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cdGxlZnQ6XHRcdFx0OHB4O1xuXHRyaWdodDpcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHQzMHZoO1xuXHRib3JkZXI6XHRcdFx0MXB4IGRhc2hlZCBibGFjaztcblx0b3ZlcmZsb3c6XHRcdGF1dG87XG59XG5cbiN2aWV3cmVuZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblx0dG9wOlx0XHRcdDA7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG59XG5cbiNqb3VybmV5aW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQyOHZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuYnV0dG9uLmpvdXJuZXljaG9pY2Vcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cbiIsIiNqb3VybmV5cmVuZGVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDhweDtcbiAgbGVmdDogOHB4O1xuICByaWdodDogOHB4O1xuICBib3R0b206IDMwdmg7XG4gIGJvcmRlcjogMXB4IGRhc2hlZCBibGFjaztcbiAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbiN2aWV3cmVuZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNqb3VybmV5aW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiAyOHZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG5idXR0b24uam91cm5leWNob2ljZSB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICBwYWRkaW5nOiAycHQgOHB0O1xuICBmb250LXNpemU6IDR2aDtcbn0iXX0= */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {WalkRenderer} from \"../lib/walk-renderer\";\nimport {Roaming} from \"../../../rpg-engine/scenes/roaming\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {SceneRenderer} from \"../scene-renderer\";\n\n@Component({\n\tselector: 'app-roaming-step',\n\ttemplateUrl: './roaming-step.component.html',\n\tstyleUrls: ['./roaming-step.component.scss']\n})\nexport class RoamingStepComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"renderholder\", {static: false}) renderholder: ElementRef;\n\t@ViewChild(\"renderview\", {static: false}) renderview: ElementRef;\n\n\troamingscene: Roaming;\n\tviewrenderer: WalkRenderer;\n\n\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.roamingscene = this.sceneref.scene as Roaming;\n\t\tconsole.log(\"roaming scene: \", this.roamingscene);\n\n\t}\n\n\n\tngOnInit() {\n\t}\n\n\n\tngAfterViewInit(): void {\n\t\tthis.viewrenderer = new WalkRenderer(this.roamingscene.game.worldmap, this.renderview);\n\t\tlet ui = this;\n\t\tthis.viewrenderer.loadAssets(function ()\n\t\t{\n\t\t\tui.renderStep();\n\t\t});\n\t}\n\n\trenderStep ()\n\t{\n\t\tconst vector = this.roamingscene.direction;\n\t\tthis.viewrenderer.renderView(this.roamingscene.current, vector);\n\t}\n\n\n\tgetDirectionDescription (): string {\n\t\tlet vector = this.roamingscene.direction;\n\t\tlet dirstring = \"\";\n\n\t\tif (vector[1] > 0) {\n\t\t\tdirstring += \"South\";\n\t\t} else if (vector[1] < 0) {\n\t\t\tdirstring += \"North\";\n\t\t}\n\t\tif (vector[0] > 0) {\n\t\t\tdirstring += \"East\";\n\t\t} else if (vector[0] < 0) {\n\t\t\tdirstring += \"West\";\n\t\t}\n\n\t\treturn dirstring;\n\t}\n\tgetDayOfTravel ()\n\t{\n\t\treturn this.roamingscene.steps + 1;\n\t}\n\n\tmoveTurnLeft ()\n\t{\n\t\tthis.roamingscene.changeDirection(-1);\n\t\tthis.renderStep();\n\t}\n\n\tmoveTurnRight ()\n\t{\n\t\tthis.roamingscene.changeDirection(1);\n\t\tthis.renderStep();\n\t}\n\n\tmoveForward ()\n\t{\n\t\tthis.roamingscene.stepForward();\n\t\tthis.roamingscene.game.hero.setCoordinates(this.roamingscene.current);\n\t\tif (!this.roamingscene.sceneFinished())\n\t\t{\n\t\t\tthis.renderStep();\n\t\t}\n\t\telse {\n\t\t\tthis.sceneref.triggerSceneCheck();\n\t\t}\n\t}\n\n\tactionSetCamp ()\n\t{\n\n\t}\n\n\n\tshowMap ()\n\t{\n\t\t// tba\n\t}\n\n\n}\n","import {SceneRef} from \"../../scene-ui/scene-ref\";\n\nexport abstract class SceneRenderer {\n\n\tprotected constructor(public sceneref: SceneRef)\n\t{\n\n\t}\n}\n","export default \"#towninfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 48vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n.movecontrols {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy90b3duLXVpL3Rvd24tdWkuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy90b3duLXVpL3Rvd24tdWkuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyxlQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0VBQ0EsWUFBQTtFQUNBLGNBQUE7RUFFQSxrQkFBQTtBQ0REOztBREtBO0VBRUMsdUJBQUE7RUFDQSxnQkFBQTtFQUVBLGNBQUE7QUNKRCIsImZpbGUiOiJzcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy90b3duLXVpL3Rvd24tdWkuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjdG93bmluZm9cbntcblx0cG9zaXRpb246XHRcdGZpeGVkO1xuXHRsZWZ0Olx0XHRcdDA7XG5cdHJpZ2h0Olx0XHRcdDA7XG5cdGJvdHRvbTpcdFx0XHQwO1xuXHRoZWlnaHQ6XHRcdFx0NDh2aDtcblx0Zm9udC1zaXplOlx0XHQ4dmg7XG5cblx0dGV4dC1hbGlnbjpcdFx0Y2VudGVyO1xufVxuXG5cbi5tb3ZlY29udHJvbHNcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cbiIsIiN0b3duaW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiA0OHZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4ubW92ZWNvbnRyb2xzIHtcbiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG4gIHBhZGRpbmc6IDJwdCA4cHQ7XG4gIGZvbnQtc2l6ZTogNHZoO1xufSJdfQ== */\"","import {AfterViewInit, Component, OnInit} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {Journey} from \"../../../rpg-engine/scenes/journey\";\nimport {TownNav} from \"../../../rpg-engine/scenes/town-nav\";\n\n@Component({\n\tselector: 'app-town-ui',\n\ttemplateUrl: './town-ui.component.html',\n\tstyleUrls: ['./town-ui.component.scss']\n})\nexport class TownUIComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\n\ttownscene: TownNav;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.townscene = this.sceneref.scene as TownNav;\n\t\tconsole.log(\"town info: \", JSON.stringify(this.townscene.town));\n\t}\n\n\tngOnInit() {\n\t}\n\n\tngAfterViewInit(): void {\n\t}\n\n\tleaveTown ()\n\t{\n\t\tthis.townscene.locpoint = TownNav.LOC_LEAVE;\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n\n}\n","export default \"#mapholder {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy93b3JsZC1tYXAtdmlldy93b3JsZC1tYXAtdmlldy5jb21wb25lbnQuc2NzcyIsInNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3dvcmxkLW1hcC12aWV3L3dvcmxkLW1hcC12aWV3LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUMsa0JBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvd29ybGQtbWFwLXZpZXcvd29ybGQtbWFwLXZpZXcuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjbWFwaG9sZGVyXG57XG5cdHBvc2l0aW9uOlx0YWJzb2x1dGU7XG5cdHRvcDpcdFx0MDtcblx0bGVmdDpcdFx0MDtcblx0cmlnaHQ6XHRcdDA7XG5cdGJvdHRvbTpcdFx0MDtcblx0Ly9iYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xufVxuXG4iLCIjbWFwaG9sZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59Il19 */\"","import {AfterViewInit, Component, ElementRef, EventEmitter, OnInit, Output, ViewChild} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {WorldMap} from \"../../../rpg-engine/world/world-map\";\nimport Konva from 'konva';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {JourneyDeparture} from \"../../../rpg-engine/scenes/journey-departure\";\nimport {Place} from \"../../../rpg-engine/world/locs/Place\";\n\n@Component({\n\tselector: 'app-world-map-view',\n\ttemplateUrl: './world-map-view.component.html',\n\tstyleUrls: ['./world-map-view.component.scss']\n})\nexport class WorldMapViewComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"mapview\", {static: false}) mapdom: ElementRef;\n\t@ViewChild(\"mapholder\", {static: false}) container: ElementRef;\n\t@Output() scenecheck = new EventEmitter<object>();\n\n\n\tTILESIZE = 48;\n\n\n\tTILESBYTERRRAIN = {\n\t\t\"M\": \"worldmaptile_mountains_trans.png\",\n\t\t\"H\": \"worldmaptile_hills_trans.png\",\n\t\t\"F\": \"worldmaptile_woods_trans.png\",\n\t\t\"P\": \"worldmaptile_empty.png\",\n\t};\n\tPATH_TILES = \"assets/graph/maptiles/\";\n\tterraintiles: Map<string, string>;\n\ttileimages: Map<string, HTMLImageElement>;\n\n\tMARKERSBYID = {\n\t\t\"towns\": \"worldmapmarker_castle_trans.png\",\n\t\t\"passes\": \"worldmapmarker_mountainpass_trans.png\",\n\t\t\"hero\": \"worldmapmarker_hero_trans.png\",\n\t};\n\tPATH_MARKERS = \"assets/graph/mapmarkers/\";\n\tmarkerfiles: Map<string, string>;\n\tmarkerimages: Map<string, HTMLImageElement>;\n\n\tworldmap: WorldMap;\n\n\tmapscene: JourneyDeparture;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\n\t\tconsole.log(\"constructor w sref game \", this.sceneref.game);\n\n\t\tthis.mapscene = this.sceneref.scene as JourneyDeparture;\n\t\tthis.prepareAssetsHolders();\n\t}\n\n\tprepareAssetsHolders ()\n\t{\n\t\tthis.terraintiles = new Map<string, string>();\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tthis.markerfiles = new Map<string, string>();\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let key in this.TILESBYTERRRAIN) {\n\t\t\tthis.terraintiles.set(key, this.PATH_TILES + this.TILESBYTERRRAIN[key]);\n\t\t}\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tthis.tileimages.set(terrain, null);\n\t\t}\n\n\t\tfor (let key in this.MARKERSBYID) {\n\t\t\tthis.markerfiles.set(key, this.PATH_MARKERS + this.MARKERSBYID[key]);\n\t\t}\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tthis.markerimages.set(markerid, null);\n\t\t}\n\n\t}\n\n\tngOnInit() {\n\n\t\tconsole.log(\"starting worldmap w sref game \", this.sceneref);\n\t\tthis.worldmap = this.sceneref.game.worldmap;\n\n\t\tthis.loadAssets();\n\n\t}\n\n\n\tngAfterViewInit() {\n\t\t// this.loadAssets();\n\n\n\t}\n\n\tloadAssets() {\n\t\tlet ui = this;\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.tileimages.set(terrain, imageObj);\n\t\t\t\tui.checkReadyRender();\n\t\t\t};\n\t\t\timageObj.src = this.terraintiles.get(terrain);\n\t\t}\n\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.markerimages.set(markerid, imageObj);\n\t\t\t\tui.checkReadyRender();\n\t\t\t};\n\t\t\timageObj.src = this.markerfiles.get(markerid);\n\t\t}\n\n\t}\n\n\tcheckReadyRender() {\n\n\t\tfor (let terrain of this.tileimages.keys()) {\n\t\t\tif (this.tileimages.get(terrain) == null) {\n\t\t\t\t// console.log(\"missing maptile\", terrain, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let markerid of this.markerimages.keys()) {\n\t\t\tif (this.markerimages.get(markerid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// console.log(\"ready on all terrains\");\n\t\tthis.initRender();\n\t}\n\n\tinitRender() {\n\n\n\t\tconst vpw = this.container.nativeElement.offsetWidth;\n\t\tconst vph = this.container.nativeElement.offsetHeight;\n\n\t\tthis.TILESIZE = Math.min(vpw, vph) / 18;\n\n\t\tlet tilesX = this.worldmap.sizeX;\n\t\tlet tilesY = this.worldmap.sizeY;\n\n\n\t\tlet mapWidth = tilesX * this.TILESIZE;\n\t\tlet mapHeight = tilesY * this.TILESIZE;\n\n\n\t\t// console.log(this.TILESIZE, tilesX, tilesY, mapWidth, mapHeight);\n\n\t\tlet stage = new Konva.Stage({\n\t\t\tcontainer: \"mapholder\",\n\t\t\twidth: mapWidth,\n\t\t\theight: mapHeight,\n\n\t\t});\n\n\t\tlet container = (this.container.nativeElement as HTMLElement);\n\t\tlet contwidth = container.offsetWidth;\n\t\tlet contheight = container.offsetHeight;\n\n\t\t// console.log(\"stage \", contwidth, contheight);\n\n\t\tlet bound_sx = -(mapWidth - contwidth);\n\t\tlet bound_dx = 0;\n\n\n\n\t\tlet bound_top = -(mapHeight - contheight);\n\t\tlet bound_bottom = 0;\n\n\t\t// console.log(\"bounds\", bound_sx, bound_top, bound_dx, bound_bottom);\n\n\t\tlet tilelayer = new Konva.Layer({\n\t\t\tdraggable: true,\n\t\t\tdragBoundFunc: function (pos: Konva.Vector2d): Konva.Vector2d {\n\t\t\t\t// console.log(\"tilelayer at\", tilelayer.x(), tilelayer.y());\n\t\t\t\t// console.log(\"mouse at\", pos.x, pos.y);\n\t\t\t\tlet x = Math.min(Math.max(bound_sx, pos.x), bound_dx);\n\t\t\t\tlet y = Math.min(Math.max(bound_top, pos.y), bound_bottom);\n\n\t\t\t\treturn ({\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tstage.add(tilelayer);\n\n\t\t// let ts_a = new Date();\n\t\tfor (let x = 0; x < tilesX; x++) {\n\t\t\tfor (let y = 0; y < tilesY; y++) {\n\t\t\t\tlet terrain = this.worldmap.getTerrainAt(x, y);\n\t\t\t\t// console.log(x, y, terrain);\n\t\t\t\tif (terrain != null) {\n\t\t\t\t\t// let imageObj = new Image();\n\t\t\t\t\t// imageObj.src = terraintiles.get(terrain);\n\n\t\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\t\timage: this.tileimages.get(terrain),\n\t\t\t\t\t\tx: x * this.TILESIZE,\n\t\t\t\t\t\ty: y * this.TILESIZE,\n\t\t\t\t\t\twidth: this.TILESIZE,\n\t\t\t\t\t\theight: this.TILESIZE,\n\t\t\t\t\t});\n\t\t\t\t\ttilelayer.add(tile);\n\t\t\t\t\t// console.log(\"added \", tile, x * this.TILESIZE, y * this.TILESIZE);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// create location markers\n\n\t\tlet widget = this;\n\n\t\tlet locs = this.worldmap.getAllLocations();\n\t\tfor (let loc of locs) {\n\t\t\t// console.log(\"adding location to map: \", loc, \"w coords\", loc[\"coords\"]);\n\t\t\t// let coords = loc[\"coords\"];\n\t\t\t// let loctype = loc[\"loctype\"];\n\n\t\t\tlet marker = new Konva.Image({\n\t\t\t\timage: this.markerimages.get(loc.loctype),\n\t\t\t\tx: loc.pos.x * this.TILESIZE,\n\t\t\t\ty: loc.pos.y * this.TILESIZE,\n\t\t\t\twidth: this.TILESIZE,\n\t\t\t\theight: this.TILESIZE,\n\t\t\t});\n\t\t\t// console.log(\"creating marker at\", loc.pos.x, loc.pos.y)\n\t\t\ttilelayer.add(marker);\n\n\t\t\tmarker.on(\"click\", function (ev) {\n\t\t\t\tconsole.log(\"marker click \", ev, \"on\", this, \"for loc\", loc);\n\t\t\t\twidget.chooseDestination(loc);\n\t\t\t\tev.cancelBubble = true;\n\t\t\t});\n\t\t}\n\n\t\t// create hero marker\n\t\tlet game = this.sceneref.game;\n\t\tlet playerpos = game.hero.coordinates.getCoords();\n\n\t\tlet imageref = this.markerimages.get(\"hero\");\n\t\t// let imagepath = this.markerfiles.get(\"hero\");\n\t\tlet marker = new Konva.Image({\n\t\t\timage: imageref,\n\t\t\tx: playerpos[0] * this.TILESIZE,\n\t\t\ty: playerpos[1] * this.TILESIZE,\n\t\t\twidth: this.TILESIZE,\n\t\t\theight: this.TILESIZE,\n\t\t});\n\n\t\ttilelayer.add(marker);\n\n\n\t\ttilelayer.batchDraw();\n\t\t// loclayer.batchDraw();\n\t\t// console.log(\"redraw\");\n\n\t\t// console.log(\"mapdom size\", this.mapdom.nativeElement.offsetHeight, this.mapdom.nativeElement.offsetWidth);\n\t\t// console.log(\"container size\", this.container.nativeElement.offsetHeight, this.container.nativeElement.offsetWidth);\n\n\t\tlet shiftX = playerpos[0] * this.TILESIZE - this.container.nativeElement.offsetWidth / 2;\n\t\tlet shiftY = playerpos[1] * this.TILESIZE - this.container.nativeElement.offsetHeight / 2;\n\n\n\t\ttilelayer.setAbsolutePosition({x: -shiftX, y: -shiftY});\n\n\t\t// console.log(\"map ready\");\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE WORLD MAP');\n\t}\n\n\tchooseDestination(destination: Place)\n\t{\n\t\tconsole.log(\"chose destination \", destination, this.sceneref.scene);\n\n\n\t\t/*\n\t\tPlace location =  caller.game.map.getPlace(vtag);\n\t\tPosition locpos = location.getCoords();\n\n\t\tif ((locpos.x != heropos.x) || (locpos.y != heropos.y))\n\t\t{\n\t\t\tcaller.startScene(new Journey(caller.game, caller.game.map.getPlace((String)view.getTag())));\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// back to town gate screen, same as back\n\t\t\tcaller.startScene(new TownNav(caller.game));\n\t\t}\n\t\t*/\n\n\t\t// TODO: handle back to current\n\t\tthis.mapscene.setDestination(destination);\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n}\n\n","export default \"#st-page {\\n  background-image: url(\\\"/assets/ui/temporaryparchment.jpg\\\");\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3N0b3J5dGVsbGVyLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zdG9yeXRlbGxlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLDBEQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeXRlbGxlci9zdG9yeXRlbGxlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiNzdC1wYWdlXG57XG5cdGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi9hc3NldHMvdWkvdGVtcG9yYXJ5cGFyY2htZW50LmpwZ1wiKTtcbn1cbiIsIiNzdC1wYWdlIHtcbiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xufSJdfQ== */\"","import {Component, OnInit, Type} from '@angular/core';\nimport {SceneUIService} from \"../scene-ui/scene-ui.service\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {WanderGame} from \"../rpg-engine/wander-game\";\nimport {WorldMapViewComponent} from \"./scenes/world-map-view/world-map-view.component\";\nimport {SceneRenderer} from \"./scenes/scene-renderer\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\nimport {JourneyDeparture} from \"../rpg-engine/scenes/journey-departure\";\nimport {Journey} from \"../rpg-engine/scenes/journey\";\nimport {JourneyStepComponent} from \"./scenes/journey-step/journey-step.component\";\nimport {Town} from \"../rpg-engine/world/locs/Town\";\nimport {TownNav} from \"../rpg-engine/scenes/town-nav\";\nimport {TownUIComponent} from \"./scenes/town-ui/town-ui.component\";\nimport {Roaming} from \"../rpg-engine/scenes/roaming\";\nimport {RoamingStepComponent} from \"./scenes/roaming-step/roaming-step.component\";\n\n@Component({\n\tselector: 'app-storyteller',\n\ttemplateUrl: './storyteller.component.html',\n\tstyleUrls: ['./storyteller.component.scss']\n})\nexport class StorytellerComponent implements OnInit {\n\n\tgame: WanderGame;\n\n\n\tconstructor(private sceneui: SceneUIService, private http: HttpClient) {\n\t}\n\n\tngOnInit() {\n\t\tthis.sceneui.bindStoryTellerUI(this);\n\t\tthis.loadGameData();\n\n\t}\n\n\tloadGameData() {\n\t\tlet stui = this;\n\t\tWanderGame.loadGame(this.http, function (game: WanderGame) {\n\t\t\tstui.game = game;\n\t\t\tstui.checkReadyGame();\n\t\t});\n\t}\n\n\tcheckReadyGame() {\n\t\tconsole.log(\"running Wander Game \", this.game);\n\n\t\tthis.checkUpdateSceneRender();\n\n\n\t}\n\n\tgetLocationSensitiveScene (): WanderScene\n\t{\n\t\tlet ppos = this.game.hero.coordinates;\n\t\tlet place = this.game.worldmap.getLocationAt(ppos.getCoords());\n\t\tconsole.log(\"place is town? \", place instanceof Town);\n\t\tlet scene = null;\n\t\tif (place instanceof Town)\n\t\t{\n\t\t\tscene = new TownNav (this.game, place);\n\t\t}\n\t\telse {\n\t\t\t// if all fails, go to map\n\t\t\tscene = new JourneyDeparture(this.game);\n\t\t}\n\t\treturn scene;\n\t}\n\n\tcheckUpdateSceneRender()\n\t{\n\t\tconsole.log(\"checkUpdateSceneRender\");\n\t\tlet scene = this.game.getActiveScene();\n\t\tconsole.log(\"checking update on scene \", scene);\n\t\tif (!!scene && scene.sceneFinished())\n\t\t{\n\t\t\tconsole.log(\"having scene finisher\");\n\t\t\tscene = scene.getFollowingScene();\n\t\t\tconsole.log(\"following scene is \", scene);\n\t\t}\n\t\tif (!scene)\n\t\t{\n\t\t\tscene = this.getLocationSensitiveScene();\n\t\t}\n\n\t\tthis.game.setActiveScene(scene);\n\t\tconsole.log(\"using scene \", scene);\n\n\t\tlet renderer = this.getSceneRenderer(scene);\n\t\tconsole.log(\"opening renderer \", renderer, \"for scene\", scene);\n\t\tlet ref = this.sceneui.open(renderer, scene);\n\t\tconsole.log(\"opened as sceneref\", ref);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\tconsole.log('Closed scene', scene, renderer, \"w result\", result);\n\t\t});\n\t}\n\n\tgetSceneRenderer (scene: WanderScene): Type<SceneRenderer>\n\t{\n\t\tlet renderer;\n\t\tif (scene instanceof JourneyDeparture)\n\t\t{\n\t\t\trenderer = WorldMapViewComponent;\n\t\t}\n\t\telse if (scene instanceof Journey)\n\t\t{\n\t\t\trenderer = JourneyStepComponent;\n\t\t}\n\t\telse if (scene instanceof TownNav)\n\t\t{\n\t\t\trenderer = TownUIComponent;\n\t\t}\n\t\telse if (scene instanceof Roaming)\n\t\t{\n\t\t\trenderer = RoamingStepComponent;\n\t\t}\n\t\treturn renderer;\n\t}\n\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n\tproduction: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}