{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.html","./src/app/scene-ui/scene-ui.component.html","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.html","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.html","./src/app/story-tester/story-tester.component.html","./src/app/storyteller/scenes/journey-step/journey-step.component.html","./src/app/storyteller/scenes/narration-pages/narration-pages.component.html","./src/app/storyteller/scenes/passage-through/passage-through.component.html","./src/app/storyteller/scenes/roaming-step/roaming-step.component.html","./src/app/storyteller/scenes/skill-action/skill-action.component.html","./src/app/storyteller/scenes/story-choice/story-choice.component.html","./src/app/storyteller/scenes/town-ui/town-ui.component.html","./src/app/storyteller/scenes/world-map-view/world-map-view.component.html","./src/app/storyteller/storyteller.component.html","./node_modules/tslib/tslib.es6.js","./src/app/app-routing.module.ts","./src/app/app.component.scss","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/rpg-engine/quests/quest-ref.ts","./src/app/rpg-engine/quests/quest-task-condition.ts","./src/app/rpg-engine/quests/quest-task.ts","./src/app/rpg-engine/scene-factory.ts","./src/app/rpg-engine/scenes/branching-meta-scene.ts","./src/app/rpg-engine/scenes/journey-departure.ts","./src/app/rpg-engine/scenes/journey.ts","./src/app/rpg-engine/scenes/meta-scene.ts","./src/app/rpg-engine/scenes/narration.ts","./src/app/rpg-engine/scenes/passage-trail.ts","./src/app/rpg-engine/scenes/roaming.ts","./src/app/rpg-engine/scenes/skill-test.ts","./src/app/rpg-engine/scenes/story-branch.ts","./src/app/rpg-engine/scenes/struct/multi-scene.ts","./src/app/rpg-engine/scenes/struct/wander-scene-trigger-condition.ts","./src/app/rpg-engine/scenes/struct/wander-scene-trigger.ts","./src/app/rpg-engine/scenes/town-nav.ts","./src/app/rpg-engine/skill-system/simple-skill-set.ts","./src/app/rpg-engine/skill-system/simple-skill-system.ts","./src/app/rpg-engine/skill-system/simple-skill-throw.ts","./src/app/rpg-engine/wander-game-state.ts","./src/app/rpg-engine/wander-game.ts","./src/app/rpg-engine/wander-hero.ts","./src/app/rpg-engine/wander-scene.ts","./src/app/rpg-engine/world/locs/Place.ts","./src/app/rpg-engine/world/locs/PlaceFactory.ts","./src/app/rpg-engine/world/locs/TerrainPass.ts","./src/app/rpg-engine/world/locs/Town.ts","./src/app/rpg-engine/world/world-map.ts","./src/app/rpg-engine/world/world-position.ts","./src/app/scene-ui/insertion.directive.ts","./src/app/scene-ui/scene-injector.ts","./src/app/scene-ui/scene-ref.ts","./src/app/scene-ui/scene-ui.component.scss","./src/app/scene-ui/scene-ui.component.ts","./src/app/scene-ui/scene-ui.module.ts","./src/app/scene-ui/scene-ui.service.ts","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.scss","./src/app/story-tester/scenes/test-blue-screen/test-blue-screen.component.ts","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.scss","./src/app/story-tester/scenes/test-green-screen/test-green-screen.component.ts","./src/app/story-tester/scenes/test-screen-generic/test-screen-generic.component.scss","./src/app/story-tester/scenes/test-screen-generic/test-screen-generic.component.ts","./src/app/story-tester/story-tester.component.scss","./src/app/story-tester/story-tester.component.ts","./src/app/story-tester/tester-scene.ts","./src/app/storyteller/scenes/journey-step/journey-step.component.scss","./src/app/storyteller/scenes/journey-step/journey-step.component.ts","./src/app/storyteller/scenes/lib/art-renderer.ts","./src/app/storyteller/scenes/lib/walk-renderer.ts","./src/app/storyteller/scenes/narration-pages/narration-pages.component.scss","./src/app/storyteller/scenes/narration-pages/narration-pages.component.ts","./src/app/storyteller/scenes/passage-through/passage-through.component.scss","./src/app/storyteller/scenes/passage-through/passage-through.component.ts","./src/app/storyteller/scenes/roaming-step/roaming-step.component.scss","./src/app/storyteller/scenes/roaming-step/roaming-step.component.ts","./src/app/storyteller/scenes/scene-renderer-loader.ts","./src/app/storyteller/scenes/scene-renderer.ts","./src/app/storyteller/scenes/skill-action/skill-action.component.scss","./src/app/storyteller/scenes/skill-action/skill-action.component.ts","./src/app/storyteller/scenes/story-choice/story-choice.component.scss","./src/app/storyteller/scenes/story-choice/story-choice.component.ts","./src/app/storyteller/scenes/town-ui/town-ui.component.scss","./src/app/storyteller/scenes/town-ui/town-ui.component.ts","./src/app/storyteller/scenes/world-map-view/world-map-view.component.scss","./src/app/storyteller/scenes/world-map-view/world-map-view.component.ts","./src/app/storyteller/storyteller-interface.ts","./src/app/storyteller/storyteller.component.scss","./src/app/storyteller/storyteller.component.ts","./src/app/support/res-loader.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","export default \"\\n\\n\\t<router-outlet></router-outlet>\\n\"","export default \"<div class=\\\"uiwrapper\\\" (click)=\\\"onOverlayClicked($event)\\\">\\n\\t<ng-template appInsertion> </ng-template>\\n</div>\\n\\n<div id=gamecontrols>\\n    \\n    <a (click)=\\\"doLoadGame()\\\" >LOAD</a>\\n        &nbsp;\\n\\t<a (click)=\\\"doSaveGame()\\\" >SAVE</a>\\n\\n\\n</div>\"","export default \"<div class=\\\"overlay\\\">\\n\\t<div class=\\\"dialog\\\">\\n\\t\\t<div class=\\\"scenescreen\\\">test-blue-screen works!</div>\\n\\t\\t<button (click)=\\\"onClose()\\\">BYE!</button>\\n\\t</div>\\n</div>\\n\"","export default \"<div class=\\\"overlay\\\">\\n\\t<div class=\\\"dialog\\\">\\n\\t\\t<div class=\\\"scenescreen\\\">test-green-screen works!</div>\\n\\t\\t<button (click)=\\\"onClose()\\\">BYE!</button>\\n\\t</div>\\n</div>\\n\"","export default \"<div id=\\\"storyteller-outside\\\">\\n\\n\\t<div id=\\\"storyteller-tester\\\">\\n\\t\\t<p>story-tester works!</p>\\n\\n\\n\\t\\t<div id=\\\"scenerender-test\\\"></div>\\n\\n\\n\\t\\t<button (click)=\\\"loadGreenScreen()\\\">GREEN</button>\\n\\t\\t<button (click)=\\\"loadBlueScreen()\\\">BLUE</button>\\n\\t</div>\\n\\n</div>\\n\"","export default \"<div id=\\\"journeyrender\\\" #renderholder>\\n\\t<div id=\\\"viewrender\\\" #renderview></div>\\n</div>\\n\\n<div id=\\\"journeyinfo\\\" #sceneinfo>\\n\\tTravelling {{getDirectionDescription()}} to {{journeyscene.dest.name}}, day {{journeyscene.stepid}}/{{journeyscene.course.length}};\\n\\n\\t\\t<br>\\n\\n\\t<div class=\\\"journeycontrols\\\">\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"setCamp()\\\">SET CAMP</button> <button class=\\\"journeychoice\\\" (click)=\\\"continueJourney()\\\">JOURNEY ONWARDS</button> <button class=\\\"journeychoice\\\" (click)=\\\"showMap()\\\">SHOW MAP</button>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"narration_scene\\\" >\\n\\t<div id=\\\"narration_render\\\">\\n\\t\\t    {{tale.paragraphs[tale.progress]}}\\n\\t</div>\\n</div>\\n\\n\\n\\n<div id=\\\"narration_info\\\" #sceneinfo>\\n\\n\\n\\t<div class=\\\"narration_controls\\\">\\n\\n\\t\\t<button class=\\\"pageturn\\\" *ngIf=\\\"tale.progress > 0 || !tale.allowReadBack\\\" (click)=\\\"readBackwards()\\\">BACK</button>\\n\\t\\t<button class=\\\"pageturn\\\" *ngIf=\\\"tale.progress < tale.paragraphs.length - 1\\\" (click)=\\\"readForward()\\\">FORWARD</button>\\n\\t\\t<button class=\\\"pageturn\\\" *ngIf=\\\"tale.progress === tale.paragraphs.length - 1\\\" (click)=\\\"readOut()\\\">END</button>\\n\\t</div>\\n\\n\\n</div>\\n\\n\"","export default \"<ng-template *ngIf=\\\"isTrailing(); then TrailingScene; else AccessScene\\\">\\n\\n</ng-template>\\n\\n<ng-template #AccessScene>\\n\\n\\t<div class=\\\"trailview\\\"></div>\\n\\t<div class=\\\"trailcontext\\\">\\n\\n\\t\\t<div class=\\\"traildescdebug\\\">\\n\\t\\t\\tAt the start of {{ trail.passage.name }}, {{trail.passage.length()}} days journey.\\n\\t\\t</div>\\n\\n\\t\\t\\t<button class=\\\"trailcontrols\\\"  (click)=\\\"journeyOnwards()\\\">ENTER</button>\\n\\t\\t\\t<button class=\\\"trailcontrols\\\" (click)=\\\"leaveTrail()\\\">LEAVE</button>\\n\\t</div>\\n\\n</ng-template>\\n\\n<ng-template #TrailingScene>\\n\\n\\t<div class=\\\"trailview\\\"></div>\\n\\t<div class=\\\"trailcontext\\\">\\n\\n\\t\\t<div class=\\\"traildescdebug\\\">\\n\\t\\t\\tDay {{trail.progress + 1}} of {{trail.passage.length()}} through the {{ trail.passage.name }}.\\n\\t\\t</div>\\n\\n\\t\\t<button class=\\\"trailcontrols\\\" (click)=\\\"journeyOnwards()\\\">FORWARD</button>\\n\\n\\t</div>\\n\\n\\n</ng-template>\\n\"","export default \"<div id=\\\"journeyrender\\\" #renderholder>\\n\\t<div id=\\\"viewrender\\\" #renderview></div>\\n</div>\\n\\n<div id=\\\"journeyinfo\\\" #sceneinfo>\\n\\tTravelling {{getDirectionDescription()}}, day {{getDayOfTravel()}}<span *ngIf=\\\"roamingscene.startloc !== null\\\"> from {{roamingscene.startloc.name}}</span>.\\n\\n\\t\\t<br>\\n\\n\\t<div class=\\\"journeycontrols\\\">\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveTurnLeft()\\\">TURN LEFT</button>\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveForward()\\\">JOURNEY ONWARDS</button>\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"moveTurnRight()\\\">TURN RIGHT</button>\\n\\t\\t<br>\\n\\n\\n\\t\\t<button class=\\\"journeychoice\\\" (click)=\\\"actionSetCamp()\\\">SET CAMP</button>  <button class=\\\"journeychoice\\\" (click)=\\\"showMap()\\\">SHOW MAP</button>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"choicescenery\\\" >\\n\\t<div id=\\\"sceneryview\\\" #scenerender></div>\\n</div>\\n\\n\\n\\n<div id=\\\"choiceinfo\\\" #sceneinfo>\\n\\n\\n\\t<div class=\\\"choicecontrols\\\" *ngIf=\\\"narr_done == null\\\">\\n\\n\\t\\t<span>{{this.skilltest.situation}}</span>\\n\\t\\t<br>\\n\\t\\t<span *ngIf=\\\"narr_fail != null\\\">\\n\\t\\t\\t{{narr_fail}}\\n\\t\\t</span>\\n\\n\\t\\t<table>\\n\\t\\t\\t<tr *ngFor=\\\"let option of this.skilltest.options\\\">\\n\\t\\t\\t\\t<td style=\\\"text-align: left\\\">{{option.description}}</td>\\n\\t\\t\\t\\t<td>({{option.tried}}/{{option.max_tries}}></td>\\n\\t\\t\\t\\t<td>\\n\\t\\t\\t\\t\\t<button class=\\\"skillchoice\\\" (click)=\\\"this.tryOption(option, true)\\\">DO</button>\\n\\t\\t\\t\\t\\t<button class=\\\"skillchoice\\\"(click)=\\\"this.tryOption(option, false)\\\">FAIL</button>\\n<!--\\t\\t\\t\\t\\t<span (click)=\\\"this.tryOption(option, true)\\\">[DO]</span>-->\\n<!--\\t\\t\\t\\t\\t<span (click)=\\\"this.tryOption(option, false)\\\">[FAIL]</span>-->\\n\\t\\t\\t\\t</td>\\n\\n\\t\\t\\t</tr>\\n\\t\\t</table>\\n\\n\\t\\t<!--\\n\\t\\t<ul class=\\\"choices-prompt\\\">\\n\\n\\t\\t\\t<li *ngFor=\\\"let option of this.skilltest.options\\\">{{option.description}} ({{option.tried}}/{{option.max_tries}})\\n\\t\\t\\t\\t<span (click)=\\\"this.tryOption(option, true)\\\">[DO]</span>\\n\\t\\t\\t\\t<span (click)=\\\"this.tryOption(option, false)\\\">[FAIL]</span>\\n\\t\\t\\t</li>\\n\\t\\t</ul>\\n\\t\\t-->\\n\\n\\t</div>\\n\\n\\t<div class=\\\"choicecontrols\\\" *ngIf=\\\"narr_done != null\\\">\\n\\t\\t<span>{{this.narr_done}}</span>\\n\\t\\t<ul class=\\\"choices-prompt\\\">\\n\\t\\t\\t<li><span (click)=\\\"this.leaveScene()\\\">[OK]</span></li>\\n\\t\\t</ul>\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"choicescenery\\\" >\\n\\t<div id=\\\"sceneryview\\\" #scenerender></div>\\n</div>\\n\\n\\n\\n<div id=\\\"choiceinfo\\\" #sceneinfo>\\n\\n\\n\\t<div class=\\\"choicecontrols\\\">\\n\\n\\t\\t<span>{{this.choice.prompt}}</span>\\n\\n\\t\\t<ul class=\\\"choices-prompt\\\">\\n\\n\\t\\t\\t<li *ngFor=\\\"let option of this.choice.options\\\" (click)=\\\"selectOption(option)\\\">{{option.description}}</li>\\n\\t\\t</ul>\\n\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"townscene\\\" >\\n\\t<div id=\\\"locrender\\\" #locrender></div>\\n</div>\\n\\n\\n\\n<div id=\\\"towninfo\\\" #sceneinfo>\\n\\n\\n\\t<div class=\\\"movecontrols\\\">\\n\\n\\t\\t<span>{{this.localizeTextAsset(this.townscene.currentloc.description)}}</span>\\n\\n\\t\\t<ul class=\\\"townnav-prompt\\\">\\n\\t\\t\\t<li (click)=\\\"moveToLoc(direction.target)\\\" *ngFor=\\\"let direction of this.townscene.currentloc.moves\\\">{{this.localizeTextAsset(direction.prompt)}}</li>\\n\\t\\t\\t<li (click)=\\\"activatePrompt(task)\\\" *ngFor=\\\"let task of this.taskprompts\\\">{{task.prompt}}</li>\\n\\t\\t</ul>\\n\\n\\n\\t</div>\\n\\n\\n</div>\\n\"","export default \"<div id=\\\"mapholder\\\" #mapholder>\\n\\t<div id=\\\"maprender\\\" #mapview></div>\\n</div>\\n\"","export default \"<div id=\\\"st-page\\\">\\n\\n\\n</div>\\n\\n\\n\"","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {StoryTesterComponent} from \"./story-tester/story-tester.component\";\nimport {StorytellerComponent} from \"./storyteller/storyteller.component\";\n\n\nconst routes: Routes = [\n\t{path: '', redirectTo: '/game', pathMatch: 'full'},\n\t{path: 'tester', component: StoryTesterComponent},\n\t{path: 'game', component: StorytellerComponent},\n\t\n];\n\n@NgModule({\n\timports: [RouterModule.forRoot(routes)],\n\texports: [RouterModule]\n})\nexport class AppRoutingModule {\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuc2NzcyJ9 */\"","import {Component} from '@angular/core';\n\n@Component({\n\tselector: 'app-root',\n\ttemplateUrl: './app.component.html',\n\tstyleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n\ttitle = 'WanderANG';\n}\n","import {BrowserModule} from '@angular/platform-browser';\nimport {NgModule} from '@angular/core';\n\nimport {AppRoutingModule} from './app-routing.module';\nimport {AppComponent} from './app.component';\nimport {StorytellerComponent} from './storyteller/storyteller.component';\nimport {SceneUIComponent} from \"./scene-ui/scene-ui.component\";\nimport {TestGreenScreenComponent} from \"./story-tester/scenes/test-green-screen/test-green-screen.component\";\nimport {TestBlueScreenComponent} from \"./story-tester/scenes/test-blue-screen/test-blue-screen.component\";\nimport {SceneUIModule} from \"./scene-ui/scene-ui.module\";\nimport { StoryTesterComponent } from './story-tester/story-tester.component';\nimport {HttpClientModule} from \"@angular/common/http\";\nimport { WorldMapViewComponent } from './storyteller/scenes/world-map-view/world-map-view.component';\nimport { JourneyStepComponent } from './storyteller/scenes/journey-step/journey-step.component';\nimport { TownUIComponent } from './storyteller/scenes/town-ui/town-ui.component';\nimport { RoamingStepComponent } from './storyteller/scenes/roaming-step/roaming-step.component';\nimport { PassageThroughComponent } from './storyteller/scenes/passage-through/passage-through.component';\nimport { NarrationPagesComponent } from './storyteller/scenes/narration-pages/narration-pages.component';\nimport { StoryChoiceComponent } from './storyteller/scenes/story-choice/story-choice.component';\nimport { SkillActionComponent } from './storyteller/scenes/skill-action/skill-action.component';\n\n@NgModule({\n\tdeclarations: [\n\t\tAppComponent,\n\t\tStorytellerComponent,\n\t\tTestGreenScreenComponent,\n\t\tTestBlueScreenComponent,\n\t\tStoryTesterComponent,\n\t\tWorldMapViewComponent,\n\t\tJourneyStepComponent,\n\t\tTownUIComponent,\n\t\tRoamingStepComponent,\n\t\tPassageThroughComponent,\n\t\tNarrationPagesComponent,\n\t\tStoryChoiceComponent,\n\t\tSkillActionComponent,\n\t],\n\timports: [\n\t\tHttpClientModule,\n\t\tBrowserModule,\n\t\tAppRoutingModule,\n\t\tSceneUIModule\n\t],\n\tproviders: [],\n\tbootstrap: [AppComponent],\n\tentryComponents: [\n\t\tSceneUIComponent,\n\t\tTestGreenScreenComponent,\n\t\tTestBlueScreenComponent,\n\t\tWorldMapViewComponent,\n\t\tJourneyStepComponent,\n\t\tRoamingStepComponent,\n\t\tTownUIComponent,\n\t\tPassageThroughComponent,\n\t\tNarrationPagesComponent,\n\t\tStoryChoiceComponent,\n\t\tSkillActionComponent\n\t]\n})\nexport class AppModule {\n}\n","import {QuestTaskCondition} from \"./quest-task-condition\";\nimport {QuestTask} from \"./quest-task\";\nimport {WanderGame} from \"../wander-game\";\nimport {WanderScene} from \"../wander-scene\";\n\n/**\n * QuestRef representes a pointer to all quest resources with a specific ID.\n * It contains a number of QuestTaskState object describing the internal \"live\" state of the quest and can be used by QuestLoader to know which data must be loaded to provide a certain Scene inside it\n */\n\nexport class QuestRef {\n\n\t// for now we load the quest ENTIRELY from a SINGLE SPECIFIC file\n\tfileref: string;\n\tquestid: string;\n\n\tconditions: Map<string, QuestTaskCondition[]>;\n\tstates: Map<string, number>;\n\n\t// have AT LEAST one completer completed makes the quest complete\n\tcompleters: string[];\n\tcompleted: boolean;\n\n\tconstructor (questid: string, fileref: string)\n\t{\n\t\tthis.questid = questid;\n\t\tthis.fileref = fileref;\n\n\n\t\tthis.conditions = new Map<string, QuestTaskCondition[]>();\n\t\tthis.completers = [];\n\t\tthis.states = new Map<string, number>();\n\t}\n\n\n\tstatic fromJSON (src: object, fileref: string): QuestRef\n\t{\n\t\tlet generated = new QuestRef (src[\"questid\"], fileref);\n\n\t\tfor (let taskid in src[\"tasks\"]) {\n\t\t\tlet taskraw = src[\"tasks\"][taskid];\n\t\t\tlet taskconditions = [];\n\t\t\tif (!!taskraw[\"conditions\"]) {\n\t\t\t\tfor (let conditionraw of taskraw[\"conditions\"]) {\n\t\t\t\t\ttaskconditions.push(QuestTaskCondition.fromJSON(conditionraw));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// an unconditional task would appear ALWAYS\n\t\t\tif (taskconditions.length > 0)\n\t\t\t{\n\t\t\t\tgenerated.conditions.set(taskid, taskconditions);\n\t\t\t\tgenerated.states.set(taskid, -1);\n\t\t\t}\n\t\t}\n\n\t\treturn generated;\n\t}\n\n\tisTaskCompleted (taskid: string)\n\t{\n\t\treturn this.states.get(taskid) !== WanderScene.LEAVESTATE_UNFINISHED;\n\t}\n\n\tsetCompletedTask (task: QuestTask)\n\t{\n\t\tlet taskid = task.taskid;\n\t\t// let ctask = this.loadTask(taskid);\n\t\t// TODO: re-add journal entry\n\t\t// this.journal_entry = task.journal_after;\n\t\tlet returnstates = task.getReturnStates();\n\t\t// Map<String, Integer> returnstates = ctask.getReturnStates();\n\t\tfor (let tasksceneid of returnstates.keys())\n\t\t{\n\t\t\tthis.states.set(tasksceneid, returnstates.get(tasksceneid));\n\t\t}\n\n\t\tif (this.completers.indexOf(taskid) !== -1)\n\t\t{\n\t\t\tthis.completed = true;\n\t\t}\n\t}\n\n\tgetAvailableTasks (game: WanderGame): string[]\n\t{\n\t\tlet available = [];\n\t\tfor (let taskid of this.conditions.keys())\n\t\t{\n\t\t\t// let task = this.tasks.get(taskid);\n\t\t\tconsole.log(\"checking quest task \", taskid, \" w conditions\", this.conditions, \"for \", this.conditions);\n\n\t\t\tif ((!this.isTaskCompleted(taskid)) && this.conditions.has(taskid))\n\t\t\t{\n\t\t\t\tlet satisfied = true;\n\t\t\t\tfor (let current of this.conditions.get(taskid))\n\t\t\t\t{\n\t\t\t\t\tif (!current.verifyCondition(game, this))\n\t\t\t\t\t{\n\t\t\t\t\t\tsatisfied = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (satisfied)\n\t\t\t\t{\n\t\t\t\t\tavailable.push(taskid);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn available;\n\t}\n\n\n\n\n}\n","/**\n *\n */\nimport {WanderGame} from \"../wander-game\";\nimport {Quest} from \"./quest\";\nimport {QuestRef} from \"./quest-ref\";\n\nexport class QuestTaskCondition\n{\n\n\n\n\t// comment from ANDROID source\n\t// will be subclassed and possibly changed to Interface + Factory for the future so we can run complex checks around the game context\n\n\tprivate type: QuestTaskConditionType;\n\tprivate target: string;\n\n\tconstructor (type: QuestTaskConditionType, target_value: string)\n\t{\n\t\tthis.type = type;\n\t\tthis.target = target_value;\n\t}\n\n\tverifyCondition (game: WanderGame, quest: QuestRef): boolean\n\t{\n\t\tconsole.log(\"checking condition \", this, \" type \", this.type, \" target \", this.target);\n\t\tif (this.type === QuestTaskConditionType.LOCATION)\n\t\t{\n\t\t\treturn this.verifyConditionLocation(game, quest);\n\n\t\t}\n\t\telse if (this.type === QuestTaskConditionType.COMPLETION)\n\t\t{\n\t\t\treturn this.verifyConditionCompletion(game, quest);\n\t\t}\n\t\telse if (this.type === QuestTaskConditionType.TRIGGER)\n\t\t{\n\t\t\treturn this.verifyConditionTrigger(game, quest);\n\t\t}\n\n\t\t// no extra case since the enum cannot run over?\n\t}\n\n\tstatic fromJSON (src: object): QuestTaskCondition\n\t{\n\t\treturn new QuestTaskCondition(src[\"test\"], src[\"target\"]);\n\t}\n\n\t// NOTE: we might want to subclass conditions if the handling becomes more complex\n\n\tverifyConditionLocation (game: WanderGame, quest: QuestRef): boolean\n\t{\n\t\ttry\n\t\t{\n\t\t\tconsole.log(\"matching pos \", game.hero.pos, game.hero.locpos, \"w\", this.target);\n\t\t\tlet loc = game.worldmap.getLocationById(this.target[\"locid\"]);\n\t\t\tlet hasloc = game.hero.pos != null && game.hero.pos.matches(loc.pos);\n\t\t\tif (hasloc && this.target[\"roomid\"])\n\t\t\t{\n\t\t\t\thasloc = game.hero.locpos[\"roomid\"] === this.target[\"roomid\"];\n\t\t\t}\n\n\t\t\treturn hasloc;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn(\"illegal loc target for location condition: \", this.target);\n\t\t\treturn false;\n\t\t}\n\n\n\t}\n\n\tverifyConditionCompletion (game: WanderGame, quest: QuestRef): boolean\n\t{\n\t\treturn quest.isTaskCompleted(this.target);\n\t}\n\n\tverifyConditionTrigger (game: WanderGame, quest: QuestRef): boolean\n\t{\n\t\t// technically the TRIGGER condition is implicit so this should not be needed but we keep it just in case\n\t\treturn quest.isTaskCompleted(this.target);\n\t}\n\n}\n\nexport enum QuestTaskConditionType {\n\tLOCATION = \"location\",\n\tTRIGGER = \"trigger\",\n\tCOMPLETION = \"completed\"\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {Quest} from \"./quest\";\nimport { SceneFactory } from '../scene-factory';\nimport {QuestRef} from \"./quest-ref\";\n\nexport class QuestTask\n{\n\n\t// a quest task is a container for a scene object that also includes a condition and a number of other items (TBD) such as journal updates etc.\n\n\ttaskid: string;\n\tscene: WanderScene;\n\tjournal_after: string;\n\tprompt: string;\n\n\t// we use this to make the conditions check quicker, a completed  task\n\t// TODO: consider removing the task from the quest altogether after completion\n\t// but for now we'll keep a flag on it\n\tcompleted: boolean;\n\n\t// by default a questtask never triggers anything\n\tcaller: QuestRef;\n\n\t// by default a questtask never triggers anything\n\ttriggered: string;\n\n\tconstructor (taskid: string, scene: WanderScene, prompt: string, journal_after: string)\n\t{\n\t\tthis.taskid = taskid;\n\t\tthis.scene = scene;\n\t\tthis.journal_after = journal_after;\n\t\tthis.prompt = prompt;\n\t\tthis.completed = false;\n\t\tthis.caller = null;\n\t\tthis.triggered = null;\n\t}\n\n\tgetReturnStates (): Map<string, number>\n\t{\n\t\tlet states = new Map<string, number>();\n\n\t\t// TODO: handle multiscene per Java example\n\t\t/*\n\t\tif (this.scene instanceof MultiScene)\n\t\t{\n\t\t\t// this should flatten the hierarchy under it\n\t\t\tMap<String, Integer> scenestates = ((MultiScene)this.scene).returnStates();\n\t\t\tfor (String sceneid: scenestates.keySet())\n\t\t\t{\n\t\t\t\tString sceneidcombo = this.taskid+\".\"+sceneid;\n\t\t\t\tstates.put(sceneidcombo, scenestates.get(sceneid));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstates.put(this.taskid, this.scene.returnState());\n\t\t}\n\t\t*/\n\n\t\tstates.set(this.taskid, this.scene.returnState());\n\t\treturn states;\n\t}\n\n\tsetCaller (questref: QuestRef)\n\t{\n\t\tthis.caller = questref;\n\t}\n\n\tisCompleted (): boolean\n\t{\n\t\treturn this.completed;\n\t}\n\n\tsetCompleted ()\n\t{\n\t\tthis.completed = true;\n\t\tif (this.caller != null)\n\t\t{\n\t\t\tthis.caller.setCompletedTask(this);\n\t\t}\n\t}\n\n\tsetTriggered (taskid: string)\n\t{\n\t\tthis.triggered = taskid;\n\t}\n\n\tstatic fromJSON (src: object): QuestTask\n\t{\n\n\t\t// NOTE: we may want to generate the scene ON THE FLY later\n\n\t\tlet taskid = src[\"taskid\"];\n\t\tlet scene = SceneFactory.fromJSON(src[\"scene\"]);\n\n\t\tlet prompt = src[\"prompt\"];\n\t\tlet journal_after = !src[\"journal_after\"] ? src[\"journal_after\"] : null;\n\n\t\tlet task = new QuestTask (taskid, scene, prompt, journal_after);\n\t\treturn task;\n\t}\n\n}\n","import { WanderScene } from './wander-scene';\nimport { Narration } from './scenes/narration';\nimport {BranchingMetaScene} from \"./scenes/branching-meta-scene\";\nimport {StoryBranch} from \"./scenes/story-branch\";\nimport {SkillTest, SkillTestOption} from \"./scenes/skill-test\";\nimport {WanderSceneTrigger} from \"./scenes/struct/wander-scene-trigger\";\nimport {MultiScene} from \"./scenes/struct/multi-scene\";\nimport {MetaScene} from \"./scenes/meta-scene\";\nexport class SceneFactory {\n\n    public static fromJSON (src: object): WanderScene\n    {\n\n        const GENERATORS_BYTYPE = {\n            \"narrative\": SceneFactory.createSceneNarration,\n\t\t\t\"branching\": SceneFactory.createSceneBranchingMeta,\n\t\t\t\"choice\": SceneFactory.createSceneStoryBranch,\n\t\t\t\"skill\": SceneFactory.createSceneSkillTest\n        };\n\n        console.log(\"generating scen from json: \", src[\"type\"], src[\"data\"]);\n\n        try {\n            return GENERATORS_BYTYPE[src[\"type\"]](src[\"data\"]);\n        }\n        catch (err)\n        {\n        \tconsole.error(err);\n            console.warn(\"cannot yet create scene of type \", src[\"type\"]);\n            return null;\n        }\n\n    }\n\n    // NOTE: we CANNOT put the individual factory methods in the respective classes\n    // because some of them will need to use others (e.g. metascenes) and create a circular import\n\n    static createSceneNarration (src: object): Narration\n    {\n        const paragraphs = src[\"text\"];\n        if (!paragraphs)\n        {\n            throw \"Narrative type scene needs at least one text paragraph\";\n        }\n\n\n        // TODO: TBA\n        let title = null;\n        let images = null;\n\n        return new Narration (null, null, paragraphs, images);\n    }\n\n    static createSceneStoryBranch (src: object): WanderScene\n    {\n\t\tconsole.warn (\"generating STORYBRANCH scene from \", src);\n\n\t\tconst generated = new StoryBranch(null);\n\n\t\tgenerated.prompt = src[\"prompt\"];\n\t\tfor (let optdesc of src[\"options\"])\n\t\t{\n\t\t\tlet endstate = optdesc.hasOwnProperty(\"value\") ? optdesc[\"value\"] : 0;\n\t\t\tlet note = optdesc.hasOwnProperty(\"note\") ? optdesc[\"note\"] : null;\n\t\t\tgenerated.addOption(optdesc[\"description\"], endstate, note);\n\t\t}\n\n\t\tgenerated.setImage(src[\"image\"]);\n\n\n\t\treturn generated;\n    }\n\n\tstatic createSceneSkillTest (src: object): SkillTest {\n\n    \tconst scene = new SkillTest(null);\n\n\t\tif (!!src[\"description\"]) {\n\t\t\tscene.setDesc(src[\"description\"]);\n\t\t}\n\n\t\tfor (let optdesc of src[\"options\"])\n\t\t{\n\t\t\tscene.addAction(SkillTestOption.fromJSON(optdesc));\n\t\t}\n\n\t\tif (!!src[\"image\"])\n\t\t{\n\t\t\tscene.setImage(src[\"image\"]);\n\t\t}\n\n\t\treturn scene;\n\t}\n\n\tstatic createSceneMeta (src: object): MultiScene\n\t{\n\t\tlet generated = new MetaScene (null);\n\t\tfor (let json_scene of src[\"scenes\"])\n\t\t{\n\t\t\tlet sceneid = json_scene[\"id\"];\n\t\t\tlet scene = SceneFactory.fromJSON(json_scene);\n\t\t\tconsole.log(\"Generated sceneobject \", scene, \" w id \" + sceneid);\n\t\t\tscene.setNarrative(generated);\n\t\t\tif (scene != null)\n\t\t\t{\n\t\t\t\tgenerated.addScene(scene, sceneid);\n\t\t\t}\n\t\t}\n\n\t\tfor (let key in src[\"triggers\"])\n\t\t{\n\t\t\tgenerated.setTrigger(key, src[\"triggers\"][key]);\n\t\t}\n\n\n\t\tgenerated.setStarter(src[\"starter\"]);\n\n\n\t\treturn generated;\n\t}\n\n\n\tstatic createSceneBranchingMeta (src: object): WanderScene\n\t{\n\t\tlet generated = new BranchingMetaScene(null);\n\t\tconsole.log(\"Creating BMS from \", src);\n\t\tfor (let json_scene of src[\"scenes\"])\n\t\t{\n\t\t\tlet sceneid = json_scene[\"id\"];\n\t\t\tlet scene = SceneFactory.fromJSON(json_scene);\n\n\t\t\tconsole.log(\"QUEST\", \"Generated sceneobject \", scene, \" w id \" + sceneid);\n\t\t\tif (scene != null) {\n\t\t\t\tscene.setNarrative(generated);\n\t\t\t\tgenerated.addScene(scene, sceneid);\n\t\t\t}\n\t\t}\n\n\t\tfor (let sceneid in src[\"triggers\"]) {\n\t\t\tlet trigger = WanderSceneTrigger.fromJSON(src[\"triggers\"][sceneid]);\n\t\t\tgenerated.setTriggered(sceneid, trigger);\n\t\t}\n\n\t\tgenerated.setStarter(src[\"starter\"]);\n\n\n\t\treturn generated;\n\t}\n\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {MetaScene} from \"./meta-scene\";\nimport {WanderSceneTrigger} from \"./struct/wander-scene-trigger\";\nimport {WanderGame} from \"../wander-game\";\n\nexport class BranchingMetaScene extends MetaScene\n{\n\t// scene triggers are more complex than in MetaScene; as such the key represents the TRIGGERED scene, not the triggerer\n\t// also, there can be only ONE trigger per scene, though it's free in terms of complexity as long as  it's derived from SceneTrigger\n\ttriggers_byscene: Map<string, WanderSceneTrigger>;\n\n\n\tconstructor (game: WanderGame)\n\t{\n\t\tsuper(game);\n\t\tthis.initStructure();\n\t}\n\n\tinitStructure ()\n\t{\n\t\tthis.subs = new Map<string, WanderScene>();\n\t\tthis.triggers_byscene = new Map<string, WanderSceneTrigger>();\n\t\tthis.returncodes = new Map<string, number>();\n\t\tthis.starter = null;\n\t\tthis.activesub = null;\n\t}\n\n\n\tsetTriggered (sceneid: string, trigger: WanderSceneTrigger)\n\t{\n\t\tthis.triggers_byscene.set(sceneid, trigger);\n\t}\n\n\tmoveOn ()\n\t{\n\t\t// NOTE: this method ASSUMES we have a sceneFinished call returning true right before\n\n\t\tconsole.log(\"Quest/BranchingScene: MetaScene \" + this + \" MoveOn from \" + this.activesub);\n\n\t\tthis.returncodes.set(this.activesub, this.getCurrent().returnState());\n\n\t\t// switches to the next scene in the flow\n\t\t// NOTE: it takes the FIRST active trigger, conflicts are not handled\n\t\tthis.activesub = null;\n\t\tfor (let candidate of this.triggers_byscene.keys())\n\t\t{\n\t\t\tlet trigger = this.triggers_byscene.get(candidate);\n\t\t\tlet candidatestate = this.returncodes.get(candidate);\n\t\t\tif (trigger.isActive(this.returncodes) && candidatestate === WanderScene.LEAVESTATE_UNFINISHED)\n\t\t\t{\n\t\t\t\t// we have triggered a new scene\n\t\t\t\tthis.activesub = candidate;\n\t\t\t}\n\t\t}\n\n\t\tconsole.log(\"Quest/MetaScene\", \"MetaScene \" + this + \" MoveOn to \" + this.activesub);\n\t}\n\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {WorldMap} from \"../world/world-map\";\nimport {Place} from \"../world/locs/Place\";\nimport {Roaming} from \"./roaming\";\nimport {WorldPosition} from \"../world/world-position\";\n\nexport class JourneyDeparture  extends  WanderScene {\n\n\tworldmap: WorldMap;\n\n\tdestination: Place;\n\n\tconstructor (game: WanderGame)\n\t{\n\t\tsuper(game);\n\t\tthis.worldmap = game.worldmap;\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn !!this.destination;\n\t}\n\n\tsetDestination (dest: Place)\n\t{\n\t\t// let startingpos = this.game.hero.coordinates;\n\t\t// let destcoords = dest[\"coords\"];\n\t\tthis.destination = dest;\n\t}\n\n\tgetFollowingScene(): WanderScene\n\t{\n\t\tlet next = null;\n\t\tif (!this.destination.matchesPosition(this.game.hero.pos))\n\t\t{\n\t\t\tlet direction = WorldPosition.getRelativeGeneralDirection(this.game.hero.pos, this.destination.pos);\n\t\t\tnext = new Roaming(this.game, this.game.hero.pos, direction);\n\t\t\t// next.setStops(this.game.hero.coordinates, this.destination[\"coords\"]);\n\t\t}\n\t\treturn next;\n\t}\n\n\n\n}\n","import {WanderGame} from \"../wander-game\";\nimport {WanderScene} from \"../wander-scene\";\nimport {WorldPosition} from \"../world/world-position\";\nimport {Place} from \"../world/locs/Place\";\n\nexport class Journey extends WanderScene {\n\n\tstart: WorldPosition;\n\tdest: Place;\n\n\tcourse: WorldPosition[];\n\tstepid: number;\n\n\t// NOTE that start is optional and will default to player's position\n\tconstructor (game: WanderGame, dest: Place, start?: WorldPosition)\n\t{\n\t\tsuper(game);\n\n\t\tthis.start = !start ? game.hero.pos : start;\n\t\tthis.dest = dest;\n\t\tthis.course = game.worldmap.getCourse(this.start, this.dest.pos);\n\t\tthis.stepid = 0;\n\t}\n\n\t// TODO: add support for custom stops in case the player can  (interpolating)\n\n\tstep ()\n\t{\n\t\tthis.stepid++;\n\t}\n\n\tgetCurrentCoordinates (): WorldPosition\n\t{\n\t\tif (this.stepid < this.course.length)\n\t\t{\n\t\t\treturn this.course[this.stepid];\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.dest.pos;\n\t\t}\n\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.stepid >= this.course.length;\n\t}\n\n\tgetStepDirection (stepid: number): number[]\n\t{\n\t\tlet cpos = this.course[stepid];\n\t\tlet nextpos = stepid + 1 < this.course.length ? this.course[stepid + 1] : this.dest.pos;\n\t\treturn [nextpos.x - cpos.x, nextpos.y - cpos.y];\n\t}\n\n\n}\n","import {MultiScene} from \"./struct/multi-scene\";\nimport {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\n\n/**\n *  MetaScene is a Scene that contains several different scenes and has a logic to connect them all\n *  as such it seems to transparently work like a normal scene, but its getFollowing checks on the internal scene graph before giving back the narrative.\n *  Technically each sub-scene is the current active scene except all calls are mediated by the MetaScene above them\n *  NOTE: due to how this works the MetaScene cannot be leaved, the same as with a normal scene.\n *  While it incorporates several scenes, for the purpose of the game all of these act as a single multi-interface scene\n */\nexport class MetaScene extends MultiScene\n{\n\n\tsubs: Map<string, WanderScene>;\n\n\t// using this to bubble up complex combos of return codes automatically (the scene could be destroyed before the info is retrieved)\n\treturncodes: Map<string, number>;\n\n\t// note: for now the implementation is simple: ENDING one scene passes to the next according to this map\n\t// in the future there may be a more comples trigger system that includes conditions of some kind\n\t// so we can handle different outcomes (though usually this should fall on the quest entity)\n\t// the KEY is the scene that must end to make the triggered one start\n\ttriggers: Map<string, string>;\n\t// trigger sequences are checked from starter on\n\tstarter: string;\n\tactivesub: string;\n\n\t// NOTE: the following may not be needed for now since we check getFollowing\n\t// only after checking that the current scene is finished. Keep in mind this can be easily\n\t// broken if the storyteller flow gets messed up. WATCH THIS FOR DEBUG then\n\n\t// completion status IF COMPLETED ONLY is set in this map for quicker checking\n\t// when the trigger sequence is rechecked so we can quickly see if the whole chain is complete\n\t// NOTE: we use a map because in the future conditions may be more complex and we may have\n\t// chains completed without all possible scenes completed\n\t// (or we could template the thing so we create a complex set of scene but only enable\n\t// chaining on a subset of them)\n\t// private Map<String, Boolean> completion;\n\n\tconstructor (game: WanderGame)\n\t{\n\t\tsuper(game);\n\t\tthis.initStructure();\n\t}\n\n\tinitStructure ()\n\t{\n\t\tthis.subs = new Map<string, WanderScene>();\n\t\tthis.triggers = new Map<string, string>();\n\t\tthis.returncodes = new Map<string, number>();\n\t\tthis.starter = null;\n\t\tthis.activesub = null;\n\t}\n\n\tpublic getFollowing (): WanderScene\n\t{\n\t\tthis.moveOn();\n\t\tif (this.subs.has(this.activesub))\n\t\t{\n\t\t\treturn this;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.getNarrative();\n\t\t}\n\t}\n\n\tgetCurrent (): WanderScene\n\t{\n\t\tlet current = this.getSceneById(this.activesub);\n\t\tif (current instanceof MultiScene)\n\t\t{\n\t\t\tlet ms = current as MultiScene;\n\t\t\treturn ms.getCurrent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn current;\n\t\t}\n\t}\n\n\n\treturnStates(): Map<string, number> {\n\t\treturn this.returncodes;\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.activesub == null || this.getSceneById(this.activesub).sceneFinished();\n\t}\n\n\t// addScene, setTrigger, setStarter are separated\n\t// so it's easier to use factory methods or static fromjson creators\n\n\taddScene(candidate: WanderScene, sceneid: string)\n\t{\n\t\tthis.subs.set(sceneid, candidate);\n\t\tthis.returncodes.set(sceneid, WanderScene.LEAVESTATE_UNFINISHED);\n\t}\n\n\tsetTrigger (triggerer: string, triggered: string)\n\t{\n\t\tthis.triggers.set(triggerer, triggered);\n\t}\n\n\tsetStarter (sceneid: string)\n\t{\n\t\tconsole.log(\"Quest/MetaScene\", \"Setting starter for metascene to \" + sceneid);\n\t\tthis.starter = sceneid;\n\t\tif (this.activesub == null)\n\t\t{\n\t\t\tthis.activesub = this.starter;\n\t\t}\n\t}\n\n\n\n\tgetSceneById (sceneid: string): WanderScene\n\t{\n\t\tconsole.log (\"Loading META SUB scene \" + sceneid + \" from \", this.subs);\n\t\ttry\n\t\t{\n\t\t\treturn this.subs.get(sceneid);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn(\"error retrieving sub \" + sceneid + \": \", err);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\n\tmoveOn ()\n\t{\n\t\t// NOTE: this method ASSUMES we have a sceneFinished call returning true right before\n\t\tconsole.warn(\"Quest/MetaScene\", \"MetaScene \" + this + \" MoveOn from \" + this.activesub);\n\n\t\t// retrieving and adding return codes for subscenes if current active is a MultiScene\n\t\tlet active: WanderScene = this.subs.get(this.activesub);\n\t\tif (active instanceof MultiScene)\n\t\t{\n\t\t\tlet ms = active as MultiScene;\n\t\t\tlet states = ms.returnStates();\n\t\t\tfor (let sceneid of states.keys())\n\t\t\t{\n\t\t\t\tlet sceneidcombo = this.activesub + \".\" + sceneid;\n\t\t\t\tthis.returncodes.set(sceneidcombo, states.get(sceneid));\n\t\t\t}\n\t\t}\n\t\tthis.returncodes.set(this.activesub, active.returnState());\n\n\t\t// switches to the next scene in the flow\n\t\t// so we can remove flow control from getFollowing\n\t\tif (this.triggers.has(this.activesub))\n\t\t{\n\t\t\t// we have triggered a new scene\n\t\t\tthis.activesub = this.triggers.get(this.activesub);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// there was already no active subscene OR we are at the end of our trigger chain\n\t\t\tthis.activesub = null;\n\n\t\t}\n\t\tconsole.log(\"Quest/MetaScene\", \"MetaScene \" + this + \" MoveOn to \" + this.activesub);\n\n\t}\n\n\n\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\n\nexport class Narration extends WanderScene\n{\n\n\timages: string[];\n\tparagraphs: string[];\n\ttitle: string;\n\n\tprogress: number;\n\n\t// keep back button visible so the user can re-read stuff\n\tallowReadBack: boolean;\n\t// keep the title visible on all sub-pages rather than on the first only\n\tkeepTitleOn: boolean;\n\n\tconstructor (game: WanderGame, title: string, paragraphs: string[], images: string[] = [])\n\t{\n\t\tsuper(game);\n\n\t\tthis.progress = 0;\n\t\tthis.allowReadBack = true;\n\t\tthis.keepTitleOn = true;\n\n\t\tthis.paragraphs = paragraphs;\n\t\tthis.images = images;\n\t\tthis.title = title;\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.progress >= this.paragraphs.length - 1;\n\t}\n\n\tadvanceNarration ()\n\t{\n\t\tthis.progress =  Math.min(this.progress + 1, this.paragraphs.length - 1);\n\t}\n\n\tbacktrackNarration ()\n\t{\n\t\tthis.progress = Math.max(this.progress - 1, 0);\n\t}\n\n\tgetCurrent (): string\n\t{\n\t\treturn this.paragraphs[this.progress];\n\t}\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {TerrainPass} from \"../world/locs/TerrainPass\";\nimport {JourneyDeparture} from \"./journey-departure\";\nimport {WorldPosition} from \"../world/world-position\";\n\nexport class PassageTrail extends WanderScene\n{\n\n\t/**\n\t * The TerrainPass location being traversed.\n\t * Since passes can generate TWO trails, back and forth, we extract the significant elemnents in the trail_* values with resetTrail() according to the current position of the player.\n\t * Since we are outside the normal map fl,ow, the position of the player is updated only at the end of the current trail.\n\t */\n\tpassage: TerrainPass;\n\n\t// trail_* are the values generated from passage with direction applied\n\ttrail_start: WorldPosition;\n\ttrail_end: WorldPosition;\n\ttrail_length: number;\n\n\t/**\n\t * where the player is on the current trail\n\t */\n\tprogress: number;\n\t/**\n\t * whether the player chose to leave AFTER reaching an end (for scenecheck)\n\t */\n\tleaving: boolean;\n\n\t// tracker for total number of days spent in the passage?\n\tdays: number;\n\n\tconstructor (game: WanderGame, passage: TerrainPass, started: boolean = false)\n\t{\n\t\tsuper(game);\n\t\tthis.passage = passage;\n\t\t// progress is the speed, negative allows to go back and reverse\n\t\tthis.resetTrail(started);\n\t\tthis.days = 0;\n\t\tthis.leaving = false;\n\t}\n\n\tresetTrail (started: boolean = false)\n\t{\n\t\tconst reversed = this.passage.exitpoint.matches(this.game.hero.pos);\n\t\tthis.trail_start = reversed ? this.passage.exitpoint : this.passage.pos;\n\t\tthis.trail_end = reversed ? this.passage.pos : this.passage.exitpoint;\n\t\tthis.trail_length = this.passage.length();\n\t\tthis.progress = started ? 0 : -1;\n\t}\n\n\tsceneFinished(): boolean\n\t{\n\t\t// boolean set by UI\n\t\tconsole.log(\"is at exit? \" + this.isAtExitPoint() + \"is leaving? \" + this.leaving);\n\t\treturn this.isAtExitPoint() && this.leaving;\n\t}\n\n\tgetFollowingScene(): WanderScene {\n\t\treturn new JourneyDeparture(this.game);\n\t}\n\n\tisAtExitPoint ()\n\t{\n\t\treturn this.progress === -1 || this.progress === this.passage.length();\n\t}\n\n\tstep ()\n\t{\n\t\tthis.progress += 1;\n\t\t// this.progress += direction;\n\t\tthis.progress = Math.min(Math.max(this.progress, -1), this.passage.length());\n\t\tif (this.progress === this.passage.length())\n\t\t{\n\t\t\tthis.game.hero.setCoordinates(this.trail_end);\n\t\t\tthis.resetTrail();\n\t\t}\n\t}\n\n\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WorldPosition} from \"../world/world-position\";\nimport {WanderGame} from \"../wander-game\";\nimport {Place} from \"../world/locs/Place\";\n\nexport class Roaming extends WanderScene {\n\n\tstatic DIRECTIONS = [\n\t\t[0, -1], // NORTH\n\t\t[1, -1],\n\t\t[1, 0], // EAST\n\t\t[1, 1],\n\t\t[0, 1], // SOUTH\n\t\t[-1, 1],\n\t\t[-1, 0], // WEST\n\t\t[-1, -1]\n\t];\n\n\tcurrent: WorldPosition;\n\tdirection: number[];\n\n\t// starting point, just for narration (duplicated to first current)\n\tstart: WorldPosition;\n\tstartloc: Place;\n\n\t// steps so far, just for narration\n\tsteps: number;\n\n\t// NOTE that start is optional and will default to player's position, direction to N?\n\tconstructor (game: WanderGame, start?: WorldPosition, direction?: number[]) {\n\t\tsuper(game);\n\n\t\tthis.direction = !direction ? [0, -1] : direction;\n\t\tthis.start = !start ? this.game.hero.pos : start;\n\t\tthis.current = this.start;\n\t\tthis.steps = 0;\n\n\t\tthis.startloc = this.game.worldmap.getLocationAt(this.start.getCoords());\n\t}\n\n\tsceneFinished(): boolean {\n\t\t// scene ends when you reach a Place\n\t\treturn this.game.worldmap.getLocationAt(this.current.getCoords()) != null;\n\t}\n\n\tstepInto (pos: WorldPosition)\n\t{\n\t\tthis.direction = [pos.x - this.current.x, pos.y - this.current.y];\n\t\tthis.current = pos;\n\t}\n\n\tstepForward ()\n\t{\n\t\tthis.steps++;\n\t\tthis.stepInto(this.current.getShifted(this.direction[0], this.direction[1]));\n\t}\n\n\tprivate getCurrentDirectionIndex ()\n\t{\n\t\tfor (let i = 0; i < Roaming.DIRECTIONS.length; i++)\n\t\t{\n\t\t\tif (Roaming.DIRECTIONS[i][0] === this.direction[0] && Roaming.DIRECTIONS[i][1] === this.direction[1])\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t// steps are in CLOCKWISE order\n\tchangeDirection (steps: number)\n\t{\n\t\tlet cidx = this.getCurrentDirectionIndex();\n\t\tlet nidx = (cidx + Roaming.DIRECTIONS.length + steps) % Roaming.DIRECTIONS.length;\n\t\tthis.direction = Roaming.DIRECTIONS[nidx];\n\t}\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {SkillSystem} from \"../skill-system/skill-system\";\nimport {AgentEntity} from \"../skill-system/agent-entity\";\n\nexport class SkillTest extends WanderScene\n{\n\t// keeping this as maps in case we need a more complex handling in the future, though basically it's an arraylist\n\toptions: SkillTestOption[];\n\n\t// whether the player can leave the scene\n\tcanleave: boolean;\n\tsituation: string;\n\tsuccess: number;\n\n\t// played is different from success != 0 ince we have the condition to leave\n\tplayed: boolean;\n\n\timage: string;\n\n\n\tconstructor (game: WanderGame)\n\t{\n\t\tsuper(game);\n\t\t// a skill test is a scene in which the player is given a set of possible skill throws, each with its own return code\n\n\t\tthis.options = [];\n\t\tthis.canleave = true;\n\t\tthis.success = 0;\n\t\tthis.played = false;\n\t\tthis.image = null;\n\t}\n\n\tsceneFinished(): boolean\n\t{\n\t\tconsole.log(\"checking scene finished for SkillTest\", this.played);\n\t\treturn this.played;\n\t}\n\n\tsetImage (filename: string)\n\t{\n\t\tthis.image = filename;\n\t}\n\n\treturnState (): number\n\t{\n\t\t// 0 is not finished/played yet\n\t\t// all alternatives are X for success, -X for failure\n\t\t// TODO: add other standard return codes (plus handling for custom results)\n\t\t// also see the addAction todo note\n\n\t\t// NOTE: Leaving the skilltest without trying (when allowed by the scene design)\n\t\t// implies getting a status of 0 and a sceneFinished = True\n\t\t// TODO: find a way to set this\n\t\treturn this.success;\n\t}\n\n\n\tsetDesc (situation: string)\n\t{\n\t\tthis.situation = situation;\n\t}\n\n\tsetCanLeave (allow: boolean)\n\t{\n\t\tthis.canleave = allow;\n\t}\n\n\taddAction (option: SkillTestOption)\n\t{\n\t\tthis.options.push(option);\n\t}\n\n\n\tplayActionDebug (option: SkillTestOption, succeed: boolean): boolean\n\t{\n\t\t// ONLY for debug, dev can force success or fail while we develop and balance the skill system\n\n\t\tif (succeed)\n\t\t{\n\t\t\tthis.success = option.returncode;\n\t\t\tthis.played = true;\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// 0 is infinitely repeatable\n\t\t\tif (!option.isInfinitelyRepeatable())\n\t\t\t{\n\t\t\t\toption.addTry();\n\t\t\t\tif (!option.isStillRepeatable())\n\t\t\t\t{\n\t\t\t\t\tthis.success = -option.returncode;\n\t\t\t\t\tthis.played = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\tplayAction (option: SkillTestOption, rules: SkillSystem, user: AgentEntity): boolean\n\t{\n\n\t\t// TODO: get SkillSystem and AgentEntity from game\n\n\t\tconst actionid = option.skillactionid;\n\t\tconst target = option.target;\n\n\t\tconst performance = rules.applySkill(actionid, user);\n\t\tif (performance >= target)\n\t\t{\n\t\t\tthis.success = option.returncode;\n\t\t\tthis.played = true;\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// 0 is infinitely repeatable\n\t\t\tif (!option.isInfinitelyRepeatable())\n\t\t\t{\n\t\t\t\toption.addTry();\n\t\t\t\tif (!option.isStillRepeatable())\n\t\t\t\t{\n\t\t\t\t\tthis.success = -option.returncode;\n\t\t\t\t\tthis.played = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\tleaveAction ()\n\t{\n\t\tthis.played = true;\n\t\t// redundant, for clarity\n\t\tthis.success = 0;\n\t}\n\n\n\n\n}\n\nexport class SkillTestOption\n{\n\tskillactionid: string;\n\tdescription: string;\n\tstory_failure: string;\n\tstory_success: string;\n\n\tmax_tries: number;\n\ttarget: number;\n\treturncode: number;\n\ttried: number;\n\n\tconstructor (skillactionid: string, target: number)\n\t{\n\t\tthis.skillactionid = skillactionid;\n\t\tthis.target = target;\n\t\t// default is infinite retries\n\t\tthis.max_tries = 0;\n\t\tthis.tried = 0;\n\t}\n\n\n\taddTry ()\n\t{\n\t\tthis.tried++;\n\t}\n\n\tisStillRepeatable(): boolean\n\t{\n\t\treturn this.max_tries != 0 || this.tried < this.max_tries;\n\t}\n\n\tisRepeatable(): boolean\n\t{\n\t\treturn this.max_tries != 1;\n\t}\n\n\tisInfinitelyRepeatable(): boolean\n\t{\n\t\treturn this.max_tries == 0;\n\t}\n\n\tsetRepeatable (max_tries: number)\n\t{\n\t\tthis.max_tries = max_tries;\n\t}\n\n\tsetText (description: string, success: string, failure: string)\n\t{\n\t\tthis.description = description;\n\t\tthis.story_success = success;\n\t\tthis.story_failure = failure;\n\t}\n\n\tgetFeedbackSuccess (): string\n\t{\n\t\tif (this.story_success != null)\n\t\t{\n\t\t\treturn this.story_success;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn \"You succeed\";\n\t\t}\n\t}\n\n\tgetFeedbackFailure (): string\n\t{\n\t\tif (this.story_failure != null)\n\t\t{\n\t\t\treturn this.story_failure;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn \"You failed\";\n\t\t}\n\t}\n\n\tgetDescription (): string\n\t{\n\t\tif (this.description != null)\n\t\t{\n\t\t\treturn this.description;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn \"Try your \"+this.skillactionid+\" ability\";\n\t\t}\n\t}\n\n\tstatic fromJSON (src: object):  SkillTestOption\n\t{\n\t\tconst actionid = src[\"action\"];\n\t\tconst target = src[\"target\"];\n\t\tlet created = new SkillTestOption(actionid, target);\n\t\tif (src.hasOwnProperty(\"repeatable\"))\n\t\t{\n\t\t\tcreated.setRepeatable(src[\"repeat\"]);\n\t\t}\n\n\t\tlet description = !!src[\"prompt\"] ? src[\"prompt\"] : \"Use your ability at \"+actionid;\n\t\tlet success = !!src[\"success\"] ? src[\"successs\"] : \"Succeded in \"+actionid;\n\t\tlet failure = !!src[\"failure\"] ? src[\"failure\"] : \"Failed at \"+actionid;\n\n\t\tcreated.setText(description, success, failure);\n\n\t\t// note that the match does not get LEAVESTATE_FINISHED as a value, but falls back to it anyway\n\t\tcreated.returncode = !!src[\"returncode\"] ? src[\"returncode\"] : WanderScene.LEAVESTATE_FINISHED;\n\n\t\treturn created;\n\n\t}\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\n\nexport class StoryBranch extends WanderScene\n{\n\t/**\n\t * Option selection without specific conditions, returns the chosen option\n\t */\n\n\t// simple selection of options without specific conditions, returns the choice\n\t// TODO: add subclass with conditions connected to the display of each choice\n\n\t// maps an optionid to the leave state of the scene\n\t// (it is technically possible to have the same leave state for several options,\n\t// plus 0 cannot be used since it's generic scene finished value so a straight association would not work)\n\n\toptions: ChoiceOption[];\n\n\t// options: Map<number, number>;\n\t// descriptions: Map<number, string>;\n\t// notes: Map<number, string>;\n\n\tprivate selected: ChoiceOption;\n\n\timage: string;\n\tprompt: string;\n\n\n\n\tconstructor (game: WanderGame)\n\t{\n\t\t// a skill test is a scene in which the player is given a set of possible skill throws, each with its own return code\n\t\tsuper(game);\n\t\tthis.prompt = null;\n\t\tthis.options = [];\n\t\t// this.options = new Map<number, number>();\n\t\t// this.descriptions = new Map<number, string>();\n\t\t// this.notes = new Map<number, string>();\n\t\tthis.selected = null;\n\t\tthis.image = null;\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.returnState() !== WanderScene.LEAVESTATE_UNFINISHED;\n\t}\n\n\tsetImage (filename: string)\n\t{\n\t\tthis.image = filename;\n\t}\n\n\taddOption (desc: string, endstate: number = 0, note: string = null)\n\t{\n\t\tlet nextcode = this.options.length + 1;\n\t\tthis.options.push({\n\t\t\toptionid: nextcode,\n\t\t\tleavestate: endstate,\n\t\t\tdescription: desc,\n\t\t\tnotes: note\n\t\t});\n\n\t}\n\n\tsetSelected (opt: ChoiceOption)\n\t{\n\t\tthis.selected = opt;\n\t}\n\n\treturnState (): number\n\t{\n\t\treturn !!this.selected ? this.selected.leavestate : -1;\n\t}\n\n\n}\n\n\n\nexport interface ChoiceOption {\n\n\toptionid: number;\n\tleavestate: number;\n\tdescription: string;\n\tnotes: string;\n\n}\n","import {WanderScene} from \"../../wander-scene\";\n\nexport abstract class MultiScene extends WanderScene\n{\n\tabstract getCurrent (): WanderScene;\n\n\tabstract returnStates (): Map<string, number>;\n}\n","import {LeaveStatesMap, WanderScene} from \"../../wander-scene\";\n\nexport class WanderSceneTriggerCondition {\n\n\tsceneid: string;\n\tstatevalue: number;\n\tmustmeet: boolean;\n\n\n\tconstructor(sceneid: string, valuestate: number, mustmeet: boolean)\n\t{\n\t\tthis.sceneid = sceneid;\n\t\tthis.statevalue = valuestate;\n\t\tthis.mustmeet = mustmeet;\n\t}\n\n\tcheckCondition (leavestates: LeaveStatesMap): boolean\n\t{\n\t\tlet leavestate = leavestates.has(this.sceneid) ? leavestates.get(this.sceneid) : WanderScene.LEAVESTATE_UNFINISHED;\n\t\treturn this.mustmeet ? leavestate === this.statevalue : leavestate !== this.statevalue;\n\t}\n\n\tstatic fromJSON (src: object): WanderSceneTriggerCondition\n\t{\n\t\tconst sceneid = src[\"sceneid\"];\n\t\tconst statevalue = src[\"endstate\"];\n\t\tlet mustmeet = true;\n\t\tif (src.hasOwnProperty(\"mustnot\")) {\n\t\t\tmustmeet = !src[\"mustnot\"];\n\t\t}\n\t\treturn new WanderSceneTriggerCondition(sceneid, statevalue, mustmeet);\n\t}\n\n}\n","import {WanderSceneTriggerCondition} from \"./wander-scene-trigger-condition\";\nimport {LeaveStatesMap} from \"../../wander-scene\";\n\nexport class WanderSceneTrigger {\n\n\t/*\n\t\t// if all conditions in this list are met, the trigger is triggered\n\t\tprivate ArrayList<SceneTriggerCondition> needed;\n\t\t// if any condition in this list is met, the trigger is not triggered\n\t\tprivate ArrayList<SceneTriggerCondition> blockers;\n\t*/\n\n\tneeded: WanderSceneTriggerCondition[];\n\tblockers: WanderSceneTriggerCondition[];\n\n\tconstructor ()\n\t{\n\t\tthis.needed = [];\n\t\tthis.blockers = [];\n\t}\n\n\t/**\n\t * Adds a condition, by default as needed unless specified as blocker\n\t * @param condition trigger condition for this scene\n\t * @param asblocker whether the condition is a blocker, defaults to needed\n\t */\n\taddCondition (condition: WanderSceneTriggerCondition, asblocker: boolean = false)\n\t{\n\t\t(asblocker ? this.blockers : this.needed).push(condition);\n\t}\n\n\tisActive (leavestates: LeaveStatesMap): boolean\n\t{\n\t\tfor (let triggercondition of this.blockers)\n\t\t{\n\t\t\tif (triggercondition.checkCondition(leavestates))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let triggercondition of this.needed)\n\t\t{\n\t\t\tif (!triggercondition.checkCondition(leavestates))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tstatic fromJSON (src: object): WanderSceneTrigger\n\t{\n\t\tconst trigger = new WanderSceneTrigger();\n\t\tif (src.hasOwnProperty(\"c_for\"))\n\t\t{\n\t\t\tfor (let conditiondef of src[\"c_for\"])\n\t\t\t{\n\t\t\t\ttrigger.addCondition(WanderSceneTriggerCondition.fromJSON(conditiondef), false);\n\t\t\t}\n\t\t}\n\t\tif (src.hasOwnProperty(\"c_against\"))\n\t\t{\n\t\t\tfor (let conditiondef of src[\"c_against\"])\n\t\t\t{\n\t\t\t\ttrigger.addCondition(WanderSceneTriggerCondition.fromJSON(conditiondef), true);\n\t\t\t}\n\t\t}\n\t\treturn trigger;\n\t}\n\n}\n","import {WanderScene} from \"../wander-scene\";\nimport {WanderGame} from \"../wander-game\";\nimport {Town} from \"../world/locs/Town\";\nimport {Place} from \"../world/locs/Place\";\nimport {JourneyDeparture} from \"./journey-departure\";\nimport { QuestTask } from '../quests/quest-task';\n\nexport class TownNav extends WanderScene  {\n\n\ttown: Town;\n\tlocpoint: string;\n\ttownstruct: object;\n\n\tstatic LOC_LEAVE = \"OUT\";\n\tstatic LOC_OUTSKIRTS = \"LEAVE\";\n\n\tcurrentloc: TownLocStructure;\n\n\tconstructor (game: WanderGame, place?: Place)\n\t{\n\t\tsuper(game);\n\t\tthis.town = place as Town;\n\n\t\tconsole.log(game.worldmeta);\n\t\tthis.townstruct = game.worldmeta[\"townstructure\"][\"major\"];\n\t\tthis.locpoint = TownNav.LOC_OUTSKIRTS;\n\t\tthis.updateLocation();\n\t}\n\n\tupdateLocation ()\n\t{\n\t\tthis.currentloc = this.getLocStructure();\n\t\tif (this.locpoint !== TownNav.LOC_LEAVE)\n\t\t{\n\t\t\tthis.game.hero.locpos = {\n\t\t\t\t\"locid\": this.town.locid,\n\t\t\t\t\"roomid\": this.locpoint\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.game.hero.locpos = null;\n\t\t}\n\t}\n\n\tgetFollowingScene(): WanderScene {\n\t\treturn new JourneyDeparture(this.game);\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn this.locpoint === TownNav.LOC_LEAVE;\n\t}\n\n\tgetLocStructure (): TownLocStructure\n\t{\n\t\treturn this.townstruct[\"locs\"][this.locpoint];\n\t}\n\n\tmoveToLoc (locid: string)\n\t{\n\t\tthis.locpoint = locid;\n\t\tthis.updateLocation();\n\t}\n\n\n\n}\n\nexport interface TownLocStructure\n{\n\tlocid: string;\n\tdescription: string;\n\tmoves: {\n\t\t\"target\": string,\n\t\t\"prompt\": string\n\t}[];\n\timage: string;\n}\n","export class SimpleSkillSet\n{\n\n\tpotentials: Map<string, number>;\n\tdevelopments: Map<string, number>;\n\n\tconstructor ()\n\t{\n\t\tthis.potentials = new Map<string, number>();\n\t\tthis.developments = new Map<string, number>();\n\t}\n\n\n\tregisterPotential (id: string, basevalue: number)\n\t{\n\t\tthis.potentials.set(id, basevalue);\n\t}\n\n\tregisterDevelopment (id: string, basevalue: number)\n\t{\n\t\tthis.developments.set(id, basevalue);\n\t}\n\n\tpublic getPotential (id: string)\n\t{\n\t\treturn this.potentials.has(id) ? this.potentials.get(id) : 0;\n\t}\n\n\tpublic getDevelopment (id: string)\n\t{\n\t\treturn this.developments.has(id) ? this.developments.get(id) : 0;\n\t}\n\n\n\n}\n\n","import {SimpleSkillThrow} from \"./simple-skill-throw\";\nimport {AgentEntity} from \"./agent-entity\";\nimport {SimpleSkillSet} from \"./simple-skill-set\";\n\nexport class SimpleSkillSystem\n{\n\n\t// basic skill system just for testing purposes\n\tpotentials: string[];\n\tactions: Map<string, SimpleSkillThrow>;\n\n\tconstructor ()\n\t{\n\t\tthis.potentials = [];\n\t\tthis.actions = new Map<string, SimpleSkillThrow>();\n\t}\n\n\tstatic fromJSON (src: object): SimpleSkillSystem\n\t{\n\t\tlet created = new SimpleSkillSystem();\n\t\tcreated.potentials = src[\"potentials\"];\n\t\tfor (let actionid in src[\"actions\"])\n\t\t{\n\t\t\tcreated.actions.set(actionid, SimpleSkillThrow.fromJson(src[\"actions\"][actionid]));\n\t\t}\n\t\treturn created;\n\t}\n\n\tstatic getLowestBalanced (series: number[]): number\n\t{\n\t\tlet lowest = series[0];\n\t\tfor (let current of series)\n\t\t{\n\t\t\tlowest = Math.min(lowest, current);\n\t\t}\n\n\t\tlet numlowest = 0;\n\t\tfor (let current of series)\n\t\t{\n\t\t\tif (current === lowest)\n\t\t\t{\n\t\t\t\tnumlowest++;\n\t\t\t}\n\t\t}\n\n\t\tif (numlowest<2)\n\t\t{\n\t\t\treturn numlowest+1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn numlowest;\n\t\t}\n\t}\n\n\tstatic getHighest (series: number[]): number\n\t{\n\t\tlet highest = series[0];\n\t\tfor (let current of series)\n\t\t{\n\t\t\thighest = Math.max(highest, current);\n\t\t}\n\t\treturn highest;\n\t}\n\n\tapplySkill (actionid: string, agent: AgentEntity)\n\t{\n\t\tconst agentskills = agent.getSkills();\n\t\tconst action = this.actions.get(actionid);\n\t\tlet pot_vals = [];\n\t\tfor (let potential of action.potentials)\n\t\t{\n\t\t\tpot_vals.push(agentskills.getPotential(potential));\n\t\t}\n\n\t\tlet dev_vals = [];\n\t\tfor (let development of action.developments)\n\t\t{\n\t\t\tdev_vals.push(agentskills.getDevelopment(development));\n\t\t}\n\n\t\tlet potval = pot_vals.length > 1 ? SimpleSkillSystem.getLowestBalanced(pot_vals) : pot_vals[0];\n\t\tlet devval = dev_vals.length > 1 ? SimpleSkillSystem.getHighest(dev_vals) : dev_vals[0];\n\n\t\tlet dicethrow = 0;\n\t\tfor (let i = 0; i < devval; i++)\n\t\t{\n\t\t\tdicethrow += Math.floor(Math.random()*potval)+1;\n\t\t}\n\n\t\treturn dicethrow;\n\t}\n\n\n\n}\n","export class SimpleSkillThrow\n{\n\n\tpotentials: string[];\n\tdevelopments: string[];\n\n\n\tconstructor (req_pots: string[], req_devs: string[])\n\t{\n\t\tthis.potentials = req_pots;\n\t\tthis.developments = req_devs;\n\t}\n\n\tstatic fromJson(src: object): SimpleSkillThrow\n\t{\n\t\treturn new SimpleSkillThrow(src[\"pot\"], src[\"dev\"]);\n\t}\n\n}\n","import { WanderGame } from './wander-game';\n\n/**\n * Saves game state to a SINGLE save space\n */\nexport class WanderGameState {\n\n\n    static KEY_SAVESTATE_DATA = \"WanderSaveGame\";\n\n    static applyGameState (state: object, game: WanderGame)\n\t{\n\t\t// modifies game in place with vars from GameState saved data\n\t\t\n\t}\n\n\tstatic loadFromBrowser ()\n\t{\n        console.log(\"loading game state from browser WebStorage\");\n        let loaded = localStorage.getItem(WanderGameState.KEY_SAVESTATE_DATA);\n        console.log (\"loaded\", loaded);\n        if (loaded !== null)\n        {\n            loaded = JSON.parse(loaded);\n        }\n        // TODO: create proper structure (actual WanderGameState object)\n        return loaded;\n\t}\n\n\tstatic saveToBrowser (game: WanderGame)\n\t{\n\t\tconsole.log(\"saving game state to browser for Game\");\n\t\tconsole.log(\"saving hero state, position\", game.hero.pos);\n\n        let savegame = {\n            hero: {\n                position: [game.hero.pos.x, game.hero.pos.y]\n            }\n        }\n\n        localStorage.setItem(WanderGameState.KEY_SAVESTATE_DATA, JSON.stringify(savegame));\n\n\t}\n}\n","import {HttpClient} from \"@angular/common/http\";\nimport {WorldMap} from \"./world/world-map\";\nimport {WanderHero} from \"./wander-hero\";\nimport {WanderScene} from \"./wander-scene\";\nimport {QuestRef} from \"./quests/quest-ref\";\nimport {ResLoader} from \"../support/res-loader\";\nimport {SkillSystem} from \"./skill-system/skill-system\";\nimport {SimpleSkillSystem} from \"./skill-system/simple-skill-system\";\nimport {MetaScene} from \"./scenes/meta-scene\";\n\nexport class WanderGame {\n\n\tactivescene: WanderScene;\n\thero: WanderHero;\n\tworldmap: WorldMap;\n\tworldmeta: object;\n\t// TODO: load quest data on demand and just use triggers\n\tquests: Map<string, QuestRef>;\n\n\tskillsystem: SkillSystem;\n\n\tconstructor(private loader: ResLoader)\n\t{\n\t\tthis.quests = new Map<string, QuestRef>();\n\t}\n\n\tstatic loadGame (http: HttpClient, callback: (game: WanderGame) => void): void\n\t{\n\t\tconst loader = new GameFactory(http);\n\t\tloader.loadDemoGame(function (game: WanderGame, factory: GameFactory)\n\t\t{\n\t\t\tconsole.log(\"loaded game \", game);\n\t\t\tconsole.log(\"built from factory \", factory);\n\t\t\tcallback(game);\n\t\t});\n\n\t}\n\n\t// DEBUG FUNCTIONS FOR QUICK TESTING\n\n\tsetHero (hero: WanderHero)\n\t{\n\t\tthis.hero = hero;\n\t}\n\n\tsetWorldMap (worldmap: WorldMap)\n\t{\n\t\tthis.worldmap = worldmap;\n\t}\n\n\tsetWorldMeta (src: object)\n\t{\n\t\t// TODO: placeholder\n\t\tthis.worldmeta = src;\n\t}\n\n\tsetSkillSystem (skillsys: SkillSystem)\n\t{\n\t\tthis.skillsystem = skillsys;\n\t}\n\n\tsetActiveScene (scene: WanderScene)\n\t{\n\t\tconsole.log(\"setting activescene to \", scene);\n\n\t\tif (scene instanceof MetaScene)\n\t\t{\n\t\t\tconsole.log(\"should switch to internal scene for metascene\");\n\t\t\tthis.activescene = scene.getCurrent();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.activescene = scene;\n\t\t}\n\n\t\tconsole.log(\"ACTIVESCENE:\", this.activescene);\n\t}\n\n\tgetActiveScene (): WanderScene\n\t{\n\t\treturn this.activescene;\n\t}\n\n\taddQuest (qref: QuestRef)\n\t{\n\t\tthis.quests.set(qref.questid, qref);\n\t}\n\n\n}\n\nclass GameFactory {\n\n\tdataset: object;\n\tloader: ResLoader;\n\n\tconstructor(protected http: HttpClient) {\n\t\tthis.dataset = {\n\t\t\t\"locs\": null,\n\t\t\t\"terrain\": null,\n\t\t\t\"player\": null,\n\t\t\t\"quests\": null,\n\t\t\t\"worldmeta\": null,\n\t\t\t\"skillsys\": null\n\t\t};\n\n\t\tthis.loader = new ResLoader(this.http);\n\t}\n\n\n\n\n\n\tloadDemoGame (callback: Function) {\n\n\t\tconst sources = {\n\t\t\t\"locs\": \"./assets/gamedata/testlocations.json\",\n\t\t\t\"terrain\": \"./assets/gamedata/testmapgame.json\",\n\t\t\t\"player\": \"./assets/gamedata/playerdata.json\",\n\t\t\t\"worldmeta\": \"./assets/gamedata/worlddesign.json\",\n\t\t\t\"skillsys\": \"./assets/gamedata/simpleskillactions.json\"\n\t\t};\n\n\t\tlet loader: GameFactory = this;\n\n\t\tfunction getCheckerFunction(key: string): Function {\n\t\t\treturn function (data: any) {\n\t\t\t\tloader.setData(key, data, callback);\n\t\t\t};\n\t\t}\n\n\t\tfor (let key of Object.keys(sources)) {\n\t\t\tlet path = sources[key];\n\t\t\tlet checker = getCheckerFunction(key);\n\t\t\tthis.loader.loadDataFile(path, checker);\n\t\t}\n\n\t\tlet QPATH = \"./assets/gamedata/quests/\";\n\t\tlet QUESTS = [\n\t\t\tQPATH + \"drunkquest.json\",\n\t\t\tQPATH + \"sidestreetquest.json\",\n\t\t\t// QPATH + \"simpleskillactions.json\",\n\t\t\tQPATH + \"testquest.json\",\n\t\t\tQPATH + \"triggerquest.json\"\n\t\t];\n\n\t\tthis.loader.loadDataFiles(QUESTS, function (quests: object) {\n\t\t\tloader.setData(\"quests\", quests, callback);\n\t\t});\n\n\t}\n\n\tsetData(key: string, data: any, completer: Function): void {\n\t\tthis.dataset[key] = data;\n\n\t\tlet has_all = true;\n\t\tfor (let datakey of Object.keys(this.dataset)) {\n\t\t\tif (this.dataset[datakey] == null) {\n\t\t\t\thas_all = false;\n\t\t\t}\n\t\t}\n\n\t\tif (has_all) {\n\t\t\t// completer(this);\n\t\t\tthis.createGameInstance(completer);\n\t\t}\n\t}\n\n\tcreateGameInstance(completer: Function): void {\n\t\tlet game = new WanderGame(new ResLoader(this.http));\n\n\t\tconsole.log(\"loaded terrain\", this.dataset[\"terrain\"]);\n\t\tconsole.log(\"loaded locs\", this.dataset[\"locs\"]);\n\t\tconsole.log(\"loaded player\", this.dataset[\"player\"]);\n\t\tconsole.log(\"loaded quests: \", this.dataset[\"quests\"]);\n\n\n\t\tlet worldmap = WorldMap.fromJSON(this.dataset[\"terrain\"], this.dataset[\"locs\"]);\n\t\tlet hero = WanderHero.fromJSON(this.dataset[\"player\"]);\n\t\tlet skillsys = SimpleSkillSystem.fromJSON(this.dataset[\"skillsys\"]);\n\t\tgame.setWorldMap(worldmap);\n\t\tgame.setHero(hero);\n\t\tgame.setWorldMeta(this.dataset[\"worldmeta\"]);\n\t\tgame.setSkillSystem(skillsys);\n\n\t\tfor (let questfile in this.dataset[\"quests\"])\n\t\t{\n\t\t\tlet qref = QuestRef.fromJSON(this.dataset[\"quests\"][questfile], questfile);\n\t\t\tconsole.log(\"created from \", questfile, \"questref \", qref);\n\t\t\t// let quest = Quest.fromJSON(this.dataset[\"quests\"][questfile]);\n\t\t\t// console.log(\"created from \", questfile, \" quest object \", quest);\n\t\t\tgame.addQuest(qref);\n\t\t}\n\n\n\t\tcompleter(game, this);\n\n\t}\n\n\n\n}\n","import {WorldPosition} from \"./world/world-position\";\nimport {AgentEntity} from \"./skill-system/agent-entity\";\nimport {SimpleSkillSet} from \"./skill-system/simple-skill-set\";\n\nexport class WanderHero implements AgentEntity\n{\n\n\tpos: WorldPosition;\n\tlocpos: object;\n\tskills: SimpleSkillSet;\n\n\tmaxhealth: number;\n\thealth: number;\n\n\tconstructor ()\n\t{\n\t\tthis.pos = null;\n\t\tthis.locpos = null;\n\t\tthis.skills = new SimpleSkillSet();\n\t}\n\n\tstatic fromJSON (src: object): WanderHero\n\t{\n\t\tlet hero = new WanderHero();\n\n\t\thero.setCoordinates(WorldPosition.fromCoordsArray(src[\"position\"][\"coords\"]));\n\n\t\tfor (let potential in src[\"record\"][\"potentials\"])\n\t\t{\n\t\t\tlet range = src[\"record\"][\"potentials\"][potential];\n\t\t\tlet value = Math.round(Math.random()*range[1]-range[0])+(range[1]-range[0]);\n\t\t\thero.skills.registerPotential(potential, value);\n\t\t}\n\n\t\tfor (let development in src[\"record\"][\"developments\"])\n\t\t{\n\t\t\tlet range = src[\"record\"][\"developments\"][development];\n\t\t\tlet value = Math.round(Math.random()*range[1]-range[0])+(range[1]-range[0]);\n\t\t\thero.skills.registerDevelopment(development, value);\n\t\t}\n\n\t\tlet range = src[\"record\"][\"health\"];\n\t\thero.maxhealth = Math.round(Math.random()*range[1]-range[0])+(range[1]-range[0]);\n\t\thero.health = hero.maxhealth;\n\n\t\treturn hero;\n\n\t}\n\n\tsetCoordinates (pos: WorldPosition)\n\t{\n\t\t// console.log(\"replacing coords\", this.pos, \"w pos \", pos);\n\t\tthis.pos = pos;\n\t}\n\n\n\tgetSkills(): SimpleSkillSet {\n\t\treturn this.skills;\n\t}\n\n}\n","import {WanderGame} from \"./wander-game\";\nimport {QuestTask} from \"./quests/quest-task\";\nimport {MetaScene} from \"./scenes/meta-scene\";\n\nexport abstract class WanderScene\n{\n\n\tstatic LEAVESTATE_UNFINISHED = -1;\n\tstatic LEAVESTATE_FINISHED = 0;\n\n\tgame: WanderGame;\n\t// a scene that CONTAINS the current scene, if applicable, so the Storyteller will know what scene to pass to when this ends.\n\tnarrative: MetaScene;\n\n\t// TODO: add interface for specific scene UI (not the SceneUI master wrapper) so the Scene can interact with its own display\n\tleaf: any;\n\n\t// TODO: add QuestTask class as driver for the scene\n\tdriver: QuestTask;\n\n\tscenePosition: object;\n\n\tprotected constructor (game: WanderGame)\n\t{\n\t\tthis.game = game;\n\n\t\t// narrative should be set outside the constructor\n\t\tthis.narrative = null;\n\n\t\t// TODO: TBA (note: should get value AFTER constructor anyway?)\n\t\tthis.leaf = null;\n\t\tthis.driver = null;\n\n\t}\n\n\tsetNarrative (narrative: MetaScene)\n\t{\n\t\tthis.narrative = narrative;\n\t}\n\n\tgetNarrative (): WanderScene\n\t{\n\t\treturn this.narrative;\n\t}\n\n\tabstract sceneFinished(): boolean;\n\n\t/**\n\t * Acts as default, subclasses can override if they have specific return codes > 0 (for success and < -1 for failure?)\n\t * If the scene is unfinished, subclasses should still respect the UNFINISHED constant\n\t */\n\treturnState(): number\n\t{\n\t\t// Scenes that do not have a set of return values always return 0 on end OR -1 if not finished\n\t\treturn this.sceneFinished() ? WanderScene.LEAVESTATE_FINISHED : WanderScene.LEAVESTATE_UNFINISHED;\n\t}\n\n\t/**\n\t * Acts as default, subclasses can override if they chain to a scene they create\n\t */\n\tgetFollowingScene (): WanderScene\n\t{\n\t\treturn this.narrative;\n\t}\n\n\tstatic fromJSON (src: object): WanderScene\n\t{\n\t\t// TODO: placeholder, implement for all the scenes that can be JSON-generated\n\n\t\treturn null;\n\t}\n}\n\n/**\n * Wrapper for Map type for syntactical cleanup\n */\nexport class LeaveStatesMap extends Map<string, number> {}\n","import {WorldPosition} from \"../world-position\";\n\nexport class Place\n{\n\n\tpos: WorldPosition;\n\n\tlocid: string;\n\tloctype: string;\n\tname: string;\n\n\tconstructor (pos: WorldPosition)\n\t{\n\t\tthis.pos = pos;\n\t}\n\n\t// public abstract getName (): string;\n\n\tpublic getCoords (): number[]\n\t{\n\t\treturn this.pos.getCoords();\n\t}\n\n\tpublic matchesPosition (pos: WorldPosition): boolean\n\t{\n\t\treturn this.pos.matches(pos);\n\t}\n\n\n}\n\n","import {Town} from \"./Town\";\nimport {TerrainPass} from \"./TerrainPass\";\nimport {Place} from \"./Place\";\n\nexport class PlaceFactory\n{\n\tstatic CLASSES = {\n\t\t\"towns\": Town,\n\t\t\"passes\": TerrainPass\n\t};\n\n\tstatic fromJSON (placetype: string, placeid: string, src: object): Place\n\t{\n\t\tlet builderclass = PlaceFactory.CLASSES[placetype];\n\t\treturn builderclass.fromJSON(placeid, src);\n\t}\n}\n","import {Place} from \"./Place\";\nimport {WorldPosition} from \"../world-position\";\n\nexport class TerrainPass extends Place\n{\n\texitpoint: WorldPosition;\n\tcourse: string[];\n\n\tconstructor(locid: string, entrypos: WorldPosition, exitpos: WorldPosition, course: string[]) {\n\t\tsuper(entrypos);\n\t\tthis.loctype = \"passes\";\n\t\tthis.locid = locid;\n\t\tthis.exitpoint = exitpos;\n\t\tthis.course = course;\n\t}\n\n\tlength (): number\n\t{\n\t\treturn this.course.length;\n\t}\n\n\tstatic fromJSON (placeid: string, desc: object): TerrainPass\n\t{\n\t\tlet entrypoint = desc[\"entry\"];\n\t\tlet exitpoint = desc[\"exit\"];\n\t\tlet course = desc[\"sequence\"];\n\n\t\tlet loaded = new TerrainPass (placeid, new WorldPosition(entrypoint[0], entrypoint[1]), new WorldPosition(exitpoint[0], exitpoint[1]), course);\n\t\tloaded.name = desc[\"name\"];\n\n\t\treturn loaded;\n\t}\n\n\tmatchesPosition(pos: WorldPosition): boolean {\n\t\treturn this.pos.matches(pos) || this.exitpoint.matches(pos);\n\t}\n\n}\n","import {Place} from \"./Place\";\nimport {WorldPosition} from \"../world-position\";\n\nexport class Town extends Place\n{\n\n\tconstructor (locid: string, coords: WorldPosition)\n\t{\n\t\tsuper(coords);\n\t\tthis.loctype = \"towns\";\n\t\tthis.locid = locid;\n\t}\n\n\n\tstatic fromJSON (placeid: string, desc: object): Town\n\t{\n\t\tlet coords = desc[\"coords\"];\n\t\tlet loaded = new Town (placeid, new WorldPosition(coords[0], coords[1]));\n\t\tloaded.name = desc[\"name\"];\n\n\t\treturn loaded;\n\t}\n}\n","import {Place} from \"./locs/Place\";\nimport {TerrainPass} from \"./locs/TerrainPass\";\nimport {PlaceFactory} from \"./locs/PlaceFactory\";\nimport {WorldPosition} from \"./world-position\";\n\nexport class WorldMap {\n\n\tsizeX: number;\n\tsizeY: number;\n\n\tlocs: Place[][];\n\tterrain: string[][];\n\t// places_bycoords: any;\n\tplaces_bytypebyid: Map<string, Map<string, Place>>;\n\n\n\tconstructor(sizeX, sizeY) {\n\t\tthis.sizeX = sizeX;\n\t\tthis.sizeY = sizeY;\n\n\t\tthis.locs = [];\n\t\tthis.terrain = [];\n\t\tfor (let x = 0; x < sizeX; x++) {\n\t\t\tlet tercol = [];\n\t\t\tlet loccol = [];\n\t\t\tfor (let y = 0; y < sizeY; y++) {\n\t\t\t\ttercol.push(null);\n\t\t\t\tloccol.push(null);\n\t\t\t}\n\t\t\tthis.terrain.push(tercol);\n\t\t\tthis.locs.push(loccol);\n\t\t}\n\n\t\tthis.places_bytypebyid = new Map<string, Map<string, Place>>();\n\n\t}\n\n\n\tstatic getCoordsHash(coordX, coordY): String {\n\t\treturn coordX + \":\" + coordY;\n\t}\n\n\n\tstatic fromJSON(griddata, locationdata): WorldMap {\n\t\t// console.log(griddata);\n\t\tlet gridsizeX = griddata[\"mapgrid\"].length;\n\t\tlet gridsizeY = griddata[\"mapgrid\"][0].length;\n\t\tlet worldmap = new WorldMap(gridsizeX, gridsizeY);\n\t\t// console.log(worldmap.terrain);\n\t\tfor (let x = 0; x < gridsizeX; x++) {\n\t\t\tfor (let y = 0; y < gridsizeY; y++) {\n\t\t\t\tworldmap.terrain[x][y] = griddata[\"mapgrid\"][x][y];\n\t\t\t}\n\t\t}\n\n\n\t\t// loop not technically needed but we might want to run generations etc on data in the future\n\t\t// TODO : replace\n\t\tfor (let placetype of Object.keys(locationdata)) {\n\t\t\tlet places = locationdata[placetype];\n\t\t\tlet listed = new Map<string, Place>();\n\t\t\tfor (let placeid of Object.keys(places)) {\n\n\t\t\t\tlet placedesc = places[placeid];\n\t\t\t\tlet place = PlaceFactory.fromJSON(placetype, placeid, placedesc);\n\t\t\t\t// let place = new Place(Position.fromCoords(placedesc[\"coords\"]));\n\t\t\t\t// place.loctype = placetype;\n\t\t\t\t// place.locid = placeid;\n\t\t\t\tlisted.set(placeid, place);\n\t\t\t\t// console.log(\"adding place\", placetype, placedesc);\n\t\t\t\tlet coords;\n\t\t\t\tworldmap.locs[place.pos.x][place.pos.y] = place;\n\t\t\t\tif (place instanceof TerrainPass)\n\t\t\t\t{\n\t\t\t\t\tlet exitpos = (place as TerrainPass).exitpoint;\n\t\t\t\t\tworldmap.locs[exitpos.x][exitpos.y] = place;\n\t\t\t\t}\n\t\t\t}\n\t\t\tworldmap.places_bytypebyid.set(placetype, listed);\n\n\t\t}\n\n\t\treturn worldmap;\n\t}\n\n\tgetLocationById (locid: string): Place\n\t{\n\t\tfor (let places_byid of this.places_bytypebyid.values())\n\t\t{\n\t\t\tif (places_byid.has(locid))\n\t\t\t{\n\t\t\t\treturn places_byid.get(locid);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetAllLocations(): Place[]\n\t{\n\t\tlet listing = [];\n\t\tfor (let placetype of this.places_bytypebyid.keys())\n\t\t{\n\t\t\t// console.log(\"getting loctype \", loctype, this.places[loctype]);\n\t\t\tfor (let loc of this.places_bytypebyid.get(placetype).values())\n\t\t\t{\n\t\t\t\tlisting.push(loc);\n\t\t\t}\n\t\t}\n\t\t// console.log(\"all locations: \", listing);\n\t\treturn listing;\n\t}\n\n\n\tgetLocationAt (coords: number[]): Place\n\t{\n\t\tlet loc = null;\n\t\ttry\n\t\t{\n\t\t\tloc = this.locs[coords[0]][coords[1]];\n\t\t} catch (err) {\n\t\t\t// return null;\n\t\t}\n\n\t\t// console.log(\"found loc \", loc);\n\t\t// TODO: DEBUG ONLY!\n\t\t// loc = null;\n\t\treturn loc;\n\n\n\t\t/*\n\t\tvar coordhash = WorldMap.getCoordsHash(coordX, coordY);\n\t\t// TODO: optimize so we don't go through the whole places data\n\t\tfor (var placetype in this.places)\n\t\t{\n\t\t\tfor (var placeid in this.places[placetype])\n\t\t\t{\n\t\t\t\tvar placecoords = this.places[placetype][placeid][\"coords\"];\n\t\t\t\tif (WorldMap.getCoordsHash(placecoords[0], placecoords[1])==coordhash)\n\t\t\t\t{\n\t\t\t\t\treturn this.places[placetype][placeid];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t\t*/\n\n\t}\n\n\tgetCourse (cfrom: WorldPosition, cto: WorldPosition): WorldPosition[]\n\t{\n\t\t// TODO: straight course for now\n\n\t\tlet distX = cto.x - cfrom.x;\n\t\tlet distY = cto.y - cfrom.y;\n\t\tlet maxdist = Math.max(Math.abs(distX), Math.abs(distY));\n\n\t\tlet course = [];\n\t\tfor (let i = 0; i < maxdist; i++)\n\t\t{\n\t\t\tlet section = i / maxdist;\n\t\t\tlet sectionX = Math.round(distX * section);\n\t\t\tlet sectionY = Math.round(distY * section);\n\t\t\tcourse.push(new WorldPosition(cfrom.x + sectionX, cfrom.y + sectionY));\n\t\t}\n\n\t\tconsole.log(\"course from \", cfrom, \" to \", cto, \": \" + course.length + \" steps (\", course, \")\");\n\n\t\treturn course;\n\t}\n\n\tgetTerrainAt (x, y)\n\t{\n\t\ttry\n\t\t{\n\t\t\treturn this.terrain[x][y];\n\t\t} catch (err)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t}\n\n}\n\n","export class WorldPosition\n{\n\n\treadonly x: number;\n\treadonly y: number;\n\n\tconstructor (x: number, y: number)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tstatic fromCoordsArray (coords: number[]): WorldPosition\n\t{\n\t\treturn new WorldPosition(coords[0], coords[1]);\n\t}\n\n\tpublic getCoords (): number[]\n\t{\n\t\treturn [this.x, this.y];\n\t}\n\n\tpublic getShifted (x: number, y: number)\n\t{\n\t\treturn new WorldPosition(this.x + x, this.y + y);\n\t}\n\n\tpublic matches (other: WorldPosition)\n\t{\n\t\tconsole.log(\"checking if we have a match between \", this, \"and\", other);\n\t\treturn this.x === other.x && this.y === other.y;\n\t}\n\n\tstatic getRelativeGeneralDirection (pfrom: WorldPosition, pto: WorldPosition): number[]\n\t{\n\t\tconst distX = pto.x - pfrom.x;\n\t\tconst distY = pto.y - pfrom.y;\n\n\t\tlet dirX = 0;\n\t\tlet dirY = 0;\n\t\tif (distX === 0)\n\t\t{\n\t\t\tdirX = 0;\n\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t}\n\t\telse if (distY === 0)\n\t\t{\n\t\t\tdirY = 0;\n\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet absX = Math.abs(distX);\n\t\t\tlet absY = Math.abs(distY);\n\t\t\tif (absY > 3 * absY)\n\t\t\t{\n\t\t\t\tdirX = 0;\n\t\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t\t}\n\t\t\telse if (absY * 3 < absX) {\n\t\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t\t\tdirY = 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdirX = distX > 0 ? 1 : -1;\n\t\t\t\tdirY = distY > 0 ? 1 : -1;\n\t\t\t}\n\t\t}\n\n\t\treturn [dirX, dirY];\n\t}\n}\n","import {Directive, ViewContainerRef} from '@angular/core';\n\n@Directive({\n\tselector: '[appInsertion]',\n})\nexport class InsertionDirective {\n\tconstructor(public viewContainerRef: ViewContainerRef) {\n\t}\n}\n","import { Injector, Type, InjectionToken, InjectFlags } from '@angular/core';\n\nexport class SceneInjector implements Injector {\n\tconstructor(\n\t\tprivate _parentInjector: Injector,\n\t\tprivate _additionalTokens: WeakMap<any, any>)\n\t{\n\t}\n\n\tget<T>(\n\t\ttoken: Type<T> | InjectionToken<T>,\n\t\tnotFoundValue?: T,\n\t\tflags?: InjectFlags\n\t): T;\n\n\tget(token: any, notFoundValue?: any);\n\tget(token: any, notFoundValue?: any, flags?: any) {\n\n\t\tconst value = this._additionalTokens.get(token);\n\t\tif (value)\n\t\t{\n\t\t\treturn value;\n\t\t}\n\t\treturn this._parentInjector.get<any>(token, notFoundValue);\n\t}\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {WanderGame} from \"../rpg-engine/wander-game\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\n\nexport class SceneRef {\n\n\tprivate readonly _afterClosed = new Subject<any>();\n\tafterClosed: Observable<any> = this._afterClosed.asObservable();\n\n\tprivate readonly _sceneCheck = new Subject<any>();\n\tsceneCheck: Observable<any> = this._sceneCheck.asObservable();\n\n\tprivate readonly _subSwitch = new Subject<WanderScene>();\n\tsubSwitch: Observable<any> = this._subSwitch.asObservable();\n\t\n\tscene: WanderScene;\n\tgame: WanderGame;\n\n\tconstructor() {\n\t}\n\n\tsetContext (scene: WanderScene)\n\t{\n\t\tthis.scene = scene;\n\t\tthis.game = scene.game;\n\t}\n\n\tclose(result?: any) {\n\t\tthis._afterClosed.next(result);\n\t}\n\n\ttriggerSceneCheck ()\n\t{\n\t\tconsole.log(\"sending check event for scene \", this.scene, this.scene.sceneFinished());\n\t\tthis._sceneCheck.next();\n\t}\n\n\ttriggerSubScene (scene: WanderScene)\n\t{\n\t\tthis._subSwitch.next(scene);\n\t}\n\n\n}\n","export default \".uiwrapper {\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  background: transparent;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n#gamecontrols {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  text-align: right;\\n  border-bottom: 1px solid black;\\n  border-left: 1px solid black;\\n  border-bottom-left-radius: 8px;\\n  padding: 4px 8px 4px 16px;\\n  background-image: url(\\\"/assets/ui/temporaryparchment.jpg\\\");\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3NjZW5lLXVpL3NjZW5lLXVpLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zY2VuZS11aS9zY2VuZS11aS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsU0FBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FDQ0Y7O0FER0E7RUFFRSxlQUFBO0VBQ0EsTUFBQTtFQUNBLFFBQUE7RUFDQSxpQkFBQTtFQUNBLDhCQUFBO0VBQ0EsNEJBQUE7RUFDQSw4QkFBQTtFQUNBLHlCQUFBO0VBQ0QsMERBQUE7QUNERCIsImZpbGUiOiJzcmMvYXBwL3NjZW5lLXVpL3NjZW5lLXVpLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnVpd3JhcHBlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgdG9wOiAwO1xuICBib3R0b206IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cblxuI2dhbWVjb250cm9sc1xue1xuICBwb3NpdGlvbjogICBmaXhlZDtcbiAgdG9wOiAgICAgICAgMDtcbiAgcmlnaHQ6ICAgICAgMDtcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIGJvcmRlci1ib3R0b206ICAgICAxcHggc29saWQgYmxhY2s7XG4gIGJvcmRlci1sZWZ0OiAgICAgMXB4IHNvbGlkIGJsYWNrO1xuICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiA4cHg7XG4gIHBhZGRpbmc6ICAgICAgNHB4IDhweCA0cHggMTZweDtcblx0YmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xuXG4gIC8vIHotaW5kZXg6XHRcdDk5OTk5OTk7XG59XG4iLCIudWl3cmFwcGVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbn1cblxuI2dhbWVjb250cm9scyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgdG9wOiAwO1xuICByaWdodDogMDtcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCBibGFjaztcbiAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCBibGFjaztcbiAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogOHB4O1xuICBwYWRkaW5nOiA0cHggOHB4IDRweCAxNnB4O1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIvYXNzZXRzL3VpL3RlbXBvcmFyeXBhcmNobWVudC5qcGdcIik7XG59Il19 */\"","import {\n\tAfterViewInit, ChangeDetectorRef,\n\tComponent,\n\tComponentFactoryResolver,\n\tComponentRef, EventEmitter,\n\tOnDestroy, Output,\n\tType,\n\tViewChild\n} from '@angular/core';\nimport {Subject} from \"rxjs\";\nimport {InsertionDirective} from \"./insertion.directive\";\nimport { StorytellerComponent } from '../storyteller/storyteller.component';\n\n/**\n * Holder component for {@link SceneRenderer} objects.\n * Is instantiated by {@link SceneUIService} for {@link StorytellerComponent} and injected with the chosen renderer.\n */\n@Component({\n\tselector: 'app-scene-ui',\n\ttemplateUrl: './scene-ui.component.html',\n\tstyleUrls: ['./scene-ui.component.scss']\n})\nexport class SceneUIComponent implements AfterViewInit, OnDestroy {\n\n\tprivate readonly _onClose = new Subject<any>();\n\n\tpublic componentRef: ComponentRef<any>;\n\tpublic childComponentType: Type<any>;\n\tpublic onClose = this._onClose.asObservable();\n\n\tpublic controller: StorytellerComponent;\n\n\t@ViewChild(InsertionDirective, {static: false}) insertionPoint: InsertionDirective;\n\n\tconstructor(private componentFactoryResolver: ComponentFactoryResolver, private cd: ChangeDetectorRef)\n\t{\n\n\n\t}\n\n\t// LIFECYCLE\n\n\t// note: ngOnInit not strictly necessary for this use\n\t// ngOnInit() {\n\t// }\n\n\tngAfterViewInit(): void {\n\t\tthis.loadChildComponent(this.childComponentType);\n\t\tthis.cd.detectChanges();\n\t}\n\n\tngOnDestroy(): void {\n\t\tif (this.componentRef) {\n\t\t\tthis.componentRef.destroy();\n\t\t}\n\t}\n\n\t// child loading\n\n\tloadChildComponent(componentType: Type<any>) {\n\t\tlet componentFactory = this.componentFactoryResolver.resolveComponentFactory(componentType);\n\n\t\tlet viewContainerRef = this.insertionPoint.viewContainerRef;\n\t\tviewContainerRef.clear();\n\n\t\tthis.componentRef = viewContainerRef.createComponent(componentFactory);\n\t}\n\n\t// for dialog-like behaviour, revise\n\n\tonOverlayClicked(evt: MouseEvent) {\n\t\t// close the scene\n\t\tconsole.warn(\"on overlay click\");\n\t\t// console.log(\"closing sceneref\");\n\t\t// console.log(\"removing \", this.componentRef);\n\t\t// this.componentRef.destroy();\n\t}\n\n\tonDialogClicked(evt: MouseEvent) {\n\t\tevt.stopPropagation();\n\t}\n\n\n\tdoSaveGame ()\n\t{\n\t\tconsole.log(\"Saving game state... to outer Storyteller\", this.controller);\n\t\t// WanderGameState.saveToBrowser(this.game);\n\t\tthis.controller.doSaveGame();\n\t}\n\n\tdoLoadGame ()\n\t{\n\t\tconsole.log(\"Loading game state... to outer Storyteller\", this.controller);\n\t\tthis.controller.doLoadGame();\n\t}\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { InsertionDirective } from './insertion.directive';\nimport {SceneUIComponent} from \"./scene-ui.component\";\n\n\n\n@NgModule({\n\timports: [CommonModule],\n\tdeclarations: [SceneUIComponent, InsertionDirective],\n\tentryComponents: [SceneUIComponent],\n})\nexport class SceneUIModule { }\n","import {\n\tApplicationRef,\n\tComponentFactoryResolver,\n\tComponentRef,\n\tEmbeddedViewRef,\n\tInjectable,\n\tInjector, Type\n} from '@angular/core';\nimport {SceneUIComponent} from \"./scene-ui.component\";\nimport {SceneRef} from \"./scene-ref\";\nimport {SceneInjector} from \"./scene-injector\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\nimport {SceneRenderer} from \"../storyteller/scenes/scene-renderer\";\nimport {StorytellerComponent} from \"../storyteller/storyteller.component\";\nimport {StorytellerInterface} from \"../storyteller/storyteller-interface\";\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SceneUIService {\n\n\tsceneRef: ComponentRef<SceneUIComponent>;\n\tprivate stref: StorytellerInterface;\n\n\tconstructor(\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver,\n\t\tprivate appRef: ApplicationRef,\n\t\tprivate injector: Injector) {\n\t}\n\n\tpublic bindStoryTellerUI (stref: StorytellerInterface)\n\t{\n\t\tthis.stref = stref;\n\t}\n\n\tpublic open(componentType: Type<SceneRenderer>, scene: WanderScene): SceneRef\n\t{\n\t\tlet sceneref = this.appendSceneUI(scene);\n\t\tthis.sceneRef.instance.childComponentType = componentType;\n\t\treturn sceneref;\n\t}\n\n\tprivate appendSceneUI (scene: WanderScene): SceneRef\n\t{\n\n\t\tconst map = new WeakMap();\n\t\t// map.set(DialogConfig, config);\n\n\t\t// add the DialogRef to dependency injection\n\t\tconst sceneRef = new SceneRef();\n\t\tsceneRef.setContext(scene);\n\t\tmap.set(SceneRef, sceneRef);\n\t\tmap.set(StorytellerInterface, this.stref);\n\n\t\t// we want to know when somebody called the close mehtod\n\t\tconst sub = sceneRef.afterClosed.subscribe(() => {\n\t\t\t// close the dialog\n\t\t\tconsole.log(\"running AFTERCLOSE\");\n\t\t\tthis.removeSceneUI();\n\t\t\tsub.unsubscribe();\n\n\t\t\tconsole.log(\"getting follower scene \", scene.getFollowingScene());\n\t\t\tthis.stref.checkUpdateSceneRender();\n\t\t});\n\n\t\tconst checksub = sceneRef.sceneCheck.subscribe(() => {\n\t\t\tconsole.log(\"running SCENECHECK on scene \", scene);\n\t\t\tif (scene.sceneFinished())\n\t\t\t{\n\t\t\t\tconsole.log(\"scene IS finished!\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.log(\"scene NOT finished\");\n\t\t\t}\n\t\t\tif (scene.sceneFinished())\n\t\t\t{\n\t\t\t\tsceneRef.close();\n\t\t\t}\n\t\t});\n\n\t\tconst componentFactory = this.componentFactoryResolver.resolveComponentFactory(SceneUIComponent);\n\t\tconsole.warn(\"istancing sceneUI: component factory\", componentFactory, \"params map\", map);\n\t\tconst sceneInject = new SceneInjector(this.injector, map);\n\t\tconst componentRef = componentFactory.create(sceneInject);\n\t\tconsole.warn(\"used injector \", sceneInject, \" to add component\", componentRef, \"w hostview\", componentRef.hostView);\n\n\t\tthis.appRef.attachView(componentRef.hostView);\n\n\t\tconst domElem = (componentRef.hostView as EmbeddedViewRef<any>).rootNodes[0] as HTMLElement;\n\t\tdocument.body.appendChild(domElem);\n\n\t\tthis.sceneRef = componentRef;\n\t\tconsole.log(\"SceneUI.sceneRef: \", this.sceneRef);\n\t\tconsole.log(\"SceneUI.sceneRef.instance: \", this.sceneRef.instance);\n\n\t\t(this.sceneRef.instance as SceneUIComponent).controller = this.stref.getStoryteller();\n\n\t\tconsole.log(\"SceneUI.sceneRef.childCompo: \", this.sceneRef.instance.componentRef);\n\t\tthis.sceneRef.instance.onClose.subscribe(() => {\n\t\t\tconsole.log(\"running ONCLOSE\");\n\t\t\tthis.removeSceneUI();\n\t\t\t// console.log(\"getting follower scene \", scene.getFollowingScene());\n\t\t\t// this.storyteller.checkUpdateSceneRender();\n\t\t});\n\n\t\t// return the dialogRef\n\t\treturn sceneRef;\n\n\t}\n\n\tpublic removeSceneUI () {\n\t\tconsole.log(\"removing scene ref \", this.sceneRef);\n\t\tthis.appRef.detachView(this.sceneRef.hostView);\n\t\tthis.sceneRef.destroy();\n\t}\n}\n","export default \".scenescreen {\\n  background-color: darkseagreen;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ibHVlLXNjcmVlbi90ZXN0LWJsdWUtc2NyZWVuLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3QtYmx1ZS1zY3JlZW4vdGVzdC1ibHVlLXNjcmVlbi5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLDhCQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3QtYmx1ZS1zY3JlZW4vdGVzdC1ibHVlLXNjcmVlbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zY2VuZXNjcmVlblxue1xuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRcdGRhcmtzZWFncmVlbjtcbn1cbiIsIi5zY2VuZXNjcmVlbiB7XG4gIGJhY2tncm91bmQtY29sb3I6IGRhcmtzZWFncmVlbjtcbn0iXX0= */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneUIComponent} from \"../../../scene-ui/scene-ui.component\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {TestScreenGenericComponent} from \"../test-screen-generic/test-screen-generic.component\";\nimport {StorytellerInterface} from \"../../../storyteller/storyteller-interface\";\n\n@Component({\n\tselector: 'app-test-blue-screen',\n\ttemplateUrl: './test-blue-screen.component.html',\n\tstyleUrls: ['../test-screen-generic/test-screen-generic.component.scss', './test-blue-screen.component.scss']\n})\nexport class TestBlueScreenComponent extends TestScreenGenericComponent implements OnInit {\n\n\tconstructor(public sceneref: SceneRef, sti: StorytellerInterface = null) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE BLUE');\n\t}\n\n}\n","export default \".scenescreen {\\n  background-color: lightsteelblue;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ncmVlbi1zY3JlZW4vdGVzdC1ncmVlbi1zY3JlZW4uY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1ncmVlbi1zY3JlZW4vdGVzdC1ncmVlbi1zY3JlZW4uY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyxnQ0FBQTtBQ0FEIiwiZmlsZSI6InNyYy9hcHAvc3RvcnktdGVzdGVyL3NjZW5lcy90ZXN0LWdyZWVuLXNjcmVlbi90ZXN0LWdyZWVuLXNjcmVlbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5zY2VuZXNjcmVlblxue1xuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRcdGxpZ2h0c3RlZWxibHVlO1xufVxuIiwiLnNjZW5lc2NyZWVuIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRzdGVlbGJsdWU7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {TestScreenGenericComponent} from \"../test-screen-generic/test-screen-generic.component\";\nimport {StorytellerInterface} from \"../../../storyteller/storyteller-interface\";\n\n@Component({\n\tselector: 'app-test-green-screen',\n\ttemplateUrl: './test-green-screen.component.html',\n\tstyleUrls: ['../test-screen-generic/test-screen-generic.component.scss', './test-green-screen.component.scss']\n})\nexport class TestGreenScreenComponent extends TestScreenGenericComponent implements OnInit {\n\n\tconstructor(public sceneref: SceneRef, sti: StorytellerInterface = null)\n\t{\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE GREEN');\n\t}\n\n\n}\n","export default \".overlay {\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  background: rgba(0, 0, 0, 0.7);\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.dialog {\\n  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);\\n  background-color: white;\\n  width: 50%;\\n  height: 50%;\\n  display: flex;\\n  flex-direction: column;\\n  padding: 8px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zY2VuZXMvdGVzdC1zY3JlZW4tZ2VuZXJpYy90ZXN0LXNjcmVlbi1nZW5lcmljLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3Qtc2NyZWVuLWdlbmVyaWMvdGVzdC1zY3JlZW4tZ2VuZXJpYy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsU0FBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FDQ0Y7O0FERUE7RUFDRSw0RUFBQTtFQUNBLHVCQUFBO0VBQ0EsVUFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxZQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9zdG9yeS10ZXN0ZXIvc2NlbmVzL3Rlc3Qtc2NyZWVuLWdlbmVyaWMvdGVzdC1zY3JlZW4tZ2VuZXJpYy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5vdmVybGF5IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC43KTtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5kaWFsb2cge1xuICBib3gtc2hhZG93OiAwIDE0cHggMjhweCByZ2JhKDAsIDAsIDAsIDAuMjUpLCAwIDEwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMjIpO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgd2lkdGg6IDUwJTtcbiAgaGVpZ2h0OiA1MCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBhZGRpbmc6IDhweDtcbn1cbiIsIi5vdmVybGF5IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGJvdHRvbTogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC43KTtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbi5kaWFsb2cge1xuICBib3gtc2hhZG93OiAwIDE0cHggMjhweCByZ2JhKDAsIDAsIDAsIDAuMjUpLCAwIDEwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMjIpO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgd2lkdGg6IDUwJTtcbiAgaGVpZ2h0OiA1MCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIHBhZGRpbmc6IDhweDtcbn0iXX0= */\"","import {Component, OnInit} from '@angular/core';\nimport {StorytellerInterface} from \"../../../storyteller/storyteller-interface\";\n\n// @Component({\n// \tselector: 'app-test-screen-generic',\n// \ttemplateUrl: './test-screen-generic.component.html',\n// \tstyleUrls: ['./test-screen-generic.component.scss']\n// })\nexport abstract class TestScreenGenericComponent implements OnInit {\n\n\tstint: StorytellerInterface = null;\n\n\tconstructor() {\n\t}\n\n\tngOnInit() {\n\t}\n\n}\n","export default \"#storyteller-outside {\\n  background-color: #9a93ff;\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#storyteller-tester {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 8px;\\n  /*background-color:\\t\\tlightgreen;*/\\n  background-image: url(\\\"/assets/ui/temporaryparchment.jpg\\\");\\n}\\n\\n#scenerender-test {\\n  background-color: grey;\\n  width: 200px;\\n  height: 300px;\\n  border: 2px solid white;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5LXRlc3Rlci9zdG9yeS10ZXN0ZXIuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5LXRlc3Rlci9zdG9yeS10ZXN0ZXIuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyx5QkFBQTtFQUNBLGVBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0FDQUQ7O0FESUE7RUFFQyxlQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLGlDQUFBO0VBQ0EsMERBQUE7QUNGRDs7QURPQTtFQUdDLHNCQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSx1QkFBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3RvcnktdGVzdGVyL3N0b3J5LXRlc3Rlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiNzdG9yeXRlbGxlci1vdXRzaWRlXG57XG5cdGJhY2tncm91bmQtY29sb3I6ICM5YTkzZmY7XG5cdHBvc2l0aW9uOlx0XHRcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHRcdFx0MDtcblx0bGVmdDpcdFx0XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0XHRcdDA7XG5cdGJvdHRvbTpcdFx0XHRcdFx0MDtcbn1cblxuXG4jc3Rvcnl0ZWxsZXItdGVzdGVyXG57XG5cdHBvc2l0aW9uOlx0XHRcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHRcdFx0OHB4O1xuXHRsZWZ0Olx0XHRcdFx0XHQ4cHg7XG5cdHJpZ2h0Olx0XHRcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHRcdFx0OHB4O1xuXHQvKmJhY2tncm91bmQtY29sb3I6XHRcdGxpZ2h0Z3JlZW47Ki9cblx0YmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xuXG59XG5cblxuI3NjZW5lcmVuZGVyLXRlc3RcbntcblxuXHRiYWNrZ3JvdW5kLWNvbG9yOlx0XHRncmV5O1xuXHR3aWR0aDpcdFx0XHRcdFx0MjAwcHg7XG5cdGhlaWdodDpcdFx0XHRcdFx0MzAwcHg7XG5cdGJvcmRlcjpcdFx0XHRcdFx0MnB4IHNvbGlkIHdoaXRlO1xufVxuXG5cbiIsIiNzdG9yeXRlbGxlci1vdXRzaWRlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzlhOTNmZjtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNzdG9yeXRlbGxlci10ZXN0ZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHRvcDogOHB4O1xuICBsZWZ0OiA4cHg7XG4gIHJpZ2h0OiA4cHg7XG4gIGJvdHRvbTogOHB4O1xuICAvKmJhY2tncm91bmQtY29sb3I6XHRcdGxpZ2h0Z3JlZW47Ki9cbiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiL2Fzc2V0cy91aS90ZW1wb3JhcnlwYXJjaG1lbnQuanBnXCIpO1xufVxuXG4jc2NlbmVyZW5kZXItdGVzdCB7XG4gIGJhY2tncm91bmQtY29sb3I6IGdyZXk7XG4gIHdpZHRoOiAyMDBweDtcbiAgaGVpZ2h0OiAzMDBweDtcbiAgYm9yZGVyOiAycHggc29saWQgd2hpdGU7XG59Il19 */\"","import {Component, OnInit} from '@angular/core';\nimport {SceneUIService} from \"../scene-ui/scene-ui.service\";\nimport {TestBlueScreenComponent} from \"./scenes/test-blue-screen/test-blue-screen.component\";\nimport {TestGreenScreenComponent} from \"./scenes/test-green-screen/test-green-screen.component\";\nimport {TesterScene} from \"./tester-scene\";\nimport {StorytellerInterface} from \"../storyteller/storyteller-interface\";\n\n@Component({\n\tselector: 'app-story-tester',\n\ttemplateUrl: './story-tester.component.html',\n\tstyleUrls: ['./story-tester.component.scss']\n})\nexport class StoryTesterComponent implements OnInit {\n\n\n\tconstructor(private sceneui: SceneUIService, sti: StorytellerInterface = null) {\n\t}\n\n\tngOnInit() {\n\t}\n\n\tloadBlueScreen() {\n\t\tlet scene = new TesterScene();\n\t\tlet ref = this.sceneui.open(TestBlueScreenComponent, scene);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\tconsole.log('Scene (BLUE) closed', result);\n\t\t});\n\t}\n\n\tloadGreenScreen() {\n\t\tlet scene = new TesterScene();\n\t\tlet ref = this.sceneui.open(TestGreenScreenComponent, scene);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\tconsole.log('Scene (GREEN) closed', result);\n\t\t});\n\t}\n}\n","import {WanderScene} from \"../rpg-engine/wander-scene\";\n\n/**\n * Empty scene object so test layouts can work without loading an actual game\n */\nexport class TesterScene extends WanderScene {\n\n\tconstructor ()\n\t{\n\t\tsuper(null);\n\t}\n\n\tsceneFinished(): boolean {\n\t\treturn false;\n\t}\n}\n","export default \"#journeyrender {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 30vh;\\n  border: 1px dashed black;\\n  overflow: auto;\\n}\\n\\n#viewrender {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#journeyinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 28vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\nbutton.journeychoice {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9qb3VybmV5LXN0ZXAvam91cm5leS1zdGVwLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvam91cm5leS1zdGVwL2pvdXJuZXktc3RlcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7RUFDQSxjQUFBO0FDQUQ7O0FER0E7RUFFQyxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7QUNERDs7QURJQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDSEQ7O0FET0E7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL2pvdXJuZXktc3RlcC9qb3VybmV5LXN0ZXAuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjam91cm5leXJlbmRlclxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cdGxlZnQ6XHRcdFx0OHB4O1xuXHRyaWdodDpcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHQzMHZoO1xuXHRib3JkZXI6XHRcdFx0MXB4IGRhc2hlZCBibGFjaztcblx0b3ZlcmZsb3c6XHRcdGF1dG87XG59XG5cbiN2aWV3cmVuZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblx0dG9wOlx0XHRcdDA7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG59XG5cbiNqb3VybmV5aW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQyOHZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuYnV0dG9uLmpvdXJuZXljaG9pY2Vcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cbiIsIiNqb3VybmV5cmVuZGVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDhweDtcbiAgbGVmdDogOHB4O1xuICByaWdodDogOHB4O1xuICBib3R0b206IDMwdmg7XG4gIGJvcmRlcjogMXB4IGRhc2hlZCBibGFjaztcbiAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbiN2aWV3cmVuZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNqb3VybmV5aW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiAyOHZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG5idXR0b24uam91cm5leWNob2ljZSB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICBwYWRkaW5nOiAycHQgOHB0O1xuICBmb250LXNpemU6IDR2aDtcbn0iXX0= */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {Journey} from \"../../../rpg-engine/scenes/journey\";\nimport {WalkRenderer} from \"../lib/walk-renderer\";\n\n@Component({\n\tselector: 'app-journey-step',\n\ttemplateUrl: './journey-step.component.html',\n\tstyleUrls: ['./journey-step.component.scss']\n})\nexport class JourneyStepComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"renderholder\", {static: false}) renderholder: ElementRef;\n\t@ViewChild(\"renderview\", {static: false}) renderview: ElementRef;\n\n\tjourneyscene: Journey;\n\tviewrenderer: WalkRenderer;\n\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.journeyscene = this.sceneref.scene as Journey;\n\t\tconsole.log(\"journey path: \", JSON.stringify(this.journeyscene.course));\n\t}\n\n\tngOnInit() {\n\n\t}\n\n\tngAfterViewInit(): void {\n\t\tthis.viewrenderer = new WalkRenderer(this.journeyscene.game.worldmap, this.renderview);\n\t\tlet ui = this;\n\t\tthis.viewrenderer.loadAssets(function ()\n\t\t{\n\t\t\tui.renderStep();\n\t\t});\n\t}\n\n\n\tsetCamp()\n\t{\n\t\tconsole.log(\"clicked SET CAMP\");\n\t}\n\n\tcontinueJourney()\n\t{\n\t\tconsole.log(\"clicked JOURNEY ONWARDs\");\n\n\t\tthis.journeyscene.step();\n\t\tthis.journeyscene.game.hero.setCoordinates(this.journeyscene.getCurrentCoordinates());\n\t\tif (!this.journeyscene.sceneFinished())\n\t\t{\n\t\t\tthis.renderStep();\n\t\t}\n\t\telse {\n\t\t\tthis.sceneref.triggerSceneCheck();\n\t\t}\n\n\n\t}\n\n\trenderStep ()\n\t{\n\t\tconst vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tthis.viewrenderer.renderView(this.journeyscene.getCurrentCoordinates(), vector);\n\t}\n\n\tshowMap()\n\t{\n\t\tconsole.log(\"clicked SHOW MAP\");\n\t}\n\n\tgetDirectionDescription (): string {\n\t\tlet vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tlet dirstring = \"\";\n\n\t\tif (vector[1] > 0) {\n\t\t\tdirstring += \"South\";\n\t\t} else if (vector[1] < 0) {\n\t\t\tdirstring += \"North\";\n\t\t}\n\t\tif (vector[0] > 0) {\n\t\t\tdirstring += \"East\";\n\t\t} else if (vector[0] < 0) {\n\t\t\tdirstring += \"West\";\n\t\t}\n\n\t\treturn dirstring;\n\t}\n\n\n\n\n\n\n\n\n}\n","import {ElementRef} from \"@angular/core\";\nimport Konva from \"konva\";\n\nexport class ArtRenderer {\n\n\trenderview: ElementRef;\n\n\n\tconstructor (target: ElementRef)\n\t{\n\t\tconsole.log(\"creating art renderer on element \", target);\n\t\tthis.renderview = target;\n\t}\n\n\tloadRenderImage (urlpath: string)\n\t{\n\t\tconsole.log(\"trying render on \", this.renderview, \"for\", urlpath);\n\t\tlet ui = this;\n\t\tlet imageObj = new Image();\n\t\timageObj.onload = function () {\n\t\t\t\tui.renderLoadedImage(imageObj);\n\t\t\t};\n\t\timageObj.src = urlpath;\n\t}\n\n\trenderLoadedImage (image: HTMLImageElement)\n\t{\n\t\tconst VPW = this.renderview.nativeElement.clientWidth;\n\t\tconst VPH = this.renderview.nativeElement.clientHeight;\n\n\t\tlet stage = new Konva.Stage({\n\t\t\tcontainer: this.renderview.nativeElement.id,\n\t\t\twidth: VPW,\n\t\t\theight: VPH,\n\t\t});\n\n\t\tlet composer = new Konva.Layer ({});\n\t\tstage.add(composer);\n\n\t\tlet widthratio = image.width / VPW;\n\t\tlet heightratio = image.height / VPH;\n\t\tlet ratio = Math.max(widthratio, heightratio);\n\n\t\tlet renderwidth = image.width / ratio;\n\t\tlet renderheight = image.height / ratio;\n\n\t\tlet msg = `rendering ${image.width}*${image.height} backdrop on ${VPW}*${VPH} stage as ${renderwidth}*${renderheight} px`;\n\n\t\tconsole.log(msg);\n\n\n\t\tlet backdrop = new Konva.Image({\n\t\t\timage: image,\n\t\t\tx: (VPW - renderwidth) / 2,\n\t\t\ty: (VPH - renderheight) / 2,\n\t\t\twidth: renderwidth,\n\t\t\theight: renderheight\n\t\t});\n\t\tconsole.log(\"adding\", backdrop, \"to\", composer);\n\t\tcomposer.add(backdrop);\n\n\t\tcomposer.batchDraw();\n\n\t\tfunction parchifyWhite (imageData) {\n\t\t\t// let ctx = canvas.getContext('2d');\n\t\t\t// let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tlet nPixels = imageData.data.length;\n\t\t\tfor (let i = 0; i < nPixels; i += 4)\n\t\t\t{\n\t\t\t\tlet r = imageData.data[i];\n\t\t\t\tlet g = imageData.data[i + 1];\n\t\t\t\tlet b = imageData.data[i + 2];\n\t\t\t\tlet a = imageData.data[i + 3];\n\t\t\t\tif (a > 200)\n\t\t\t\t{\n\t\t\t\t\t// using brightness (0.21 × R) + (0.72 × G) + (0.07 × B)\n\t\t\t\t\tlet brightness = (0.21 * r) + (0.72 * g) + (0.07 * b);\n\t\t\t\t\tlet greyavrg = brightness / 3;\n\t\t\t\t\tgreyavrg = Math.round(greyavrg / 32) * 32;\n\t\t\t\t\timageData.data[i] = greyavrg;\n\t\t\t\t\timageData.data[i + 1] = greyavrg;\n\t\t\t\t\timageData.data[i + 2] = greyavrg;\n\n\t\t\t\t\timageData.data[i + 3] = 255 - brightness;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}\n\n\t\tcomposer.cache();\n\n\t\tcomposer.filters([Konva.Filters.Brighten]);\n\t\tcomposer.brightness(0.8);\n\t\tcomposer.filters([parchifyWhite]);\n\t\tcomposer.batchDraw();\n\n\t}\n\n\n}\n","import {WorldMap} from \"../../../rpg-engine/world/world-map\";\nimport Konva from \"konva\";\nimport {WorldPosition} from \"../../../rpg-engine/world/world-position\";\nimport {ElementRef} from \"@angular/core\";\n\nexport class WalkRenderer\n{\n\tworldmap: WorldMap;\n\n\t// NOTE: these could be configured via a tileset theme\n\n\t// TILESBYTERRRAIN = {\n\t// \t\"M\": \"basetilemountain400.png\",\n\t// \t\"H\": \"basetilehills400.png\",\n\t// \t\"F\": \"basetileforest400.png\",\n\t// \t\"P\": \"basetileplains400.png\",\n\t// };\n\n\tTILESBYTERRRAIN = {\n\t\t\"M\": \"basetilemountain.png\",\n\t\t\"H\": \"basetilehills.png\",\n\t\t\"F\": \"basetileforest.png\",\n\t\t\"P\": \"basetileplains.png\",\n\t};\n\tPATH_TILES = \"assets/graph/fptiles/\";\n\tterraintiles: Map<string, string>;\n\ttileimages: Map<string, HTMLImageElement>;\n\n\tMARKERSBYID = {\n\t\t\"towns\": \"basetilecitadel.png\",\n\t};\n\tPATH_MARKERS = \"assets/graph/fptiles/\";\n\tmarkerfiles: Map<string, string>;\n\tmarkerimages: Map<string, HTMLImageElement>;\n\n\n\tEXTRAIMGS = {\n\t\t// \"skybgr\": \"/assets/graph/bgr/sunspearsky.jpg\",\n\t\t\"skybgr\": \"assets/graph/bgr/sunspearsky_gscale.png\"\n\t};\n\n\textrafiles: Map<string, string>;\n\textraimages: Map<string, HTMLImageElement>;\n\n\trenderview: ElementRef;\n\n\tconstructor (worldmap: WorldMap, target: ElementRef)\n\t{\n\t\tthis.worldmap = worldmap;\n\t\tthis.renderview = target;\n\t\tconsole.log(this.renderview);\n\t\tconsole.log(\"render view id\", this.renderview.nativeElement.id);\n\t}\n\n\tloadAssets (callback: Function)\n\t{\n\t\tthis.terraintiles = new Map<string, string>();\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tthis.markerfiles = new Map<string, string>();\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tthis.extrafiles = new Map<string, string>();\n\t\tthis.extraimages = new Map<string, HTMLImageElement>();\n\n\t\tfor (let key in this.TILESBYTERRRAIN) {\n\t\t\tthis.terraintiles.set(key, this.PATH_TILES + this.TILESBYTERRRAIN[key]);\n\t\t}\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tthis.tileimages.set(terrain, null);\n\t\t}\n\n\t\tfor (let key in this.MARKERSBYID) {\n\t\t\tthis.markerfiles.set(key, this.PATH_MARKERS + this.MARKERSBYID[key]);\n\t\t}\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tthis.markerimages.set(markerid, null);\n\t\t}\n\n\t\tfor (let key in this.EXTRAIMGS) {\n\t\t\tthis.extrafiles.set(key, this.EXTRAIMGS[key]);\n\t\t}\n\t\tthis.extraimages = new Map<string, HTMLImageElement>();\n\t\tfor (let fileid of this.extrafiles.keys()) {\n\t\t\tthis.extraimages.set(fileid, null);\n\t\t}\n\n\t\t// LOADING ASSETS\n\t\tlet ui = this;\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.tileimages.set(terrain, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.terraintiles.get(terrain);\n\t\t}\n\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.markerimages.set(markerid, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.markerfiles.get(markerid);\n\t\t}\n\n\t\tfor (let fileid of this.extrafiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.extraimages.set(fileid, imageObj);\n\t\t\t\tui.checkReadyRender(callback);\n\t\t\t};\n\t\t\timageObj.src = this.extrafiles.get(fileid);\n\t\t}\n\n\n\t}\n\n\tcheckReadyRender (callback: Function)\n\t{\n\t\tfor (let terrain of this.tileimages.keys()) {\n\t\t\tif (this.tileimages.get(terrain) == null) {\n\t\t\t\t// console.log(\"missing maptile\", terrain, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let markerid of this.markerimages.keys()) {\n\t\t\tif (this.markerimages.get(markerid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let fileid of this.extraimages.keys()) {\n\t\t\tif (this.extraimages.get(fileid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\n\t\tcallback();\n\t}\n\n\n\trenderView (pos: WorldPosition, vector: number[])\n\t{\n\t\t// console.log(\"rendering step \", this.journeyscene.stepid);\n\t\t// const vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\n\t\t// console.log(\"checking step view in dir \", vector, \"from\", this.journeyscene.getCurrentCoordinates().getCoords());\n\t\tconst FOV = 90;\n\t\tlet rect = this.renderview.nativeElement.getBoundingClientRect();\n\t\tconsole.log(\"RECT:\", rect);\n\t\tconst VPW = this.renderview.nativeElement.clientWidth;\n\t\tconst VPH = this.renderview.nativeElement.clientHeight;\n\n\t\tconst PANWIDTH = VPW / (FOV / 360);\n\n\t\tconsole.log(\"using fov\", FOV, \"on \" + VPW + \"*\" + VPH + \": pan to \" + PANWIDTH + \"px\");\n\n\t\tconst MAXDIST = 9;\n\n\t\tlet rendergrid = this.getRenderGrid(pos, vector, MAXDIST);\n\n\n\t\tlet stage = new Konva.Stage({\n\t\t\tcontainer: this.renderview.nativeElement.id,\n\t\t\twidth: VPW,\n\t\t\theight: VPH,\n\n\t\t});\n\n\t\t// console.log(rendergrid);\n\t\t// NOTE: following works ONLY with 90 FOV\n\t\t// also we are actually half step inside each tile but since dist and angle stay the same we ignore\n\n\t\tconst HCENTER = VPW * 0.5;\n\t\tconst VCENTER = VPH * 0.4;\n\t\tconst PHEIGHT = VPH - VCENTER;\n\n\n\t\tlet tilelayer = new Konva.Layer({\n\t\t});\n\t\tstage.add(tilelayer);\n\n\t\t// BGR + CUT\n\n\t\tlet bgrimg = this.extraimages.get(\"skybgr\");\n\t\t// let filename = terraintiles.get(terrain);\n\t\tlet bgr = new Konva.Image({\n\t\t\timage: bgrimg,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: VPW,\n\t\t\theight: VPH * 0.8\n\t\t});\n\t\ttilelayer.add(bgr);\n\n\t\tlet bgrcut = VCENTER + PHEIGHT / MAXDIST;\n\t\tlet rect1 = new Konva.Rect({\n\t\t\tx: 0,\n\t\t\ty:  bgrcut,\n\t\t\twidth: VPW,\n\t\t\theight: VPH - (bgrcut),\n\t\t\tfill: 'white',\n\t\t\t// stroke: 'black',\n\t\t\t// strokeWidth: 4\n\t\t});\n\t\t// add the shape to the layer\n\t\ttilelayer.add(rect1);\n\n\n\n\t\tfor (let gp of rendergrid)\n\t\t{\n\t\t\t// field size at dist:\n\t\t\t// 1: 1, 2: 3, 3: 5, 4: 7\n\t\t\t// y = x + (x-1)\n\t\t\tlet fsize = gp.dist + (gp.dist - 1);\n\t\t\tlet gsize = VPH / fsize;\n\t\t\tgsize = VPW / fsize;\n\n\t\t\t// let relpos = gp.angrel - 0.5;\n\t\t\t// let hpixpos = HCENTER + ();\n\n\t\t\tlet hpixpos = gp.angrel * VPW - (gsize * 0.5);\n\t\t\thpixpos = VPW - hpixpos - gsize; // fix mirroring\n\t\t\tlet vpixpos = (VCENTER + PHEIGHT / gp.dist) - gsize;\n\n\t\t\tlet terrain = this.worldmap.getTerrainAt(gp.coords[0], gp.coords[1]);\n\t\t\tlet loc = this.worldmap.getLocationAt(gp.coords);\n\n\t\t\tif (terrain == null && loc == null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet tileimg;\n\t\t\tif (terrain != null) {\n\t\t\t\ttileimg = this.tileimages.get(terrain);\n\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\timage: tileimg,\n\t\t\t\t\tx: hpixpos,\n\t\t\t\t\ty: vpixpos,\n\t\t\t\t\twidth: gsize,\n\t\t\t\t\theight: gsize\n\t\t\t\t});\n\t\t\t\ttilelayer.add(tile);\n\t\t\t}\n\n\t\t\tif (loc != null)\n\t\t\t{\n\t\t\t\ttileimg = this.markerimages.get(loc.loctype);\n\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\timage: tileimg,\n\t\t\t\t\tx: hpixpos,\n\t\t\t\t\ty: vpixpos,\n\t\t\t\t\twidth: gsize,\n\t\t\t\t\theight: gsize\n\t\t\t\t});\n\t\t\t\ttilelayer.add(tile);\n\t\t\t}\n\n\t\t}\n\t\ttilelayer.batchDraw();\n\n\n\t\tfunction parchifyWhite (imageData) {\n\t\t\t// let ctx = canvas.getContext('2d');\n\t\t\t// let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\t\tlet nPixels = imageData.data.length;\n\t\t\tfor (let i = 0; i < nPixels; i += 4)\n\t\t\t{\n\t\t\t\tlet r = imageData.data[i];\n\t\t\t\tlet g = imageData.data[i + 1];\n\t\t\t\tlet b = imageData.data[i + 2];\n\t\t\t\tlet a = imageData.data[i + 3];\n\t\t\t\tif (a > 200)\n\t\t\t\t{\n\t\t\t\t\t// using brightness (0.21 × R) + (0.72 × G) + (0.07 × B)\n\t\t\t\t\t// instead of average ((r + g + b) / 3)\n\t\t\t\t\timageData.data[i + 3] = 255 - ((0.21 * r) + (0.72 * g) + (0.07 * b));\n\t\t\t\t}\n\t\t\t}\n\t\t\t//\n\t\t\t// for (let i = 3; i < nPixels; i += 4) {\n\t\t\t// \tif (imageData.data[i] > 0) {\n\t\t\t// \t\timageData.data[i] = 255;\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t// ctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\t\t// ctx.putImageData(imageData, 0, 0);\n\t\t\t// return canvas;\n\t\t}\n\n\t\ttilelayer.cache();\n\t\ttilelayer.filters([parchifyWhite]);\n\t\t// tilelayer.filters([Konva.Filters.Brighten]);\n\t\t// tilelayer.brightness(0.8);\n\t\ttilelayer.batchDraw();\n\n\n\t}\n\n\n\n\tgetRenderGrid (pov: WorldPosition, vector: number[], maxdist: number)\n\t{\n\t\t// const pov = this.journeyscene.getCurrentCoordinates();\n\t\tconst povX = pov.x;\n\t\tconst povY = pov.y;\n\t\t// const vector = this.journeyscene.getStepDirection(this.journeyscene.stepid);\n\t\tconst angle = WalkRenderer.calcAngleDegreesEast(vector[0], vector[1]);\n\n\n\n\t\t// base angle is EAST\n\n\t\tconst FOV = 90;\n\n\t\tlet angmin = ((angle - FOV / 2) + 360) % 360;\n\t\tlet angmax = ((angle + FOV / 2) + 360) % 360;\n\t\tlet angflip = angmin > angmax;\n\t\tif (angflip)\n\t\t{\n\t\t\tangmax += 360;\n\t\t}\n\t\tlet angv = (angle + 360) % 360;\n\t\tlet angdiff = angmax - angmin;\n\n\t\tconsole.log(\"dir angle is \", angv, \"checking between \", angmin, angmax);\n\n\t\tlet totvis = 0;\n\t\tlet tfrom = new Date().getTime();\n\t\tlet rendergrid: GridPoint[] = [];\n\t\tfor (let x = povX - maxdist; x <= povX + maxdist; x++)\n\t\t{\n\t\t\tfor (let y = povY - maxdist; y <= povY + maxdist; y++)\n\t\t\t{\n\t\t\t\tif (x === povX && y === povY)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet deltaX = x - povX;\n\t\t\t\tlet deltaY = y - povY;\n\t\t\t\tlet angr = WalkRenderer.calcAngleDegreesEast(deltaX, deltaY);\n\t\t\t\tangr = (angr + 360) % 360;\n\t\t\t\tif (angflip && angr <= 45)\n\t\t\t\t{\n\t\t\t\t\tangr += 360;\n\t\t\t\t}\n\n\t\t\t\tif (angmin <= angr && angr <= angmax)\n\t\t\t\t{\n\t\t\t\t\ttotvis++;\n\t\t\t\t\tlet angrel = (angmax - angr) / FOV;\n\t\t\t\t\tlet dist = Math.sqrt((deltaX ** 2) + (deltaY ** 2));\n\t\t\t\t\tif (dist <= maxdist)\n\t\t\t\t\t{\n\t\t\t\t\t\t// we are using a SQUARE box to get the points\n\t\t\t\t\t\t// console.log(x, y, angr);\n\t\t\t\t\t\trendergrid.push({coords: [x, y], angrel: angrel, dist: dist});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\t\tlet tto = new Date().getTime();\n\t\tconsole.log(\"tot vis tiles\", totvis,  tto - tfrom);\n\n\t\t// sorting far to close THEN left to right, second sort is not strictily necessary\n\t\trendergrid.sort(function (a: GridPoint, b: GridPoint) {\n\t\t\t// if (a.dist !== b.dist)\n\t\t\t// {\n\t\t\t// \treturn b.dist - a.dist;\n\t\t\t// }\n\t\t\t// else {\n\t\t\t// \treturn a.angrel - b.angrel;\n\t\t\t// }\n\t\t\treturn b.dist - a.dist;\n\t\t});\n\n\t\treturn rendergrid;\n\t}\n\n\n\tstatic calcAngleDegreesEast (x, y) {\n\t\treturn Math.atan2(y, x) * 180 / Math.PI;\n\t}\n\n}\n\n\ninterface GridPoint {\n\n\tcoords: number[];\n\tangrel: number;\n\tdist:\tnumber;\n\n}\n","export default \"#narration_render {\\n  position: fixed;\\n  left: 16px;\\n  top: 24px;\\n  right: 24px;\\n  height: 42vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n#narration_info {\\n  text-align: center;\\n  position: fixed;\\n  bottom: 16px;\\n  left: 16px;\\n  right: 16px;\\n}\\n\\nbutton.pageturn {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n  background-color: transparent;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9uYXJyYXRpb24tcGFnZXMvbmFycmF0aW9uLXBhZ2VzLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvbmFycmF0aW9uLXBhZ2VzL25hcnJhdGlvbi1wYWdlcy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUdDLGVBQUE7RUFDQSxVQUFBO0VBQ0EsU0FBQTtFQUNBLFdBQUE7RUFFQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDSEQ7O0FET0E7RUFFQyxrQkFBQTtFQUVBLGVBQUE7RUFDQSxZQUFBO0VBQ0EsVUFBQTtFQUNBLFdBQUE7QUNORDs7QURTQTtFQUtDLHVCQUFBO0VBQ0EsZ0JBQUE7RUFFQSxjQUFBO0VBRUEsNkJBQUE7QUNaRCIsImZpbGUiOiJzcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9uYXJyYXRpb24tcGFnZXMvbmFycmF0aW9uLXBhZ2VzLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI25hcnJhdGlvbl9yZW5kZXJcbntcblxuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0dG9wOlx0XHRcdDI0cHg7XG5cdHJpZ2h0Olx0XHRcdDI0cHg7XG5cblx0aGVpZ2h0Olx0XHRcdDQydmg7XG5cdGZvbnQtc2l6ZTpcdFx0OHZoO1xuXG5cdHRleHQtYWxpZ246XHRcdGNlbnRlcjtcbn1cblxuXG4jbmFycmF0aW9uX2luZm9cbntcblx0dGV4dC1hbGlnbjogY2VudGVyO1xuXG5cdHBvc2l0aW9uOlx0XHRmaXhlZDtcblx0Ym90dG9tOlx0XHRcdDE2cHg7XG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0cmlnaHQ6XHRcdFx0MTZweDtcbn1cblxuYnV0dG9uLnBhZ2V0dXJuXG57XG5cblxuXG5cdGJvcmRlcjpcdFx0XHQxcHggc29saWQgYmxhY2s7XG5cdHBhZGRpbmc6XHRcdDJwdCA4cHQ7XG5cblx0Zm9udC1zaXplOlx0XHQ0dmg7XG5cblx0YmFja2dyb3VuZC1jb2xvcjpcdHRyYW5zcGFyZW50O1xufVxuIiwiI25hcnJhdGlvbl9yZW5kZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGxlZnQ6IDE2cHg7XG4gIHRvcDogMjRweDtcbiAgcmlnaHQ6IDI0cHg7XG4gIGhlaWdodDogNDJ2aDtcbiAgZm9udC1zaXplOiA4dmg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuI25hcnJhdGlvbl9pbmZvIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGJvdHRvbTogMTZweDtcbiAgbGVmdDogMTZweDtcbiAgcmlnaHQ6IDE2cHg7XG59XG5cbmJ1dHRvbi5wYWdldHVybiB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICBwYWRkaW5nOiAycHQgOHB0O1xuICBmb250LXNpemU6IDR2aDtcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG59Il19 */\"","import {Component, OnInit, AfterViewInit} from '@angular/core';\nimport {Narration} from '../../../rpg-engine/scenes/narration';\nimport {SceneRef} from '../../../scene-ui/scene-ref';\nimport {SceneRenderer} from '../scene-renderer';\n\n@Component({\n\tselector: 'app-narration-pages',\n\ttemplateUrl: './narration-pages.component.html',\n\tstyleUrls: ['./narration-pages.component.scss']\n})\nexport class NarrationPagesComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\ttale: Narration;\n\tlastpage: boolean;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.tale = this.sceneref.scene as Narration;\n\t\tconsole.log(\"tale info\", this.tale);\n\t}\n\n\tngOnInit() {\n\t}\n\n\tngAfterViewInit() {\n\n\t}\n\n\treadForward ()\n\t{\n\t\tthis.tale.advanceNarration();\n\t\tthis.lastpage = this.tale.sceneFinished();\n\n\t}\n\n\treadBackwards ()\n\t{\n\t\tthis.tale.backtrackNarration();\n\t}\n\n\treadOut ()\n\t{\n\t\tif (this.tale.sceneFinished())\n\t\t{\n\t\t\tthis.sceneref.triggerSceneCheck();\n\t\t}\n\t}\n}\n","export default \".trailview {\\n  position: fixed;\\n  left: 1vw;\\n  right: 1vw;\\n  top: 1vw;\\n  height: 48vh;\\n  border: 2px dashed black;\\n}\\n\\n.trailcontext {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 48vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n.trailcontrols {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9wYXNzYWdlLXRocm91Z2gvcGFzc2FnZS10aHJvdWdoLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvcGFzc2FnZS10aHJvdWdoL3Bhc3NhZ2UtdGhyb3VnaC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxTQUFBO0VBQ0EsVUFBQTtFQUNBLFFBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7QUNBRDs7QURHQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDRkQ7O0FETUE7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ0xEIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3Bhc3NhZ2UtdGhyb3VnaC9wYXNzYWdlLXRocm91Z2guY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudHJhaWx2aWV3XG57XG5cdHBvc2l0aW9uOlx0XHRmaXhlZDtcblx0bGVmdDpcdFx0XHQxdnc7XG5cdHJpZ2h0Olx0XHRcdDF2dztcblx0dG9wOlx0XHRcdDF2dztcblx0aGVpZ2h0Olx0XHRcdDQ4dmg7XG5cdGJvcmRlcjpcdFx0XHQycHggZGFzaGVkIGJsYWNrO1xufVxuXG4udHJhaWxjb250ZXh0XG57XG5cdHBvc2l0aW9uOlx0XHRmaXhlZDtcblx0bGVmdDpcdFx0XHQwO1xuXHRyaWdodDpcdFx0XHQwO1xuXHRib3R0b206XHRcdFx0MDtcblx0aGVpZ2h0Olx0XHRcdDQ4dmg7XG5cdGZvbnQtc2l6ZTpcdFx0OHZoO1xuXG5cdHRleHQtYWxpZ246XHRcdGNlbnRlcjtcbn1cblxuXG4udHJhaWxjb250cm9sc1xue1xuXHRib3JkZXI6XHRcdFx0MXB4IHNvbGlkIGJsYWNrO1xuXHRwYWRkaW5nOlx0XHQycHQgOHB0O1xuXG5cdGZvbnQtc2l6ZTpcdFx0NHZoO1xufVxuIiwiLnRyYWlsdmlldyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMXZ3O1xuICByaWdodDogMXZ3O1xuICB0b3A6IDF2dztcbiAgaGVpZ2h0OiA0OHZoO1xuICBib3JkZXI6IDJweCBkYXNoZWQgYmxhY2s7XG59XG5cbi50cmFpbGNvbnRleHQge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG4gIGhlaWdodDogNDh2aDtcbiAgZm9udC1zaXplOiA4dmg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuLnRyYWlsY29udHJvbHMge1xuICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbiAgcGFkZGluZzogMnB0IDhwdDtcbiAgZm9udC1zaXplOiA0dmg7XG59Il19 */\"","import {AfterViewInit, Component, OnInit} from '@angular/core';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {PassageTrail} from \"../../../rpg-engine/scenes/passage-trail\";\n\n@Component({\n\tselector: 'app-passage-through',\n\ttemplateUrl: './passage-through.component.html',\n\tstyleUrls: ['./passage-through.component.scss']\n})\nexport class PassageThroughComponent  extends SceneRenderer implements OnInit, AfterViewInit {\n\n\ttrail: PassageTrail;\n\tdirection: number;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.trail = this.sceneref.scene as PassageTrail;\n\t}\n\n\tisTrailing ()\n\t{\n\t\treturn this.trail.progress > -1 && this.trail.progress < this.trail.passage.length();\n\t}\n\n\tjourneyOnwards ()\n\t{\n\t\tthis.trail.step();\n\t}\n\n\tleaveTrail ()\n\t{\n\t\tthis.trail.leaving = true;\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n\n\tngOnInit() {\n\t}\n\n\tngAfterViewInit(): void {\n\t}\n\n}\n","export default \"#journeyrender {\\n  position: fixed;\\n  top: 8px;\\n  left: 8px;\\n  right: 8px;\\n  bottom: 30vh;\\n  border: 1px dashed black;\\n  overflow: auto;\\n}\\n\\n#viewrender {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n\\n#journeyinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 28vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\nbutton.journeychoice {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9yb2FtaW5nLXN0ZXAvcm9hbWluZy1zdGVwLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvcm9hbWluZy1zdGVwL3JvYW1pbmctc3RlcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7RUFDQSxjQUFBO0FDQUQ7O0FER0E7RUFFQyxrQkFBQTtFQUNBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7QUNERDs7QURJQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDSEQ7O0FET0E7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ05EIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3JvYW1pbmctc3RlcC9yb2FtaW5nLXN0ZXAuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjam91cm5leXJlbmRlclxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cdGxlZnQ6XHRcdFx0OHB4O1xuXHRyaWdodDpcdFx0XHQ4cHg7XG5cdGJvdHRvbTpcdFx0XHQzMHZoO1xuXHRib3JkZXI6XHRcdFx0MXB4IGRhc2hlZCBibGFjaztcblx0b3ZlcmZsb3c6XHRcdGF1dG87XG59XG5cbiN2aWV3cmVuZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblx0dG9wOlx0XHRcdDA7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG59XG5cbiNqb3VybmV5aW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQyOHZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuYnV0dG9uLmpvdXJuZXljaG9pY2Vcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cbiIsIiNqb3VybmV5cmVuZGVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDhweDtcbiAgbGVmdDogOHB4O1xuICByaWdodDogOHB4O1xuICBib3R0b206IDMwdmg7XG4gIGJvcmRlcjogMXB4IGRhc2hlZCBibGFjaztcbiAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbiN2aWV3cmVuZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB0b3A6IDA7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG59XG5cbiNqb3VybmV5aW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiAyOHZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG5idXR0b24uam91cm5leWNob2ljZSB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICBwYWRkaW5nOiAycHQgOHB0O1xuICBmb250LXNpemU6IDR2aDtcbn0iXX0= */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {WalkRenderer} from \"../lib/walk-renderer\";\nimport {Roaming} from \"../../../rpg-engine/scenes/roaming\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {SceneRenderer} from \"../scene-renderer\";\n\n@Component({\n\tselector: 'app-roaming-step',\n\ttemplateUrl: './roaming-step.component.html',\n\tstyleUrls: ['./roaming-step.component.scss']\n})\nexport class RoamingStepComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"renderholder\", {static: false}) renderholder: ElementRef;\n\t@ViewChild(\"renderview\", {static: false}) renderview: ElementRef;\n\n\troamingscene: Roaming;\n\tviewrenderer: WalkRenderer;\n\n\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\t\tthis.roamingscene = this.sceneref.scene as Roaming;\n\t\tconsole.log(\"roaming scene: \", this.roamingscene);\n\n\t}\n\n\n\tngOnInit() {\n\t}\n\n\n\tngAfterViewInit(): void {\n\t\tthis.viewrenderer = new WalkRenderer(this.roamingscene.game.worldmap, this.renderview);\n\t\tlet ui = this;\n\t\tthis.viewrenderer.loadAssets(function ()\n\t\t{\n\t\t\tui.renderStep();\n\t\t});\n\t}\n\n\trenderStep ()\n\t{\n\t\tconst vector = this.roamingscene.direction;\n\t\tthis.viewrenderer.renderView(this.roamingscene.current, vector);\n\t}\n\n\n\tgetDirectionDescription (): string {\n\t\tlet vector = this.roamingscene.direction;\n\t\tlet dirstring = \"\";\n\n\t\tif (vector[1] > 0) {\n\t\t\tdirstring += \"South\";\n\t\t} else if (vector[1] < 0) {\n\t\t\tdirstring += \"North\";\n\t\t}\n\t\tif (vector[0] > 0) {\n\t\t\tdirstring += \"East\";\n\t\t} else if (vector[0] < 0) {\n\t\t\tdirstring += \"West\";\n\t\t}\n\n\t\treturn dirstring;\n\t}\n\tgetDayOfTravel ()\n\t{\n\t\treturn this.roamingscene.steps + 1;\n\t}\n\n\tmoveTurnLeft ()\n\t{\n\t\tthis.roamingscene.changeDirection(-1);\n\t\tthis.renderStep();\n\t}\n\n\tmoveTurnRight ()\n\t{\n\t\tthis.roamingscene.changeDirection(1);\n\t\tthis.renderStep();\n\t}\n\n\tmoveForward ()\n\t{\n\t\tthis.roamingscene.stepForward();\n\t\tthis.roamingscene.game.hero.setCoordinates(this.roamingscene.current);\n\t\tif (!this.roamingscene.sceneFinished())\n\t\t{\n\t\t\tthis.renderStep();\n\t\t}\n\t\telse {\n\t\t\tthis.sceneref.triggerSceneCheck();\n\t\t}\n\t}\n\n\tactionSetCamp ()\n\t{\n\n\t}\n\n\n\tshowMap ()\n\t{\n\t\t// tba\n\t}\n\n\n}\n","import {WanderScene} from \"../../rpg-engine/wander-scene\";\nimport {Type} from \"@angular/core\";\nimport {JourneyDeparture} from \"../../rpg-engine/scenes/journey-departure\";\nimport {WorldMapViewComponent} from \"./world-map-view/world-map-view.component\";\nimport {Journey} from \"../../rpg-engine/scenes/journey\";\nimport {JourneyStepComponent} from \"./journey-step/journey-step.component\";\nimport {TownNav} from \"../../rpg-engine/scenes/town-nav\";\nimport {TownUIComponent} from \"./town-ui/town-ui.component\";\nimport {Roaming} from \"../../rpg-engine/scenes/roaming\";\nimport {RoamingStepComponent} from \"./roaming-step/roaming-step.component\";\nimport {PassageTrail} from \"../../rpg-engine/scenes/passage-trail\";\nimport {PassageThroughComponent} from \"./passage-through/passage-through.component\";\nimport {Narration} from \"../../rpg-engine/scenes/narration\";\nimport {NarrationPagesComponent} from \"./narration-pages/narration-pages.component\";\nimport {SceneRenderer} from \"./scene-renderer\";\nimport {StoryBranch} from \"../../rpg-engine/scenes/story-branch\";\nimport {StoryChoiceComponent} from \"./story-choice/story-choice.component\";\nimport {SkillActionComponent} from \"./skill-action/skill-action.component\";\nimport {SkillTest} from \"../../rpg-engine/scenes/skill-test\";\n\nexport class SceneRendererLoader\n{\n\t\tstatic getSceneRendererClass (scene: WanderScene): Type<SceneRenderer>\n\t{\n\t\tlet renderer;\n\t\tif (scene instanceof JourneyDeparture)\n\t\t{\n\t\t\trenderer = WorldMapViewComponent;\n\t\t}\n\t\telse if (scene instanceof Journey)\n\t\t{\n\t\t\trenderer = JourneyStepComponent;\n\t\t}\n\t\telse if (scene instanceof TownNav)\n\t\t{\n\t\t\trenderer = TownUIComponent;\n\t\t}\n\t\telse if (scene instanceof Roaming)\n\t\t{\n\t\t\trenderer = RoamingStepComponent;\n\t\t}\n\t\telse if (scene instanceof PassageTrail)\n\t\t{\n\t\t\trenderer = PassageThroughComponent;\n\t\t}\n\t\telse if (scene instanceof Narration)\n\t\t{\n\t\t\trenderer = NarrationPagesComponent;\n\t\t}\n\t\telse if (scene instanceof StoryBranch)\n\t\t{\n\t\t\trenderer = StoryChoiceComponent;\n\t\t}\n\t\telse if (scene instanceof SkillTest)\n\t\t{\n\t\t\trenderer = SkillActionComponent;\n\t\t}\n\n\t\treturn renderer;\n\t}\n}\n","import {SceneRef} from \"../../scene-ui/scene-ref\";\nimport {StorytellerInterface} from \"../storyteller-interface\";\n\n\nexport abstract class SceneRenderer {\n\n\tstint: StorytellerInterface;\n\n\tprotected constructor(public sceneref: SceneRef, storytellerinterface: StorytellerInterface = null)\n\t{\n\t\tthis.stint = storytellerinterface;\n\t}\n\n\n\n}\n","export default \"#choiceinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 42vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n#choicescenery {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  top: 0;\\n  height: 54vh;\\n  overflow: hidden;\\n}\\n\\n/*\\n\\n.locimageholder\\n{\\n\\tposition:\\t\\tabsolute;\\n\\n\\tleft:\\t\\t\\t16px;\\n\\tright:\\t\\t\\t16px;\\n\\tbottom:\\t\\t\\t8px;\\n\\ttop:\\t\\t\\t8px;\\n\\n\\ttext-align:\\t\\tcenter;\\n\\t//border:\\t\\t\\t1px solid red;\\n}\\n\\n.locimage\\n{\\n\\tmax-width:\\t\\t\\t100%;\\n\\tmax-height:\\t\\t\\t100%;\\n\\tobject-fit: \\t\\tcover;\\n\\n}\\n*/\\n\\n.choicecontrols {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n\\n#sceneryview {\\n  position: absolute;\\n  left: 16px;\\n  right: 16px;\\n  bottom: 8px;\\n  top: 8px;\\n}\\n\\nul.choices-prompt * {\\n  cursor: pointer;\\n}\\n\\nbutton.skillchoice {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9za2lsbC1hY3Rpb24vc2tpbGwtYWN0aW9uLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvc2tpbGwtYWN0aW9uL3NraWxsLWFjdGlvbi5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDREQ7O0FES0E7RUFFQyxlQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxNQUFBO0VBRUEsWUFBQTtFQUdBLGdCQUFBO0FDTkQ7O0FEU0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0FBQTs7QUF3QkE7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ1REOztBRFlBO0VBRUMsa0JBQUE7RUFFQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLFdBQUE7RUFDQSxRQUFBO0FDWEQ7O0FEY0E7RUFFQyxlQUFBO0FDWkQ7O0FEZUE7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ2REIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3NraWxsLWFjdGlvbi9za2lsbC1hY3Rpb24uY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY2hvaWNlaW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQ0MnZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuI2Nob2ljZXNjZW5lcnlcbntcblx0cG9zaXRpb246XHRcdGZpeGVkO1xuXHRsZWZ0Olx0XHRcdDA7XG5cdHJpZ2h0Olx0XHRcdDA7XG5cdHRvcDpcdFx0XHQwO1xuXG5cdGhlaWdodDpcdFx0XHQ1NHZoO1xuXG5cdC8vYm9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0b3ZlcmZsb3c6IGhpZGRlbjtcblxufVxuLypcblxuLmxvY2ltYWdlaG9sZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblxuXHRsZWZ0Olx0XHRcdDE2cHg7XG5cdHJpZ2h0Olx0XHRcdDE2cHg7XG5cdGJvdHRvbTpcdFx0XHQ4cHg7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cblx0dGV4dC1hbGlnbjpcdFx0Y2VudGVyO1xuXHQvL2JvcmRlcjpcdFx0XHQxcHggc29saWQgcmVkO1xufVxuXG4ubG9jaW1hZ2Vcbntcblx0bWF4LXdpZHRoOlx0XHRcdDEwMCU7XG5cdG1heC1oZWlnaHQ6XHRcdFx0MTAwJTtcblx0b2JqZWN0LWZpdDogXHRcdGNvdmVyO1xuXG59XG4qL1xuXG4uY2hvaWNlY29udHJvbHNcbntcblx0Ym9yZGVyOlx0XHRcdDFweCBzb2xpZCBibGFjaztcblx0cGFkZGluZzpcdFx0MnB0IDhwdDtcblxuXHRmb250LXNpemU6XHRcdDR2aDtcbn1cblxuI3NjZW5lcnl2aWV3XG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblxuXHRsZWZ0Olx0XHRcdDE2cHg7XG5cdHJpZ2h0Olx0XHRcdDE2cHg7XG5cdGJvdHRvbTpcdFx0XHQ4cHg7XG5cdHRvcDpcdFx0XHQ4cHg7XG59XG5cbnVsLmNob2ljZXMtcHJvbXB0ICpcbntcblx0Y3Vyc29yOlx0cG9pbnRlcjtcbn1cblxuYnV0dG9uLnNraWxsY2hvaWNlXG57XG5cdGJvcmRlcjpcdFx0XHQxcHggc29saWQgYmxhY2s7XG5cdHBhZGRpbmc6XHRcdDJwdCA4cHQ7XG5cblx0Zm9udC1zaXplOlx0XHQ0dmg7XG59XG4iLCIjY2hvaWNlaW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiA0MnZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4jY2hvaWNlc2NlbmVyeSB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIHRvcDogMDtcbiAgaGVpZ2h0OiA1NHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuXG4vKlxuXG4ubG9jaW1hZ2Vob2xkZXJcbntcblx0cG9zaXRpb246XHRcdGFic29sdXRlO1xuXG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0cmlnaHQ6XHRcdFx0MTZweDtcblx0Ym90dG9tOlx0XHRcdDhweDtcblx0dG9wOlx0XHRcdDhweDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG5cdC8vYm9yZGVyOlx0XHRcdDFweCBzb2xpZCByZWQ7XG59XG5cbi5sb2NpbWFnZVxue1xuXHRtYXgtd2lkdGg6XHRcdFx0MTAwJTtcblx0bWF4LWhlaWdodDpcdFx0XHQxMDAlO1xuXHRvYmplY3QtZml0OiBcdFx0Y292ZXI7XG5cbn1cbiovXG4uY2hvaWNlY29udHJvbHMge1xuICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcbiAgcGFkZGluZzogMnB0IDhwdDtcbiAgZm9udC1zaXplOiA0dmg7XG59XG5cbiNzY2VuZXJ5dmlldyB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgbGVmdDogMTZweDtcbiAgcmlnaHQ6IDE2cHg7XG4gIGJvdHRvbTogOHB4O1xuICB0b3A6IDhweDtcbn1cblxudWwuY2hvaWNlcy1wcm9tcHQgKiB7XG4gIGN1cnNvcjogcG9pbnRlcjtcbn1cblxuYnV0dG9uLnNraWxsY2hvaWNlIHtcbiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG4gIHBhZGRpbmc6IDJwdCA4cHQ7XG4gIGZvbnQtc2l6ZTogNHZoO1xufSJdfQ== */\"","import {AfterViewInit, Component, OnInit} from '@angular/core';\nimport {StoryBranch} from \"../../../rpg-engine/scenes/story-branch\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {StorytellerInterface} from \"../../storyteller-interface\";\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {SkillTest, SkillTestOption} from \"../../../rpg-engine/scenes/skill-test\";\n\n@Component({\n  selector: 'app-skill-action',\n  templateUrl: './skill-action.component.html',\n  styleUrls: ['./skill-action.component.scss']\n})\nexport class SkillActionComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\tskilltest: SkillTest;\n\n\tnarr_fail: string;\n\tnarr_done: string;\n\n\tconstructor(public sceneref: SceneRef, storytellerinterface: StorytellerInterface = null) {\n\n\t\tsuper(sceneref, storytellerinterface);\n\t\tconsole.log(\"StoryChoice injected w stinterface: \", storytellerinterface);\n\t\tthis.skilltest = this.sceneref.scene as SkillTest;\n\t\tconsole.log(\"current choice set is \", this.skilltest);\n\t\tthis.narr_fail = null;\n\t\tthis.narr_done = null;\n\t}\n\n  ngOnInit() {\n  }\n\n\tngAfterViewInit(): void {\n\t}\n\n\ttryOption (option: SkillTestOption, succeed: boolean)\n\t{\n\t\tconsole.log(\"picked option \", option,\" for trying\");\n\t\tlet success = this.skilltest.playActionDebug(option, succeed);\n\t\tif (success)\n\t\t{\n\t\t\tthis.narr_fail = null;\n\t\t\tthis.narr_done = option.story_success;\n\t\t}\n\t\telse {\n\t\t\tthis.narr_fail = option.story_failure;\n\t\t}\n\n\n\t}\n\n\tleaveScene ()\n\t{\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n\n}\n","export default \"#choiceinfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 42vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n#choicescenery {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  top: 0;\\n  height: 54vh;\\n  overflow: hidden;\\n}\\n\\n/*\\n\\n.locimageholder\\n{\\n\\tposition:\\t\\tabsolute;\\n\\n\\tleft:\\t\\t\\t16px;\\n\\tright:\\t\\t\\t16px;\\n\\tbottom:\\t\\t\\t8px;\\n\\ttop:\\t\\t\\t8px;\\n\\n\\ttext-align:\\t\\tcenter;\\n\\t//border:\\t\\t\\t1px solid red;\\n}\\n\\n.locimage\\n{\\n\\tmax-width:\\t\\t\\t100%;\\n\\tmax-height:\\t\\t\\t100%;\\n\\tobject-fit: \\t\\tcover;\\n\\n}\\n*/\\n\\n.choicecontrols {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n\\n#sceneryview {\\n  position: absolute;\\n  left: 16px;\\n  right: 16px;\\n  bottom: 8px;\\n  top: 8px;\\n}\\n\\nul.choices-prompt * {\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy9zdG9yeS1jaG9pY2Uvc3RvcnktY2hvaWNlLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvc3RvcnktY2hvaWNlL3N0b3J5LWNob2ljZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLGVBQUE7RUFDQSxPQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUVBLGtCQUFBO0FDREQ7O0FES0E7RUFFQyxlQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxNQUFBO0VBRUEsWUFBQTtFQUdBLGdCQUFBO0FDTkQ7O0FEU0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0FBQTs7QUF3QkE7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ1REOztBRFlBO0VBRUMsa0JBQUE7RUFFQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLFdBQUE7RUFDQSxRQUFBO0FDWEQ7O0FEY0E7RUFFQyxlQUFBO0FDWkQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvc3RvcnktY2hvaWNlL3N0b3J5LWNob2ljZS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiNjaG9pY2VpbmZvXG57XG5cdHBvc2l0aW9uOlx0XHRmaXhlZDtcblx0bGVmdDpcdFx0XHQwO1xuXHRyaWdodDpcdFx0XHQwO1xuXHRib3R0b206XHRcdFx0MDtcblx0aGVpZ2h0Olx0XHRcdDQydmg7XG5cdGZvbnQtc2l6ZTpcdFx0OHZoO1xuXG5cdHRleHQtYWxpZ246XHRcdGNlbnRlcjtcbn1cblxuXG4jY2hvaWNlc2NlbmVyeVxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0dG9wOlx0XHRcdDA7XG5cblx0aGVpZ2h0Olx0XHRcdDU0dmg7XG5cblx0Ly9ib3JkZXI6XHRcdFx0MXB4IHNvbGlkIGJsYWNrO1xuXHRvdmVyZmxvdzogaGlkZGVuO1xuXG59XG4vKlxuXG4ubG9jaW1hZ2Vob2xkZXJcbntcblx0cG9zaXRpb246XHRcdGFic29sdXRlO1xuXG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0cmlnaHQ6XHRcdFx0MTZweDtcblx0Ym90dG9tOlx0XHRcdDhweDtcblx0dG9wOlx0XHRcdDhweDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG5cdC8vYm9yZGVyOlx0XHRcdDFweCBzb2xpZCByZWQ7XG59XG5cbi5sb2NpbWFnZVxue1xuXHRtYXgtd2lkdGg6XHRcdFx0MTAwJTtcblx0bWF4LWhlaWdodDpcdFx0XHQxMDAlO1xuXHRvYmplY3QtZml0OiBcdFx0Y292ZXI7XG5cbn1cbiovXG5cbi5jaG9pY2Vjb250cm9sc1xue1xuXHRib3JkZXI6XHRcdFx0MXB4IHNvbGlkIGJsYWNrO1xuXHRwYWRkaW5nOlx0XHQycHQgOHB0O1xuXG5cdGZvbnQtc2l6ZTpcdFx0NHZoO1xufVxuXG4jc2NlbmVyeXZpZXdcbntcblx0cG9zaXRpb246XHRcdGFic29sdXRlO1xuXG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0cmlnaHQ6XHRcdFx0MTZweDtcblx0Ym90dG9tOlx0XHRcdDhweDtcblx0dG9wOlx0XHRcdDhweDtcbn1cblxudWwuY2hvaWNlcy1wcm9tcHQgKlxue1xuXHRjdXJzb3I6XHRwb2ludGVyO1xufVxuIiwiI2Nob2ljZWluZm8ge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICBib3R0b206IDA7XG4gIGhlaWdodDogNDJ2aDtcbiAgZm9udC1zaXplOiA4dmg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuI2Nob2ljZXNjZW5lcnkge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICB0b3A6IDA7XG4gIGhlaWdodDogNTR2aDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbn1cblxuLypcblxuLmxvY2ltYWdlaG9sZGVyXG57XG5cdHBvc2l0aW9uOlx0XHRhYnNvbHV0ZTtcblxuXHRsZWZ0Olx0XHRcdDE2cHg7XG5cdHJpZ2h0Olx0XHRcdDE2cHg7XG5cdGJvdHRvbTpcdFx0XHQ4cHg7XG5cdHRvcDpcdFx0XHQ4cHg7XG5cblx0dGV4dC1hbGlnbjpcdFx0Y2VudGVyO1xuXHQvL2JvcmRlcjpcdFx0XHQxcHggc29saWQgcmVkO1xufVxuXG4ubG9jaW1hZ2Vcbntcblx0bWF4LXdpZHRoOlx0XHRcdDEwMCU7XG5cdG1heC1oZWlnaHQ6XHRcdFx0MTAwJTtcblx0b2JqZWN0LWZpdDogXHRcdGNvdmVyO1xuXG59XG4qL1xuLmNob2ljZWNvbnRyb2xzIHtcbiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG4gIHBhZGRpbmc6IDJwdCA4cHQ7XG4gIGZvbnQtc2l6ZTogNHZoO1xufVxuXG4jc2NlbmVyeXZpZXcge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGxlZnQ6IDE2cHg7XG4gIHJpZ2h0OiAxNnB4O1xuICBib3R0b206IDhweDtcbiAgdG9wOiA4cHg7XG59XG5cbnVsLmNob2ljZXMtcHJvbXB0ICoge1xuICBjdXJzb3I6IHBvaW50ZXI7XG59Il19 */\"","import {AfterViewInit, Component, OnInit} from '@angular/core';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {StorytellerInterface} from \"../../storyteller-interface\";\nimport {ChoiceOption, StoryBranch} from \"../../../rpg-engine/scenes/story-branch\";\n\n@Component({\n  selector: 'app-story-choice',\n  templateUrl: './story-choice.component.html',\n  styleUrls: ['./story-choice.component.scss']\n})\nexport class StoryChoiceComponent extends SceneRenderer implements OnInit, AfterViewInit  {\n\n\tchoice: StoryBranch;\n\n\tconstructor(public sceneref: SceneRef, storytellerinterface: StorytellerInterface = null) {\n\n\t\tsuper(sceneref, storytellerinterface);\n\t\tconsole.log(\"StoryChoice injected w stinterface: \", storytellerinterface);\n\t\tthis.choice = this.sceneref.scene as StoryBranch;\n\t\tconsole.log(\"current choice set is \", this.choice);\n\t}\n\n\tngOnInit() {\n\t}\n\n\tngAfterViewInit(): void {\n\t}\n\n\tselectOption (opt: ChoiceOption)\n\t{\n\t\tthis.choice.setSelected(opt);\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n\n}\n","export default \"#towninfo {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  height: 42vh;\\n  font-size: 8vh;\\n  text-align: center;\\n}\\n\\n#townscene {\\n  position: fixed;\\n  left: 0;\\n  right: 0;\\n  top: 0;\\n  height: 54vh;\\n  overflow: hidden;\\n}\\n\\n.locimageholder {\\n  position: absolute;\\n  left: 16px;\\n  right: 16px;\\n  bottom: 8px;\\n  top: 8px;\\n  text-align: center;\\n}\\n\\n.locimage {\\n  max-width: 100%;\\n  max-height: 100%;\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n}\\n\\n.movecontrols {\\n  border: 1px solid black;\\n  padding: 2pt 8pt;\\n  font-size: 4vh;\\n}\\n\\n#locrender {\\n  position: absolute;\\n  left: 16px;\\n  right: 16px;\\n  bottom: 8px;\\n  top: 8px;\\n}\\n\\nul.townnav-prompt * {\\n  cursor: pointer;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy90b3duLXVpL3Rvd24tdWkuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy90b3duLXVpL3Rvd24tdWkuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFFQyxlQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0VBQ0EsWUFBQTtFQUNBLGNBQUE7RUFFQSxrQkFBQTtBQ0REOztBREtBO0VBRUMsZUFBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsTUFBQTtFQUVBLFlBQUE7RUFHQSxnQkFBQTtBQ05EOztBRFVBO0VBRUMsa0JBQUE7RUFFQSxVQUFBO0VBQ0EsV0FBQTtFQUNBLFdBQUE7RUFDQSxRQUFBO0VBRUEsa0JBQUE7QUNWRDs7QURjQTtFQUVDLGVBQUE7RUFDQSxnQkFBQTtFQUNBLG9CQUFBO0tBQUEsaUJBQUE7QUNaRDs7QURnQkE7RUFFQyx1QkFBQTtFQUNBLGdCQUFBO0VBRUEsY0FBQTtBQ2ZEOztBRGtCQTtFQUVDLGtCQUFBO0VBRUEsVUFBQTtFQUNBLFdBQUE7RUFDQSxXQUFBO0VBQ0EsUUFBQTtBQ2pCRDs7QURvQkE7RUFFQyxlQUFBO0FDbEJEIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3Rvd24tdWkvdG93bi11aS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiN0b3duaW5mb1xue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0Ym90dG9tOlx0XHRcdDA7XG5cdGhlaWdodDpcdFx0XHQ0MnZoO1xuXHRmb250LXNpemU6XHRcdDh2aDtcblxuXHR0ZXh0LWFsaWduOlx0XHRjZW50ZXI7XG59XG5cblxuI3Rvd25zY2VuZVxue1xuXHRwb3NpdGlvbjpcdFx0Zml4ZWQ7XG5cdGxlZnQ6XHRcdFx0MDtcblx0cmlnaHQ6XHRcdFx0MDtcblx0dG9wOlx0XHRcdDA7XG5cblx0aGVpZ2h0Olx0XHRcdDU0dmg7XG5cblx0Ly9ib3JkZXI6XHRcdFx0MXB4IHNvbGlkIGJsYWNrO1xuXHRvdmVyZmxvdzogaGlkZGVuO1xuXG59XG5cbi5sb2NpbWFnZWhvbGRlclxue1xuXHRwb3NpdGlvbjpcdFx0YWJzb2x1dGU7XG5cblx0bGVmdDpcdFx0XHQxNnB4O1xuXHRyaWdodDpcdFx0XHQxNnB4O1xuXHRib3R0b206XHRcdFx0OHB4O1xuXHR0b3A6XHRcdFx0OHB4O1xuXG5cdHRleHQtYWxpZ246XHRcdGNlbnRlcjtcblx0Ly9ib3JkZXI6XHRcdFx0MXB4IHNvbGlkIHJlZDtcbn1cblxuLmxvY2ltYWdlXG57XG5cdG1heC13aWR0aDpcdFx0XHQxMDAlO1xuXHRtYXgtaGVpZ2h0Olx0XHRcdDEwMCU7XG5cdG9iamVjdC1maXQ6IFx0XHRjb3ZlcjtcblxufVxuXG4ubW92ZWNvbnRyb2xzXG57XG5cdGJvcmRlcjpcdFx0XHQxcHggc29saWQgYmxhY2s7XG5cdHBhZGRpbmc6XHRcdDJwdCA4cHQ7XG5cblx0Zm9udC1zaXplOlx0XHQ0dmg7XG59XG5cbiNsb2NyZW5kZXJcbntcblx0cG9zaXRpb246XHRcdGFic29sdXRlO1xuXG5cdGxlZnQ6XHRcdFx0MTZweDtcblx0cmlnaHQ6XHRcdFx0MTZweDtcblx0Ym90dG9tOlx0XHRcdDhweDtcblx0dG9wOlx0XHRcdDhweDtcbn1cblxudWwudG93bm5hdi1wcm9tcHQgKlxue1xuXHRjdXJzb3I6XHRwb2ludGVyO1xufSIsIiN0b3duaW5mbyB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgaGVpZ2h0OiA0MnZoO1xuICBmb250LXNpemU6IDh2aDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4jdG93bnNjZW5lIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgdG9wOiAwO1xuICBoZWlnaHQ6IDU0dmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5cbi5sb2NpbWFnZWhvbGRlciB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgbGVmdDogMTZweDtcbiAgcmlnaHQ6IDE2cHg7XG4gIGJvdHRvbTogOHB4O1xuICB0b3A6IDhweDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4ubG9jaW1hZ2Uge1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIG1heC1oZWlnaHQ6IDEwMCU7XG4gIG9iamVjdC1maXQ6IGNvdmVyO1xufVxuXG4ubW92ZWNvbnRyb2xzIHtcbiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG4gIHBhZGRpbmc6IDJwdCA4cHQ7XG4gIGZvbnQtc2l6ZTogNHZoO1xufVxuXG4jbG9jcmVuZGVyIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBsZWZ0OiAxNnB4O1xuICByaWdodDogMTZweDtcbiAgYm90dG9tOiA4cHg7XG4gIHRvcDogOHB4O1xufVxuXG51bC50b3dubmF2LXByb21wdCAqIHtcbiAgY3Vyc29yOiBwb2ludGVyO1xufSJdfQ== */\"","import {AfterViewInit, Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {TownNav} from \"../../../rpg-engine/scenes/town-nav\";\nimport {WalkRenderer} from \"../lib/walk-renderer\";\nimport {ArtRenderer} from \"../lib/art-renderer\";\nimport { QuestTask } from '../../../rpg-engine/quests/quest-task';\nimport {StorytellerComponent} from \"../../storyteller.component\";\nimport {StorytellerInterface} from \"../../storyteller-interface\";\n\n@Component({\n\tselector: 'app-town-ui',\n\ttemplateUrl: './town-ui.component.html',\n\tstyleUrls: ['./town-ui.component.scss']\n})\nexport class TownUIComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"locrender\", {static: false}) locrender: ElementRef;\n\n\tviewrenderer: ArtRenderer;\n\ttownscene: TownNav;\n\n\ttaskprompts: QuestTask[];\n\n\n\tconstructor(public sceneref: SceneRef, storytellerinterface: StorytellerInterface = null) {\n\n\t\tsuper(sceneref, storytellerinterface);\n\t\tconsole.log(\"TownNav injected w stinterface: \", storytellerinterface);\n\t\tthis.townscene = this.sceneref.scene as TownNav;\n\t\tconsole.log(\"town info: \", JSON.stringify(this.townscene.town));\n\t\tthis.taskprompts = [];\n\t}\n\n\tngOnInit() {\n\t}\n\n\tngAfterViewInit(): void {\n\t\tthis.viewrenderer = new ArtRenderer(this.locrender);\n\t\tthis.moveToLoc(this.townscene.locpoint);\n\t}\n\n\tmoveToLoc (target: string)\n\t{\n\t\tthis.townscene.moveToLoc(target);\n\t\tthis.sceneref.triggerSceneCheck();\n\t\tthis.renderView();\n\t\tthis.updateTaskPrompts();\n\t}\n\n\n\tupdateTaskPrompts ()\n\t{\n\n\t\tlet quests = this.sceneref.game.quests.values();\n\t\tlet qtrefs = [];\n\t\tfor (let quest of quests)\n\t\t{\n\t\t\tconsole.log(\"checking quest\", quest);\n\t\t\tlet available = quest.getAvailableTasks(this.sceneref.game);\n\t\t\tconsole.log(\"found available tasks\", available);\n\t\t\tlet qtasks = [];\n\t\t\tfor (let taskid of available)\n\t\t\t{\n\t\t\t\tconsole.log(\"TASK AVAILABLE: \", taskid, \"for quest\", quest);\n\t\t\t\t// this.st\n\t\t\t\t// prompts.push(quest.loadTask(taskid));\n\t\t\t\tqtrefs.push({\n\t\t\t\t\tquest: quest,\n\t\t\t\t\ttaskid: taskid\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.taskprompts = [];\n\t\tlet ui = this;\n\t\tthis.stint.loadQuestTasks(qtrefs, function (tasks: QuestTask[])\n\t\t{\n\t\t\tlet prompts = [];\n\t\t\tfor (let qtask of tasks)\n\t\t\t{\n\t\t\t\tprompts.push(qtask);\n\t\t\t}\n\n\t\t\tconsole.log(\"TownUI reaction to qtasks load\", tasks,\" to prompts \", prompts);\n\t\t\tui.taskprompts = prompts;\n\n\t\t});\n\n\t}\n\n\n\trenderView ()\n\t{\n\t\tlet urlpath = this.townscene.currentloc.image;\n\t\tif (urlpath) {\n\t\t\tlet fullpath = \"./assets/graph/sceneviews/\" + urlpath;\n\t\t\tthis.viewrenderer.loadRenderImage(fullpath);\n\t\t}\n\t}\n\n\tlocalizeTextAsset (text: string): string\n\t{\n\t\twhile (text.includes(\"$TOWN$\"))\n\t\t{\n\t\t\ttext = text.replace(\"$TOWN$\", this.townscene.town.name);\n\t\t}\n\t\treturn text;\n\t}\n\n\n\n\tactivatePrompt (task: QuestTask)\n\t{\n\t\tconsole.log(\"prompt activation for task\", task, \"in\", task.caller);\n\n\t\ttask.scene.driver = task;\n\t\t// narrative should be set by StoryTeller\n\t\tthis.sceneref.triggerSubScene(task.scene);\n\n\n\t}\n\n}\n","export default \"#mapholder {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3NjZW5lcy93b3JsZC1tYXAtdmlldy93b3JsZC1tYXAtdmlldy5jb21wb25lbnQuc2NzcyIsInNyYy9hcHAvc3Rvcnl0ZWxsZXIvc2NlbmVzL3dvcmxkLW1hcC12aWV3L3dvcmxkLW1hcC12aWV3LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBRUMsa0JBQUE7RUFDQSxNQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxTQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeXRlbGxlci9zY2VuZXMvd29ybGQtbWFwLXZpZXcvd29ybGQtbWFwLXZpZXcuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjbWFwaG9sZGVyXG57XG5cdHBvc2l0aW9uOlx0YWJzb2x1dGU7XG5cdHRvcDpcdFx0MDtcblx0bGVmdDpcdFx0MDtcblx0cmlnaHQ6XHRcdDA7XG5cdGJvdHRvbTpcdFx0MDtcbn1cblxuIiwiI21hcGhvbGRlciB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgYm90dG9tOiAwO1xufSJdfQ== */\"","import {AfterViewInit, Component, ElementRef, EventEmitter, OnInit, Output, ViewChild} from '@angular/core';\nimport {SceneRef} from \"../../../scene-ui/scene-ref\";\nimport {WorldMap} from \"../../../rpg-engine/world/world-map\";\nimport Konva from 'konva';\nimport {SceneRenderer} from \"../scene-renderer\";\nimport {JourneyDeparture} from \"../../../rpg-engine/scenes/journey-departure\";\nimport {Place} from \"../../../rpg-engine/world/locs/Place\";\n\n@Component({\n\tselector: 'app-world-map-view',\n\ttemplateUrl: './world-map-view.component.html',\n\tstyleUrls: ['./world-map-view.component.scss']\n})\nexport class WorldMapViewComponent extends SceneRenderer implements OnInit, AfterViewInit {\n\n\t@ViewChild(\"mapview\", {static: false}) mapdom: ElementRef;\n\t@ViewChild(\"mapholder\", {static: false}) container: ElementRef;\n\t@Output() scenecheck = new EventEmitter<object>();\n\n\n\tTILESIZE = 48;\n\n\n\tTILESBYTERRRAIN = {\n\t\t\"M\": \"worldmaptile_mountains_trans.png\",\n\t\t\"H\": \"worldmaptile_hills_trans.png\",\n\t\t\"F\": \"worldmaptile_woods_trans.png\",\n\t\t\"P\": \"worldmaptile_empty.png\",\n\t};\n\tPATH_TILES = \"assets/graph/maptiles/\";\n\tterraintiles: Map<string, string>;\n\ttileimages: Map<string, HTMLImageElement>;\n\n\tMARKERSBYID = {\n\t\t\"towns\": \"worldmapmarker_castle_trans.png\",\n\t\t\"passes\": \"worldmapmarker_mountainpass_trans.png\",\n\t\t\"hero\": \"worldmapmarker_hero_trans.png\",\n\t};\n\tPATH_MARKERS = \"assets/graph/mapmarkers/\";\n\tmarkerfiles: Map<string, string>;\n\tmarkerimages: Map<string, HTMLImageElement>;\n\n\tworldmap: WorldMap;\n\n\tmapscene: JourneyDeparture;\n\n\tconstructor(public sceneref: SceneRef) {\n\t\tsuper(sceneref);\n\n\t\tconsole.log(\"constructor w sref game \", this.sceneref.game);\n\n\t\tthis.mapscene = this.sceneref.scene as JourneyDeparture;\n\t\tthis.prepareAssetsHolders();\n\t}\n\n\tprepareAssetsHolders ()\n\t{\n\t\tthis.terraintiles = new Map<string, string>();\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tthis.markerfiles = new Map<string, string>();\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let key in this.TILESBYTERRRAIN) {\n\t\t\tthis.terraintiles.set(key, this.PATH_TILES + this.TILESBYTERRRAIN[key]);\n\t\t}\n\t\tthis.tileimages = new Map<string, HTMLImageElement>();\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tthis.tileimages.set(terrain, null);\n\t\t}\n\n\t\tfor (let key in this.MARKERSBYID) {\n\t\t\tthis.markerfiles.set(key, this.PATH_MARKERS + this.MARKERSBYID[key]);\n\t\t}\n\t\tthis.markerimages = new Map<string, HTMLImageElement>();\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tthis.markerimages.set(markerid, null);\n\t\t}\n\n\t}\n\n\tngOnInit() {\n\n\t\tconsole.log(\"starting worldmap w sref game \", this.sceneref);\n\t\tthis.worldmap = this.sceneref.game.worldmap;\n\n\t\tthis.loadAssets();\n\n\t}\n\n\n\tngAfterViewInit() {\n\t\t// this.loadAssets();\n\n\n\t}\n\n\tloadAssets() {\n\t\tlet ui = this;\n\t\tfor (let terrain of this.terraintiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.tileimages.set(terrain, imageObj);\n\t\t\t\tui.checkReadyRender();\n\t\t\t};\n\t\t\timageObj.src = this.terraintiles.get(terrain);\n\t\t}\n\n\t\tfor (let markerid of this.markerfiles.keys()) {\n\t\t\tlet imageObj = new Image();\n\t\t\timageObj.onload = function () {\n\t\t\t\tui.markerimages.set(markerid, imageObj);\n\t\t\t\tui.checkReadyRender();\n\t\t\t};\n\t\t\timageObj.src = this.markerfiles.get(markerid);\n\t\t}\n\n\t}\n\n\tcheckReadyRender() {\n\n\t\tfor (let terrain of this.tileimages.keys()) {\n\t\t\tif (this.tileimages.get(terrain) == null) {\n\t\t\t\t// console.log(\"missing maptile\", terrain, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor (let markerid of this.markerimages.keys()) {\n\t\t\tif (this.markerimages.get(markerid) == null) {\n\t\t\t\t// console.log(\"missing mapmarker\", markerid, \"wait\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// console.log(\"ready on all terrains\");\n\t\tthis.initRender();\n\t}\n\n\tinitRender() {\n\n\n\t\tconst vpw = this.container.nativeElement.offsetWidth;\n\t\tconst vph = this.container.nativeElement.offsetHeight;\n\n\t\tthis.TILESIZE = Math.min(vpw, vph) / 18;\n\n\t\tlet tilesX = this.worldmap.sizeX;\n\t\tlet tilesY = this.worldmap.sizeY;\n\n\n\t\tlet mapWidth = tilesX * this.TILESIZE;\n\t\tlet mapHeight = tilesY * this.TILESIZE;\n\n\n\t\t// console.log(this.TILESIZE, tilesX, tilesY, mapWidth, mapHeight);\n\n\t\tlet stage = new Konva.Stage({\n\t\t\tcontainer: \"mapholder\",\n\t\t\twidth: mapWidth,\n\t\t\theight: mapHeight,\n\n\t\t});\n\n\t\tlet container = (this.container.nativeElement as HTMLElement);\n\t\tlet contwidth = container.offsetWidth;\n\t\tlet contheight = container.offsetHeight;\n\n\t\t// console.log(\"stage \", contwidth, contheight);\n\n\t\tlet bound_sx = -(mapWidth - contwidth);\n\t\tlet bound_dx = 0;\n\n\n\n\t\tlet bound_top = -(mapHeight - contheight);\n\t\tlet bound_bottom = 0;\n\n\t\t// console.log(\"bounds\", bound_sx, bound_top, bound_dx, bound_bottom);\n\n\t\tlet tilelayer = new Konva.Layer({\n\t\t\tdraggable: true,\n\t\t\tdragBoundFunc: function (pos: Konva.Vector2d): Konva.Vector2d {\n\t\t\t\t// console.log(\"tilelayer at\", tilelayer.x(), tilelayer.y());\n\t\t\t\t// console.log(\"mouse at\", pos.x, pos.y);\n\t\t\t\tlet x = Math.min(Math.max(bound_sx, pos.x), bound_dx);\n\t\t\t\tlet y = Math.min(Math.max(bound_top, pos.y), bound_bottom);\n\n\t\t\t\treturn ({\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tstage.add(tilelayer);\n\n\t\t// let ts_a = new Date();\n\t\tfor (let x = 0; x < tilesX; x++) {\n\t\t\tfor (let y = 0; y < tilesY; y++) {\n\t\t\t\tlet terrain = this.worldmap.getTerrainAt(x, y);\n\t\t\t\t// console.log(x, y, terrain);\n\t\t\t\tif (terrain != null) {\n\t\t\t\t\t// let imageObj = new Image();\n\t\t\t\t\t// imageObj.src = terraintiles.get(terrain);\n\n\t\t\t\t\t// let filename = terraintiles.get(terrain);\n\t\t\t\t\tlet tile = new Konva.Image({\n\t\t\t\t\t\timage: this.tileimages.get(terrain),\n\t\t\t\t\t\tx: x * this.TILESIZE,\n\t\t\t\t\t\ty: y * this.TILESIZE,\n\t\t\t\t\t\twidth: this.TILESIZE,\n\t\t\t\t\t\theight: this.TILESIZE,\n\t\t\t\t\t});\n\t\t\t\t\ttilelayer.add(tile);\n\t\t\t\t\t// console.log(\"added \", tile, x * this.TILESIZE, y * this.TILESIZE);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// create location markers\n\n\t\tlet widget = this;\n\n\t\tlet locs = this.worldmap.getAllLocations();\n\t\tfor (let loc of locs) {\n\t\t\t// console.log(\"adding location to map: \", loc, \"w coords\", loc[\"coords\"]);\n\t\t\t// let coords = loc[\"coords\"];\n\t\t\t// let loctype = loc[\"loctype\"];\n\n\t\t\tlet marker = new Konva.Image({\n\t\t\t\timage: this.markerimages.get(loc.loctype),\n\t\t\t\tx: loc.pos.x * this.TILESIZE,\n\t\t\t\ty: loc.pos.y * this.TILESIZE,\n\t\t\t\twidth: this.TILESIZE,\n\t\t\t\theight: this.TILESIZE,\n\t\t\t});\n\t\t\t// console.log(\"creating marker at\", loc.pos.x, loc.pos.y)\n\t\t\ttilelayer.add(marker);\n\n\t\t\tmarker.on(\"click\", function (ev) {\n\t\t\t\tconsole.log(\"marker click \", ev, \"on\", this, \"for loc\", loc);\n\t\t\t\twidget.chooseDestination(loc);\n\t\t\t\tev.cancelBubble = true;\n\t\t\t});\n\t\t}\n\n\t\t// create hero marker\n\t\tlet game = this.sceneref.game;\n\t\tlet playerpos = game.hero.pos.getCoords();\n\n\t\tlet imageref = this.markerimages.get(\"hero\");\n\t\t// let imagepath = this.markerfiles.get(\"hero\");\n\t\tlet marker = new Konva.Image({\n\t\t\timage: imageref,\n\t\t\tx: playerpos[0] * this.TILESIZE,\n\t\t\ty: playerpos[1] * this.TILESIZE,\n\t\t\twidth: this.TILESIZE,\n\t\t\theight: this.TILESIZE,\n\t\t});\n\n\t\tmarker.on(\"click\", function (ev) {\n\t\t\t// console.log(\"marker click \", ev, \"on\", this, \"for loc\", loc);\n\t\t\tlet loc = game.worldmap.getLocationAt(playerpos);\n\t\t\tif (!!loc)\n\t\t\t{\n\t\t\t\twidget.chooseDestination(loc);\n\t\t\t\tev.cancelBubble = true;\n\t\t\t}\n\t\t});\n\n\t\ttilelayer.add(marker);\n\n\n\t\ttilelayer.batchDraw();\n\t\t// loclayer.batchDraw();\n\t\t// console.log(\"redraw\");\n\n\t\t// console.log(\"mapdom size\", this.mapdom.nativeElement.offsetHeight, this.mapdom.nativeElement.offsetWidth);\n\t\t// console.log(\"container size\", this.container.nativeElement.offsetHeight, this.container.nativeElement.offsetWidth);\n\n\t\tlet shiftX = playerpos[0] * this.TILESIZE - this.container.nativeElement.offsetWidth / 2;\n\t\tlet shiftY = playerpos[1] * this.TILESIZE - this.container.nativeElement.offsetHeight / 2;\n\n\n\t\ttilelayer.setAbsolutePosition({x: -shiftX, y: -shiftY});\n\n\t\t// console.log(\"map ready\");\n\t}\n\n\tonClose() {\n\t\tthis.sceneref.close('BYE WORLD MAP');\n\t}\n\n\tchooseDestination(destination: Place)\n\t{\n\t\tconsole.log(\"chose destination \", destination, this.sceneref.scene);\n\n\n\t\t/*\n\t\tPlace location =  caller.game.map.getPlace(vtag);\n\t\tPosition locpos = location.getCoords();\n\n\t\tif ((locpos.x != heropos.x) || (locpos.y != heropos.y))\n\t\t{\n\t\t\tcaller.startScene(new Journey(caller.game, caller.game.map.getPlace((String)view.getTag())));\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// back to town gate screen, same as back\n\t\t\tcaller.startScene(new TownNav(caller.game));\n\t\t}\n\t\t*/\n\n\t\t// TODO: handle back to current\n\t\tthis.mapscene.setDestination(destination);\n\t\tthis.sceneref.triggerSceneCheck();\n\t}\n}\n\n","import {StorytellerComponent} from \"./storyteller.component\";\nimport {QuestRef} from \"../rpg-engine/quests/quest-ref\";\nimport {QuestTask} from \"../rpg-engine/quests/quest-task\";\n\n\n/**\n * StorytellerInterface gives access to the {@link StorytellerComponent} functionalities without creating circular imports (similar to {@link SceneRendererLoader}).\n * Its main use case is loading data during play, to avoid front-loading the whole world and quests.\n * The idea is to add only one object for the {@link SceneUIComponent} objects to use to interact with and keep initialization through {@link SceneUIService} as simple as possible.\n */\nexport class StorytellerInterface\n{\n\n\tconstructor (private stref: StorytellerComponent)\n\t{\n\t}\n\n\tcheckUpdateSceneRender ()\n\t{\n\t\tthis.stref.checkUpdateSceneRender();\n\t}\n\n\tgetStoryteller (): StorytellerComponent\n\t{\n\t\treturn this.stref;\n\t}\n\n\tloadQuestTasks (refs: QuestTaskReference[], callback: Function)\n\t{\n\n\t\tlet filerefs = [];\n\t\tlet byQuest = new Map<QuestRef, string[]>();\n\t\tfor (let ref of refs)\n\t\t{\n\t\t\tlet inQuest = byQuest.has(ref.quest) ? byQuest.get(ref.quest) : [];\n\t\t\tinQuest.push(ref.taskid);\n\t\t\tbyQuest.set(ref.quest, inQuest);\n\t\t\tfilerefs.push(ref.quest.fileref);\n\t\t}\n\n\t\tthis.stref.loader.loadDataFiles(filerefs, function (data)\n\t\t{\n\t\t\tlet tasks = [];\n\t\t\tfor (let ref of refs)\n\t\t\t{\n\t\t\t\tlet rawtask = data[ref.quest.fileref][\"tasks\"][ref.taskid];\n\t\t\t\tlet qtask = QuestTask.fromJSON(rawtask);\n\t\t\t\tqtask.setCaller(ref.quest);\n\t\t\t\ttasks.push(qtask);\n\t\t\t}\n\t\t\tcallback(tasks);\n\t\t});\n\n\t}\n}\n\nexport interface QuestTaskReference {\n\tquest: QuestRef;\n\ttaskid: string;\n}\n","export default \"#st-page {\\n  background-image: url(\\\"/assets/ui/temporaryparchment.jpg\\\");\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RyYWtlL0NvZGUvV2FuZGVyL1dhbmRlckFORy9zcmMvYXBwL3N0b3J5dGVsbGVyL3N0b3J5dGVsbGVyLmNvbXBvbmVudC5zY3NzIiwic3JjL2FwcC9zdG9yeXRlbGxlci9zdG9yeXRlbGxlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVDLDBEQUFBO0FDQUQiLCJmaWxlIjoic3JjL2FwcC9zdG9yeXRlbGxlci9zdG9yeXRlbGxlci5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIiNzdC1wYWdlXG57XG5cdGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi9hc3NldHMvdWkvdGVtcG9yYXJ5cGFyY2htZW50LmpwZ1wiKTtcbn1cblxuIiwiI3N0LXBhZ2Uge1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIvYXNzZXRzL3VpL3RlbXBvcmFyeXBhcmNobWVudC5qcGdcIik7XG59Il19 */\"","import {Component, OnInit, Type} from '@angular/core';\nimport {SceneUIService} from \"../scene-ui/scene-ui.service\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {WanderGame} from \"../rpg-engine/wander-game\";\nimport {SceneRenderer} from \"./scenes/scene-renderer\";\nimport {WanderScene} from \"../rpg-engine/wander-scene\";\nimport {JourneyDeparture} from \"../rpg-engine/scenes/journey-departure\";\nimport {Town} from \"../rpg-engine/world/locs/Town\";\nimport {TownNav} from \"../rpg-engine/scenes/town-nav\";\nimport {PassageTrail} from \"../rpg-engine/scenes/passage-trail\";\nimport {TerrainPass} from \"../rpg-engine/world/locs/TerrainPass\";\nimport { WanderGameState } from '../rpg-engine/wander-game-state';\nimport { WorldPosition } from '../rpg-engine/world/world-position';\nimport { isUndefined } from 'util';\nimport {StorytellerInterface} from \"./storyteller-interface\";\nimport {SceneRendererLoader} from \"./scenes/scene-renderer-loader\";\nimport {ResLoader} from \"../support/res-loader\";\nimport {MetaScene} from \"../rpg-engine/scenes/meta-scene\";\n\n@Component({\n\tselector: 'app-storyteller',\n\ttemplateUrl: './storyteller.component.html',\n\tstyleUrls: ['./storyteller.component.scss']\n})\nexport class StorytellerComponent implements OnInit {\n\n\tgame: WanderGame;\n\treadonly loader: ResLoader;\n\n\tconstructor(private sceneui: SceneUIService, private http: HttpClient) {\n\t\tthis.loader = new ResLoader(http);\n\t}\n\n\tngOnInit() {\n\t\tthis.sceneui.bindStoryTellerUI(this.getInterface());\n\t\tthis.loadGameData();\n\n\t}\n\n\tloadGameData() {\n\t\tlet stui = this;\n\t\tWanderGame.loadGame(this.http, function (game: WanderGame) {\n\t\t\tstui.game = game;\n\t\t\tstui.checkReadyGame();\n\t\t});\n\t}\n\n\tcheckReadyGame() {\n\t\tconsole.log(\"running Wander Game \", this.game);\n\n\t\tthis.checkUpdateSceneRender();\n\n\n\t}\n\n\tgetLocationSensitiveScene (): WanderScene\n\t{\n\t\tlet ppos = this.game.hero.pos;\n\t\tlet place = this.game.worldmap.getLocationAt(ppos.getCoords());\n\t\tconsole.log(\"place is town? \", place instanceof Town);\n\t\tlet scene = null;\n\t\tif (place instanceof Town)\n\t\t{\n\t\t\tscene = new TownNav (this.game, place);\n\t\t}\n\t\telse if (place instanceof TerrainPass)\n\t\t{\n\t\t\tscene = new PassageTrail(this.game, place);\n\t\t}\n\t\telse {\n\t\t\t// if all fails, go to map\n\t\t\tscene = new JourneyDeparture(this.game);\n\t\t}\n\t\treturn scene;\n\t}\n\n\tcheckUpdateSceneRender()\n\t{\n\t\tconsole.log(\"checkUpdateSceneRender\");\n\t\tlet scene = this.game.getActiveScene();\n\t\tconsole.log(\"checking update on scene \", scene);\n\t\tif (!!scene && scene.sceneFinished())\n\t\t{\n\n\t\t\t// note : this was done INSIDE scene in Java/Android, but we want to be able to affect external quest references and use \"pure\" references instead of whole quest objects\n\t\t\tif (!!scene.driver)\n\t\t\t{\n\t\t\t\tscene.driver.setCompleted();\n\t\t\t}\n\n\t\t\tif (!!scene.narrative && scene.narrative instanceof MetaScene)\n\t\t\t{\n\t\t\t\t// console.log(\"FINISHING SUB SCENE, UPDATE STATES in UBER SCENE!!!!!\");\n\t\t\t\tscene.narrative.moveOn();\n\t\t\t\t// console.log(\"updated narrative for sub scene\", scene.narrative.returnStates());\n\t\t\t}\n\n\n\t\t\t// console.log(\"SCENE TYPECHECK: typeof scene\", scene.constructor.name);\n\n\t\t\t// console.log(\"having scene finisher\");\n\t\t\tscene = scene.getFollowingScene();\n\t\t\t// console.log(\"following scene is \", scene);\n\t\t\t// console.log(\"IS FOLLOWING SCENE A METASCENE?\", scene instanceof MetaScene);\n\t\t\t// console.log(\"SCENE TYPECHECK: typeof following\", scene.constructor.name);\n\t\t}\n\n\n\t\tif (scene instanceof MetaScene)\n\t\t{\n\t\t\tlet ms = scene as MetaScene;\n\t\t\tif (ms.getCurrent() == null)\n\t\t\t{\n\t\t\t\t// console.log(\"SET METASCENE AS FINISHED!\");\n\t\t\t\tif (!!ms.driver)\n\t\t\t\t{\n\t\t\t\t\t// console.log(\"SET METASCENE DRIVER AS COMPLETE!\");\n\t\t\t\t\tms.driver.setCompleted();\n\t\t\t\t}\n\t\t\t\tscene = null;\n\t\t\t}\n\t\t}\n\n\t\tif (!scene)\n\t\t{\n\t\t\tscene = this.getLocationSensitiveScene();\n\t\t}\n\n\t\t// console.log(\"SCENE TYPECHECK: typeof switchto\", scene.constructor.name);\n\t\tthis.switchSceneUI (scene);\n\n\n\t}\n\n\tenterSubScene (scene: WanderScene)\n\t{\n\t\t// NOTE: subscenes ALWAYS come from MetaScenes\n\t\t// TODO: Refactor to enforce MetaScene type checking\n\t\tconsole.log(\"entering sub scene \", scene, \"from narrative\", this.game.activescene);\n\t\tscene.setNarrative(this.game.activescene as MetaScene);\n\t\tthis.game.setActiveScene(scene);\n\t\tthis.switchSceneUI(scene);\n\n\n\t}\n\n\tswitchSceneUI (scene: WanderScene)\n\t{\n\t\ttry\n\t\t{\n\t\t\t// console.log(\"removing previous sceneUI for switch to \", scene);\n\t\t\tthis.sceneui.removeSceneUI();\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\t// console.warn(\"no scene to remove\");\n\t\t}\n\n\n\t\tif (scene instanceof MetaScene)\n\t\t{\n\t\t\t// console.log(\"should switch to internal scene for metascene\");\n\t\t\tlet sub = scene.getCurrent();\n\t\t\tif (sub != null)\n\t\t\t{\n\t\t\t\t// switch to sub ONLY if there is still another scene\n\t\t\t\tscene = sub;\n\t\t\t}\n\t\t}\n\n\t\tthis.game.setActiveScene(scene);\n\t\tconsole.log(\"using scene \", scene);\n\n\t\tlet renderer = this.getSceneRenderer(scene);\n\t\t// console.log(\"opening renderer \", renderer, \"for scene\", scene);\n\t\tlet ref = this.sceneui.open(renderer, scene);\n\t\t// console.log(\"opened as sceneref\", ref);\n\t\tref.afterClosed.subscribe(result => {\n\t\t\t// console.log('Closed scene', scene, renderer, \"w result\", result);\n\t\t});\n\n\t\tlet st = this;\n\t\tref.subSwitch.subscribe(subscene  => {\n\t\t\t// console.log(\"received switch to sub scene \", subscene, \"from current\", this.game.activescene, \"by\", ref);\n\t\t\tst.enterSubScene(subscene);\n\t\t});\n\t}\n\n\tgetSceneRenderer (scene: WanderScene): Type<SceneRenderer>\n\t{\n\t\treturn SceneRendererLoader.getSceneRendererClass(scene);\n\t}\n\n\n\tdoSaveGame ()\n\t{\n\t\tconsole.log(\"Saving game state...\");\n\t\tWanderGameState.saveToBrowser(this.game);\n\t}\n\n\tdoLoadGame ()\n\t{\n\t\tconsole.log(\"Loading game state...\");\n\t\tlet loaded = WanderGameState.loadFromBrowser();\n\t\tconsole.log(\"loaded game state \", loaded);\n\t\tif (!isUndefined(loaded) && loaded !== null)\n\t\t{\n\t\t\tlet pos = loaded[\"hero\"][\"position\"];\n\t\t\tthis.game.hero.setCoordinates(new WorldPosition(pos[0], pos[1]));\n\t\t\tthis.game.setActiveScene(null);\n\t\t\tthis.checkUpdateSceneRender();\n\t\t}\n\t}\n\n\tgetInterface (): StorytellerInterface\n\t{\n\t\treturn new StorytellerInterface(this);\n\t}\n\n\n}\n","import {HttpClient} from \"@angular/common/http\";\n\nexport class ResLoader\n{\n\tconstructor(protected http: HttpClient) {\n\t}\n\n\tloadDataFile (filepath: string, callback: Function)\n\t{\n\t\tconst locdata = this.http.get(filepath);\n\t\tlocdata.subscribe(function (response) {\n\t\t\tconsole.log(\"LOAD RESULT\", response);\n\t\t\tcallback(response);\n\t\t});\n\t}\n\n\tloadDataFiles (filepaths: string[], multicallback: Function)\n\t{\n\t\tlet loaded = {\n\n\t\t};\n\n\t\tfunction getCheckerFunction (key: string): Function\n\t\t{\n\t\t\treturn function (data: any) {\n\t\t\t\tloaded[key] = data;\n\t\t\t\tif (Object.keys(loaded).length === filepaths.length)\n\t\t\t\t{\n\t\t\t\t\tmulticallback(loaded);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// ADD ERROR HANDLING\n\n\t\tfor (let filepath of filepaths)\n\t\t{\n\t\t\tlet checker = getCheckerFunction(filepath);\n\t\t\tthis.loadDataFile(filepath, checker);\n\t\t\tthis.http.get(filepath).subscribe(function (response) {\n\t\t\t\tloaded[filepath] = response;\n\t\t\t});\n\t\t}\n\t}\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n\tproduction: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}